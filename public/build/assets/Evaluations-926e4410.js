import{d as pe}from"./index-a0304548.js";import{K as ve,k as i,h as J,m as _e,T as N,r as u,n as me,f as Q,a,u as w,w as e,F as fe,o as S,Z as ge,i as W,p as m,d as c,g as V,b as o,t as y,q as he,c as A,O as be}from"./app-9eb8fe0c.js";import{f as B}from"./common-1f9d3448.js";import{_ as we}from"./AuthenticatedLayout-f2b417d9.js";import{_ as ye}from"./EvaluationDomainsList-e2011d52.js";import"./ApplicationLogo-71e7e7d1.js";const ke=o("h2",{class:"tw-font-semibold tw-text-xl tw-text-gray-800 tw-leading-tight"},"Einschätzungen",-1),Ee={key:0,class:"tw-flex tw-items-center tw-justify-end"},Se={class:"tw-table-block tw-max-w-full tw-mx-auto tw-py-6 tw-px-4 sm:tw-px-6 lg:tw-px-8"},ze=["data-id","data-order"],Pe={align:"center"},xe=o("span",null,"Einschätzung bearbeiten",-1),De=o("span",null,"Einschätzung ansehen",-1),Fe=o("span",null,"Einschätzung löschen",-1),$e=o("div",{class:"tw-py-6"},[o("h3",{class:"tw-mb-4"},"Die Tabelle ist leer.")],-1),Ce={class:"tw-text-right"},Ie=["href"],Ne={class:"tw-text-center"},Ve=o("h1",{class:"tw-uppercase text-primary tw-font-black tw-text-xl tw-mb-8"}," Screening wurde eingereicht ",-1),Ae=o("p",{class:"tw-mb-8"}," Folgendes Screening wurde eingereicht und kann nur bis 15 Minuten nach Einreichung bearbeitet werden. Danach verschwindet es aus Ihrer Übersicht. Sollten Sie es zurückziehen oder bearbeiten wollen, klicke Sie auf 'Abgabe zurückziehen. Nachfolgend erhalten Sie eine Übersicht des eingereichten Screenings, welches Sie über den Download-Button als PDF herunterladen können. ",-1),Be=o("span",{class:"tw-font-black"},"Bezeichner des Screenings",-1),qe={__name:"Evaluations",props:{items:Array,currentPage:Number,perPage:Number,lastPage:Number,total:Number,paging:Boolean,orderBy:String,sort:String,filters:Object,errors:Object},setup(X){const _=X;pe.Inertia.on("success",l=>{let t=l.detail.page.props;l.detail.page.component==="Evaluations/Evaluations"&&t&&(h.value=t.currentPage,k.value=t.perPage,T.value=t.orderBy,Y.value=t.sort,O.value=t.total,ee.value=t.lastPage)}),ve().props.auth.user;const h=i(_.currentPage),k=i(_.perPage),T=i(_.orderBy),Y=i(_.sort),O=i(_.total),ee=i(_.lastPage),te=i(""),f=i(_.errors||{}),F=i(!1),j=i(!1),z=i(!1),R=i(null),P=i(!1),d=i(null),U=i(null),ae=[{title:"ID",key:"id",width:"40%",sortable:!1},{title:"Zuletzt bearbeitet",key:"updated_at",width:"15%",sortable:!1},{title:"Abgegeben am",key:"finished_at",width:"15%",sortable:!1},{title:"Bearbeitungszeit endet",key:"not_editable_at",width:"20%",sortable:!1},{title:"Aktion",key:"actions",width:"10%",sortable:!1,align:"center"}],le=J(()=>_.items.map(l=>{const t={...l};for(const r in t)(t[r]===null||t[r]===void 0)&&(t[r]="-");return t})),se=J(()=>d.value.age?U.value.map(l=>({...l,subdomains:l.subdomains.map(t=>({...t,milestones:t.milestones.filter(r=>parseFloat(r.age)===parseFloat(d.value.age))})).filter(t=>t.milestones.length>0)})).filter(l=>l.subdomains.length>0):[]);_e(j,l=>{l||g()});const oe=async({page:l,itemsPerPage:t,sortBy:r,clearFilters:p})=>{if(l!==h.value||l===h.value&&p||[l,t,r]!==[h.value,k.value,T.value]){F.value=!0;let v={data:{page:l,per_page:t}};r&&r.length>0&&(v.data.order_by=r[0].key,v.data.sort=r[0].order),await be.reload(v),h.value=l,k.value=t,F.value=!1}},ne=l=>{R.value=l.uuid,E.id=l.id,z.value=!0},b=N({id:null}),re=async l=>{b.id=l.id,b.processing=!0,b.post(route("evaluations.show_popup",{id:b.id}),{onSuccess:t=>{b.clearErrors(),f.value={},P.value=!0,d.value=t.props.data.item,U.value=t.props.data.domains},onError:t=>{f.value=t},onFinish:()=>{b.processing=!1}})},g=()=>{j.value=!1,z.value=!1,P.value=!1,f.value={}},E=N({id:null}),ie=async()=>{E.processing=!0;let l={onSuccess:t=>{g()},onError:t=>{g(),f.value=t},onFinish:()=>{E.processing=!1}};E.delete(route("evaluations.destroy",{id:E.id}),l)},x=N({}),ue=async l=>{x.processing=!0,x.post(route("evaluations.unfinished",{id:l}),{preserveState:!1,onSuccess:t=>{x.clearErrors(),f.value={},g()},onError:t=>{f.value=t},onFinish:()=>{x.processing=!1}})};return(l,t)=>{const r=u("v-btn-primary"),p=u("v-hover"),v=u("v-col"),$=u("v-row"),Z=u("v-container"),q=u("v-card-text"),H=u("v-spacer"),C=u("v-btn"),K=u("v-card-actions"),L=u("v-card"),M=u("v-dialog"),D=u("v-icon"),I=u("v-tooltip"),ce=u("v-data-table-server"),de=me("sortable-data-table");return S(),Q(fe,null,[a(w(ge),{title:"Einschätzungen"}),a(we,{errors:f.value},{header:e(()=>[ke,l.$page.props.auth.user.is_manager||l.$page.props.auth.user.is_employer?(S(),Q("div",Ee,[a(w(W),{href:l.route("evaluations.create")},{default:e(()=>[a(p,null,{default:e(({isHovering:s,props:n})=>[a(r,m(n,{color:s?"accent":"primary"}),{default:e(()=>[c(" Anlegen ")]),_:2},1040,["color"])]),_:1})]),_:1},8,["href"])])):V("",!0),a(M,{modelValue:z.value,"onUpdate:modelValue":t[0]||(t[0]=s=>z.value=s),width:"20vw"},{default:e(()=>[a(L,{height:"30vh"},{default:e(()=>[a(q,null,{default:e(()=>[a(Z,null,{default:e(()=>[a($,null,{default:e(()=>[a(v,{cols:"12"},{default:e(()=>[o("p",null,"Sind Sie sicher, dass Sie die Einrichtung "+y(R.value)+" löschen möchten?",1)]),_:1})]),_:1})]),_:1})]),_:1}),a(K,null,{default:e(()=>[a(H),a(p,null,{default:e(({isHovering:s,props:n})=>[a(C,m({onClick:g},n,{color:s?"accent":"primary"}),{default:e(()=>[c("Abbrechen")]),_:2},1040,["color"])]),_:1}),a(p,null,{default:e(({isHovering:s,props:n})=>[a(r,m({onClick:ie},n,{color:s?"accent":"primary"}),{default:e(()=>[c("Löschen")]),_:2},1040,["color"])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),default:e(()=>[o("div",Se,[he((S(),A(ce,{"items-per-page":k.value,"onUpdate:itemsPerPage":t[1]||(t[1]=s=>k.value=s),"items-per-page-options":[{value:10,title:"10"},{value:25,title:"25"},{value:50,title:"50"},{value:100,title:"100"},{value:-1,title:"$vuetify.dataFooter.itemsPerPageAll"}],"items-per-page-text":"Objekte pro Seite:",headers:ae,page:h.value,"items-length":O.value,items:le.value,search:te.value,loading:F.value,class:"data-table-container elevation-1","item-value":"name","onUpdate:options":oe},{item:e(({item:s})=>[o("tr",{"data-id":s.selectable.id,"data-order":s.selectable.order},[o("td",null,y(`${s.selectable.kita.formatted_name}_${s.selectable.uuid}`),1),o("td",null,y(w(B)(s.selectable.updated_at,"sv-SE")),1),o("td",null,y(w(B)(s.selectable.finished_at,"sv-SE")),1),o("td",null,y(w(B)(s.selectable.not_editable_at,"sv-SE")),1),o("td",Pe,[s.selectable.editable&&(l.$page.props.auth.user.is_manager||l.$page.props.auth.user.is_employer)?(S(),A(I,{key:0,location:"top"},{activator:e(({props:n})=>[a(w(W),{href:l.route("evaluations.edit",{id:s.selectable.id})},{default:e(()=>[a(D,m(n,{size:"small",class:"tw-me-2"}),{default:e(()=>[c("mdi-pencil")]),_:2},1040)]),_:2},1032,["href"])]),default:e(()=>[xe]),_:2},1024)):V("",!0),s.selectable.finished?(S(),A(I,{key:1,location:"top"},{activator:e(({props:n})=>[a(D,m(n,{size:"small",class:"tw-me-2",onClick:G=>re(s.raw)}),{default:e(()=>[c("mdi-eye")]),_:2},1040,["onClick"])]),default:e(()=>[De]),_:2},1024)):V("",!0),a(I,{location:"top"},{activator:e(({props:n})=>[a(D,m(n,{size:"small",class:"tw-me-2",onClick:G=>ne(s.raw)}),{default:e(()=>[c("mdi-delete")]),_:2},1040,["onClick"])]),default:e(()=>[Fe]),_:2},1024)])],8,ze)]),"no-data":e(()=>[$e]),_:1},8,["items-per-page","items-per-page-options","page","items-length","items","search","loading"])),[[de]])]),a(M,{modelValue:P.value,"onUpdate:modelValue":t[4]||(t[4]=s=>P.value=s),width:"95vw"},{default:e(()=>[a(L,{height:"95vh"},{default:e(()=>[a(q,null,{default:e(()=>[a(Z,null,{default:e(()=>[a($,{class:"result-evaluation-domains"},{default:e(()=>[a(v,{cols:"12"},{default:e(()=>[a(p,null,{default:e(({isHovering:s,props:n})=>[o("div",Ce,[o("a",{href:l.route("evaluations.pdf",{id:d.value.id}),onClick:g,title:"Fenster schließen"},[a(D,m(n,{size:"small",class:"tw-me-2",onClick:t[2]||(t[2]=()=>{})}),{default:e(()=>[c("mdi-close")]),_:2},1040)],8,Ie)])]),_:1})]),_:1})]),_:1}),a($,{class:"result-evaluation-domains"},{default:e(()=>[a(v,{cols:"8",offset:"2"},{default:e(()=>[o("div",Ne,[Ve,Ae,a(p,null,{default:e(({isHovering:s,props:n})=>[a(C,{href:l.route("evaluations.pdf",{id:d.value.id}),class:"tw-px-2 tw-py-3 tw-mb-4 tw-mr-4 tw-normal-case",color:s?"primary":"accent"},{default:e(()=>[c(" Screening als PDF downloaden ")]),_:2},1032,["href","color"])]),_:1}),a(p,null,{default:e(({isHovering:s,props:n})=>[a(C,{onClick:t[3]||(t[3]=G=>ue(d.value.id)),class:"tw-px-2 tw-py-3 tw-mb-4 tw-normal-case",color:s?"accent":"primary"},{default:e(()=>[c(" Abgabe zurückziehen ")]),_:2},1032,["color"])]),_:1})])]),_:1}),a(v,{cols:"12"},{default:e(()=>[o("p",null,[Be,c(": "+y(`${d.value.kita.formatted_name}_${d.value.uuid}`),1)])]),_:1}),a(v,{cols:"12"},{default:e(()=>[a(ye,{ratings:d.value.data,domains:se.value,disabled:!0},null,8,["ratings","domains"])]),_:1})]),_:1})]),_:1})]),_:1}),a(K,null,{default:e(()=>[a(H),a(p,null,{default:e(({isHovering:s,props:n})=>[a(r,m({onClick:g},n,{color:s?"accent":"primary"}),{default:e(()=>[c("Abbrechen")]),_:2},1040,["color"])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["errors"])],64)}}};export{qe as default};
