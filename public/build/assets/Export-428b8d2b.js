import{d as I}from"./index-9c8e1ce1.js";import{K as L,j as s,k as T,l as F,T as M,r,o as C,f as R,a,u as N,w as o,F as S,Z as K,b as _,m as y,c as Z,h as q,d as G,N as O}from"./app-abbb3540.js";import{_ as J}from"./AuthenticatedLayout-220584ad.js";import{c as j,a as Q}from"./common-ea192878.js";import{v as W}from"./v4-4a60fe23.js";import"./ApplicationLogo-4527fb70.js";const X=_("h2",{class:"tw-font-semibold tw-text-xl tw-text-gray-800 tw-leading-tight"},"Screenings exportieren",-1),Y={class:"tw-table-block tw-max-w-full tw-mx-auto tw-py-6 tw-px-4 sm:tw-px-6 lg:tw-px-8"},ee={class:"tw-bg-white tw-flex tw-justify-between tw-px-6 tw-py-6"},le={class:"tw-w-full"},ae={class:"tw-ml-6"},ue={__name:"Export",props:{domains:Object,errors:Object},setup(z){const U=z;I.Inertia.on("success",t=>{t.detail.page.props,t.detail.page.component}),L().props.auth.user;const b=s(U.errors||{}),d=s(!1),B=s(null),A=s(null),p=s(),c=s(),w=s("2.5"),g=s(null),V=s(null),x=s(!1),k=s(!1),D=T(()=>{let t=[{id:null,name:"Alle"}];return U.domains.map(e=>(t.push({id:e.id,name:e.name}),e)),t});F(p,t=>{B.value=j(t)}),F(c,t=>{A.value=j(t)}),M({});const E=async()=>{O.start(),d.value=!0;let t=new Date(p.value),e=new Date(c.value);t.setHours(t.getHours()+12),e.setHours(e.getHours()+12);try{const n=await axios.post(route("export.make"),{finished_after:t,finished_before:e,age:w.value,zip_code:g.value,domains:V.value},{responseType:"blob"}),v=n.headers["content-disposition"],f=v.indexOf("filename=");let i;f!==-1?i=v.slice(f+9).replace(/['"]/g,""):i=W();const u=new Blob([n.data],{type:n.headers["content-type"]}),m=document.createElement("a");m.href=window.URL.createObjectURL(u),m.download=i,m.click()}catch(n){console.error(n)}O.done(),d.value=!1};return(t,e)=>{const n=r("v-text-field"),v=r("v-date-picker"),f=r("v-menu"),i=r("v-locale-provider"),u=r("v-col"),m=r("v-row"),h=r("v-select"),$=r("v-btn"),H=r("v-hover");return C(),R(S,null,[a(N(K),{title:"Screenings exportieren"}),a(J,{errors:b.value},{header:o(()=>[X]),default:o(()=>[_("div",Y,[_("div",ee,[_("div",le,[a(m,null,{default:o(()=>[a(u,{cols:"12",sm:"6"},{default:o(()=>[a(i,{locale:"de"},{default:o(()=>[a(f,{modelValue:x.value,"onUpdate:modelValue":e[2]||(e[2]=l=>x.value=l),"return-value":p.value,"close-on-content-click":!1},{activator:o(({props:l})=>[a(n,y({label:"Abgegeben ab",class:"tw-cursor-pointer","model-value":B.value,"prepend-icon":"mdi-calendar",readonly:""},l,{disabled:d.value}),null,16,["model-value","disabled"])]),default:o(()=>[a(v,{"onUpdate:modelValue":[e[0]||(e[0]=l=>x.value=!1),e[1]||(e[1]=l=>p.value=l)],modelValue:p.value},null,8,["modelValue"])]),_:1},8,["modelValue","return-value"])]),_:1})]),_:1}),a(u,{cols:"12",sm:"6"},{default:o(()=>[a(i,{locale:"de"},{default:o(()=>[a(f,{modelValue:k.value,"onUpdate:modelValue":e[5]||(e[5]=l=>k.value=l),"return-value":c.value,"close-on-content-click":!1},{activator:o(({props:l})=>[a(n,y({label:"Abgegeben bis",class:"tw-cursor-pointer","model-value":A.value,"prepend-icon":"mdi-calendar",readonly:""},l,{disabled:d.value}),null,16,["model-value","disabled"])]),default:o(()=>[a(v,{"onUpdate:modelValue":[e[3]||(e[3]=l=>k.value=!1),e[4]||(e[4]=l=>c.value=l)],modelValue:c.value},null,8,["modelValue"])]),_:1},8,["modelValue","return-value"])]),_:1})]),_:1})]),_:1}),a(m,null,{default:o(()=>[t.$page.props.auth.user.is_monitor_oe||t.$page.props.auth.user.is_super_admin?(C(),Z(u,{key:0,cols:"12",sm:"4"},{default:o(()=>[a(h,{modelValue:V.value,"onUpdate:modelValue":e[6]||(e[6]=l=>V.value=l),items:D.value,"error-messages":b.value.domain,"item-title":"name","item-value":"id",label:"DomÃ¤ne",disabled:d.value},null,8,["modelValue","items","error-messages","disabled"])]),_:1})):q("",!0),a(u,{cols:"12",sm:"4"},{default:o(()=>[a(h,{modelValue:w.value,"onUpdate:modelValue":e[7]||(e[7]=l=>w.value=l),items:N(Q),"error-messages":b.value.age,"item-title":"age_name","item-value":"age_number",label:"Altersgruppe",disabled:d.value},null,8,["modelValue","items","error-messages","disabled"])]),_:1}),a(u,{cols:"12",sm:"4"},{default:o(()=>[a(n,{modelValue:g.value,"onUpdate:modelValue":e[8]||(e[8]=l=>g.value=l),type:"number","error-messages":b.value.zipCode,label:"Postleitzahl",disabled:d.value},null,8,["modelValue","error-messages","disabled"])]),_:1})]),_:1})]),_("div",ae,[a(H,null,{default:o(({isHovering:l,props:P})=>[a($,y({class:"tw-mt-2"},P,{color:l?"accent":"primary",onClick:E,dark:"",disabled:d.value}),{default:o(()=>[G("Exportieren")]),_:2},1040,["color","disabled"])]),_:1})])])])]),_:1},8,["errors"])],64)}}};export{ue as default};
