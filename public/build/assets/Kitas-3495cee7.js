import{K as Fe,h as c,j as le,k as C,A as Ce,T as ve,r as m,o as V,f as D,a as e,u as d,w as l,F as ae,Z as Ne,b as i,c as te,m as g,d as y,g as K,t as N,i as Te,O as Ae}from"./app-93f9cc7e.js";import{d as $e}from"./index-fcde9203.js";import{_ as De}from"./AuthenticatedLayout-c725dd4d.js";import"./ApplicationLogo-cd1d914a.js";const Ke=i("h2",{class:"tw-font-semibold tw-text-xl tw-text-gray-800 tw-leading-tight"},"Einrichtungen",-1),je={class:"tw-flex tw-items-center tw-justify-end"},qe=i("span",{class:"tw-text-h5"},"Verwalte Einrichtung",-1),Be=i("h4",null,"Adresse",-1),Ie=i("h4",null,"Eigenschaften",-1),Je={class:"tw-table-block tw-max-w-full tw-mx-auto tw-py-6 tw-px-4 sm:tw-px-6 lg:tw-px-8"},Oe={key:0,class:"tw-bg-white tw-flex tw-justify-between tw-px-6 tw-py-6"},Me={class:"tw-w-full"},Ye={key:1},Ze=i("span",null,"Schreibe E-Mail an Auswahl",-1),Re=["data-id","data-order"],Ge={class:"text-center"},He=["href"],Le=i("span",null,"Schreibe E-Mail",-1),Qe=i("span",null,"Einrichtung bearbeiten",-1),We=i("span",null,"Einrichtung löschen",-1),Xe={class:"tw-py-6"},el={key:0,class:"tw-mb-4"},ll=i("h3",{class:"tw-mb-4"},"Die Tabelle ist leer. Bitte setzen Sie die Suchfilter zurück.",-1),al=i("span",{class:"tw-text-h5"},"Schreibe E-Mail an Auswahl",-1),rl={__name:"Kitas",props:{items:Array,currentPage:Number,perPage:Number,lastPage:Number,total:Number,paging:Boolean,orderBy:String,sort:String,filters:Object,errors:Object,types:Array,zipCodes:Array,operators:Array,usersEmails:Array},setup(F){var de,ie,ce,me,pe;const v=F;$e.Inertia.on("success",s=>{let a=s.detail.page.props;s.detail.page.component==="Kitas/Kitas"&&a&&(J.value=a.currentPage,j.value=a.perPage,_e.value=a.orderBy,fe.value=a.sort,oe.value=a.total,ge.value=a.lastPage)}),Fe().props.auth.user;const J=c(v.currentPage),j=c(v.perPage),_e=c(v.orderBy),fe=c(v.sort),oe=c(v.total),ge=c(v.lastPage),w=c(((de=v.filters)==null?void 0:de.search)??null),k=c(((ie=v.filters)==null?void 0:ie.has_yearly_evaluations)??null),E=c(((ce=v.filters)==null?void 0:ce.approved)??null),S=c(null),U=c(((me=v.filters)==null?void 0:me.type)??null),P=c(((pe=v.filters)==null?void 0:pe.zip_code)??null),se=c(""),_=c(v.errors||{}),q=c([]),b=c(!1),O=c(!1),M=c(!1),Y=c(!1),ue=c(null),be=[{title:"Ja",value:"true"},{title:"Nein",value:"false"}],he=[{title:"Ja",value:"true"},{title:"Nein",value:"false"}],ye=[{title:"Name",key:"name",width:"15%",sortable:!0},{title:`Jährliche Rückmeldung ${new Date().getFullYear()} abgeschlossen`,key:"has_yearly_evaluations",width:"35%",sortable:!0},{title:"Zugelassen",key:"approved",width:"10%",sortable:!0},{title:"Träger",key:"operator_id",width:"10%",sortable:!0},{title:"Typ",key:"type",width:"10%",sortable:!0},{title:"Postleitzahl",key:"zip_code",width:"10%",sortable:!0},{title:"Aktion",key:"actions",width:"10%",sortable:!1,align:"center"}],Ve=le(()=>v.items.map(s=>{const a={...s};for(const h in a)(a[h]===null||a[h]===void 0)&&(a[h]="-");return a})),re=le(()=>w.value===null&&k.value===null&&E.value===null&&S.value===null&&U.value===null&&P.value===null),we=le(()=>w.value!==null||k.value!==null||E.value!==null||S.value!==null||U.value!==null||P.value!==null);C(O,s=>{s||A()}),C(w,Ce.debounce(s=>{T()},500)),C(k,s=>{T()}),C(E,s=>{T()}),C(S,s=>{T()}),C(U,s=>{T()}),C(P,s=>{T()});const ke=()=>{M.value=!0,q.value=v.usersEmails.map(s=>s.value)},T=()=>{b.value=!0,se.value=String(Date.now())},ne=async({page:s,itemsPerPage:a,sortBy:h,clearFilters:n})=>{if(n&&(w.value=null,k.value=null,E.value=null,S.value=null,U.value=null,P.value=null),s===J.value&&n||re||we){b.value=!0;let r={page:s,per_page:a};h&&h.length>0?(r.order_by=h[0].key,r.sort=h[0].order):(r.order_by=null,r.sort=null),w.value&&(r.search=w.value),k.value&&(r.has_yearly_evaluations=k.value),E.value&&(r.approved=E.value),S.value&&(r.operator_id=S.value),U.value&&(r.type=U.value),P.value&&(r.zip_code=P.value),await Ae.get(route(route().current()),r,{preserveScroll:!0,preserveState:!0,onCancelToken:p=>{},onCancel:()=>{},onBefore:p=>{b.value=!0},onStart:p=>{},onProgress:p=>{},onSuccess:p=>{J.value=r.page,j.value=r.per_page},onError:p=>{console.log(p)},onFinish:p=>{b.value=!1}})}},Ee=s=>{ue.value=s.name,B.id=s.id,Y.value=!0},B=ve({id:null}),Se=async()=>{B.processing=!0;let s={onSuccess:a=>{A()},onError:a=>{A(),_.value=a},onFinish:()=>{B.processing=!1}};B.delete(route("kitas.destroy",{id:B.id}),s)},A=()=>{O.value=!1,Y.value=!1,M.value=!1,u.reset(),u.clearErrors(),_.value={}},Ue=()=>{u.reset(),u.clearErrors()},u=ve({name:null,number:null,street:null,house_number:null,city:null,additional_info:null,zip_code:null,operator_id:null,num_pedagogical_staff:null,approved:!0,type:null}),Pe=async()=>{u.processing=!0,u.post(route("kitas.store"),{onSuccess:s=>{A()},onError:s=>{_.value=s},onFinish:()=>{u.processing=!1}})};return(s,a)=>{const h=m("v-card-title"),n=m("v-col"),r=m("v-row"),p=m("v-text-field"),z=m("v-select"),ze=m("v-checkbox"),G=m("v-container"),H=m("v-card-text"),Z=m("v-btn-primary"),x=m("v-hover"),L=m("v-spacer"),I=m("v-btn"),Q=m("v-card-actions"),W=m("v-card"),X=m("v-dialog"),R=m("v-icon"),ee=m("v-tooltip"),xe=m("v-data-table-server");return V(),D(ae,null,[e(d(Ne),{title:"Einrichtungen"}),e(De,{errors:_.value},{header:l(()=>[Ke,i("div",je,[s.$page.props.auth.user.is_manager?K("",!0):(V(),te(x,{key:0},{default:l(({isHovering:t,props:f})=>[e(I,g(f,{color:t?"accent":"primary",dark:""}),{default:l(()=>[y(" Anlegen "),e(X,{modelValue:O.value,"onUpdate:modelValue":a[11]||(a[11]=o=>O.value=o),activator:"parent",width:"80vw"},{default:l(()=>[e(W,{height:"80vh"},{default:l(()=>[e(h,null,{default:l(()=>[qe]),_:1}),e(H,null,{default:l(()=>[e(G,null,{default:l(()=>[e(r,null,{default:l(()=>[e(n,{cols:"12"},{default:l(()=>[Be]),_:1})]),_:1}),e(r,null,{default:l(()=>[e(n,{cols:"12",sm:"6"},{default:l(()=>[e(p,{modelValue:d(u).name,"onUpdate:modelValue":a[0]||(a[0]=o=>d(u).name=o),"error-messages":_.value.name,label:"Name der Einrichtung / Einrichtung*",required:""},null,8,["modelValue","error-messages"])]),_:1}),e(n,{cols:"12",sm:"6"},{default:l(()=>[e(p,{modelValue:d(u).number,"onUpdate:modelValue":a[1]||(a[1]=o=>d(u).number=o),"error-messages":_.value.number,label:"Kita Nummer*",type:"number",required:""},null,8,["modelValue","error-messages"])]),_:1})]),_:1}),e(r,null,{default:l(()=>[e(n,{cols:"12",sm:"6"},{default:l(()=>[e(p,{modelValue:d(u).street,"onUpdate:modelValue":a[2]||(a[2]=o=>d(u).street=o),"error-messages":_.value.street,label:"Straße*",required:""},null,8,["modelValue","error-messages"])]),_:1}),e(n,{cols:"12",sm:"6"},{default:l(()=>[e(p,{modelValue:d(u).house_number,"onUpdate:modelValue":a[3]||(a[3]=o=>d(u).house_number=o),"error-messages":_.value.house_number,label:"Hausnummer*",required:""},null,8,["modelValue","error-messages"])]),_:1})]),_:1}),e(r,null,{default:l(()=>[e(n,{cols:"12"},{default:l(()=>[e(p,{modelValue:d(u).additional_info,"onUpdate:modelValue":a[4]||(a[4]=o=>d(u).additional_info=o),"error-messages":_.value.additional_info,label:"Sonstiges",required:""},null,8,["modelValue","error-messages"])]),_:1})]),_:1}),e(r,null,{default:l(()=>[e(n,{cols:"12",sm:"6"},{default:l(()=>[e(p,{modelValue:d(u).zip_code,"onUpdate:modelValue":a[5]||(a[5]=o=>d(u).zip_code=o),"error-messages":_.value.zip_code,label:"Postleitzahl*",type:"number",required:""},null,8,["modelValue","error-messages"])]),_:1}),e(n,{cols:"12",sm:"6"},{default:l(()=>[e(p,{modelValue:d(u).city,"onUpdate:modelValue":a[6]||(a[6]=o=>d(u).city=o),"error-messages":_.value.city,label:"Stadt*",required:""},null,8,["modelValue","error-messages"])]),_:1})]),_:1}),e(r,null,{default:l(()=>[e(n,{cols:"12"},{default:l(()=>[Ie]),_:1})]),_:1}),e(r,null,{default:l(()=>[e(n,{cols:"12",sm:"6"},{default:l(()=>[e(z,{modelValue:d(u).operator_id,"onUpdate:modelValue":a[7]||(a[7]=o=>d(u).operator_id=o),items:F.operators,"error-messages":_.value.operator_id,"item-title":"name","item-value":"id",label:"Träger der Einrichtung*",required:""},null,8,["modelValue","items","error-messages"])]),_:1}),e(n,{cols:"12",sm:"6"},{default:l(()=>[e(p,{modelValue:d(u).num_pedagogical_staff,"onUpdate:modelValue":a[8]||(a[8]=o=>d(u).num_pedagogical_staff=o),"error-messages":_.value.num_pedagogical_staff,label:"Größe pädagogisches Team",type:"number"},null,8,["modelValue","error-messages"])]),_:1})]),_:1}),e(r,null,{default:l(()=>[e(n,{cols:"12",sm:"6"},{default:l(()=>[e(ze,{modelValue:d(u).approved,"onUpdate:modelValue":a[9]||(a[9]=o=>d(u).approved=o),label:"Kita zur Ampel zugelassen",value:!0},null,8,["modelValue"])]),_:1}),e(n,{cols:"12",sm:"6"},{default:l(()=>[e(z,{modelValue:d(u).type,"onUpdate:modelValue":a[10]||(a[10]=o=>d(u).type=o),items:F.types,"error-messages":_.value.type,label:"Träger der Einrichtung*",required:""},null,8,["modelValue","items","error-messages"])]),_:1})]),_:1})]),_:1})]),_:1}),e(Q,null,{default:l(()=>[e(x,null,{default:l(({isHovering:o,props:$})=>[e(Z,g({onClick:Ue},$,{color:o?"accent":"primary"}),{default:l(()=>[y("Zurücksetzen")]),_:2},1040,["color"])]),_:2},1024),e(L),e(x,null,{default:l(({isHovering:o,props:$})=>[e(I,g({onClick:A},$,{color:o?"accent":"primary"}),{default:l(()=>[y("Stornieren")]),_:2},1040,["color"])]),_:2},1024),e(x,null,{default:l(({isHovering:o,props:$})=>[e(Z,g({onClick:Pe},$,{color:o?"accent":"primary"}),{default:l(()=>[y("Speichern")]),_:2},1040,["color"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1032,["modelValue"])]),_:2},1040,["color"])]),_:1}))]),e(X,{modelValue:Y.value,"onUpdate:modelValue":a[12]||(a[12]=t=>Y.value=t),width:"20vw"},{default:l(()=>[e(W,{height:"30vh"},{default:l(()=>[e(H,null,{default:l(()=>[e(G,null,{default:l(()=>[e(r,null,{default:l(()=>[e(n,{cols:"12"},{default:l(()=>[i("p",null,"Sind Sie sicher, dass Sie die Einrichtung "+N(ue.value)+" löschen möchten?",1)]),_:1})]),_:1})]),_:1})]),_:1}),e(Q,null,{default:l(()=>[e(L),e(x,null,{default:l(({isHovering:t,props:f})=>[e(I,g({onClick:A},f,{color:t?"accent":"primary"}),{default:l(()=>[y("Abbrechen")]),_:2},1040,["color"])]),_:1}),e(x,null,{default:l(({isHovering:t,props:f})=>[e(Z,g({onClick:Se},f,{color:t?"accent":"primary"}),{default:l(()=>[y("Löschen")]),_:2},1040,["color"])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),default:l(()=>[i("div",Je,[s.$page.props.auth.user.is_super_admin?(V(),D("div",Oe,[i("div",Me,[e(r,null,{default:l(()=>[e(n,{cols:"12",sm:"4"},{default:l(()=>[e(p,{modelValue:w.value,"onUpdate:modelValue":a[13]||(a[13]=t=>w.value=t),label:"Suchen",disabled:b.value,clearable:""},null,8,["modelValue","disabled"])]),_:1}),e(n,{cols:"12",sm:"4"},{default:l(()=>[e(z,{modelValue:k.value,"onUpdate:modelValue":a[14]||(a[14]=t=>k.value=t),items:be,label:`Jährliche Rückmeldung ${new Date().getFullYear()} abgeschlossen`,multiple:"",disabled:b.value,clearable:""},null,8,["modelValue","label","disabled"])]),_:1}),e(n,{cols:"12",sm:"4"},{default:l(()=>[e(z,{modelValue:E.value,"onUpdate:modelValue":a[15]||(a[15]=t=>E.value=t),items:he,label:"Zugelassen",multiple:"",disabled:b.value,clearable:""},null,8,["modelValue","disabled"])]),_:1})]),_:1}),e(r,null,{default:l(()=>[e(n,{cols:"12",sm:"4"},{default:l(()=>[e(z,{modelValue:S.value,"onUpdate:modelValue":a[16]||(a[16]=t=>S.value=t),items:F.operators,"item-title":"name","item-value":"id",label:"Träger",multiple:"",disabled:b.value,clearable:""},null,8,["modelValue","items","disabled"])]),_:1}),e(n,{cols:"12",sm:"4"},{default:l(()=>[e(z,{modelValue:U.value,"onUpdate:modelValue":a[17]||(a[17]=t=>U.value=t),items:F.types,label:"Typ",multiple:"",disabled:b.value,clearable:""},null,8,["modelValue","items","disabled"])]),_:1}),e(n,{cols:"12",sm:"4"},{default:l(()=>[e(z,{modelValue:P.value,"onUpdate:modelValue":a[18]||(a[18]=t=>P.value=t),items:F.zipCodes,label:"Postleitzahl",multiple:"",disabled:b.value,clearable:""},null,8,["modelValue","items","disabled"])]),_:1})]),_:1})])])):K("",!0),s.$page.props.auth.user.is_super_admin?(V(),D("div",Ye,[e(r,{class:"flex justify-end mb-4"},{default:l(()=>[e(x,null,{default:l(({isHovering:t,props:f})=>[e(n,{cols:"12",sm:"4",class:"text-right"},{default:l(()=>[e(I,g(f,{color:t?"accent":"primary",dark:"",onClick:ke}),{default:l(()=>[e(R,g(f,{size:"small",class:"tw-me-2"}),{default:l(()=>[y("mdi-email")]),_:2},1040),Ze]),_:2},1040,["color"])]),_:2},1024)]),_:1})]),_:1})])):K("",!0),e(xe,{"items-per-page":j.value,"onUpdate:itemsPerPage":a[20]||(a[20]=t=>j.value=t),"items-per-page-options":[{value:10,title:"10"},{value:25,title:"25"},{value:50,title:"50"},{value:100,title:"100"},{value:-1,title:"$vuetify.dataFooter.itemsPerPageAll"}],"items-per-page-text":"Objekte pro Seite:",headers:ye,page:J.value,"items-length":oe.value,items:Ve.value,search:se.value,loading:b.value,class:"data-table-container elevation-1","item-value":"name","onUpdate:options":ne},{item:l(({item:t})=>{var f;return[i("tr",{"data-id":t.id,"data-order":t.order},[i("td",null,N(t==null?void 0:t.name),1),i("td",null,N(t!=null&&t.has_yearly_evaluations?"Ja":"Nein"),1),i("td",null,N(t!=null&&t.approved?"Ja":"Nein"),1),i("td",null,N(((f=t==null?void 0:t.operator)==null?void 0:f.name)??"-"),1),i("td",null,N((t==null?void 0:t.formatted_type)??(t==null?void 0:t.type)),1),i("td",null,N(t==null?void 0:t.zip_code),1),i("td",Ge,[s.$page.props.auth.user.is_super_admin?(V(),D(ae,{key:0},[t!=null&&t.approved&&(t==null?void 0:t.users_emails.length)>0?(V(),te(ee,{key:0,location:"top"},{activator:l(({props:o})=>[i("a",g({href:`mailto:?bcc=${t==null?void 0:t.users_emails.join(",")}`},o),[e(R,g(o,{size:"small",class:"tw-me-2"}),{default:l(()=>[y("mdi-email")]),_:2},1040)],16,He)]),default:l(()=>[Le]),_:2},1024)):K("",!0)],64)):K("",!0),e(ee,{location:"top"},{activator:l(({props:o})=>[e(d(Te),{href:s.route("kitas.show",{id:t.id})},{default:l(()=>[e(R,g(o,{size:"small",class:"tw-me-2"}),{default:l(()=>[y("mdi-pencil")]),_:2},1040)]),_:2},1032,["href"])]),default:l(()=>[Qe]),_:2},1024),!s.$page.props.auth.user.is_manager&&!s.$page.props.auth.user.is_user_multiplier?(V(),te(ee,{key:1,location:"top"},{activator:l(({props:o})=>[e(R,g(o,{size:"small",class:"tw-me-2",onClick:$=>Ee(t.raw)}),{default:l(()=>[y("mdi-delete")]),_:2},1040,["onClick"])]),default:l(()=>[We]),_:2},1024)):K("",!0)])],8,Re)]}),"no-data":l(()=>[i("div",Xe,[re.value?(V(),D("h3",el,"Die Tabelle ist leer.")):(V(),D(ae,{key:1},[ll,e(I,{color:"primary",onClick:a[19]||(a[19]=t=>ne({page:1,itemsPerPage:j.value,clearFilters:!0}))},{default:l(()=>[y("Reset")]),_:1})],64))])]),_:1},8,["items-per-page","items-per-page-options","page","items-length","items","search","loading"])]),e(X,{modelValue:M.value,"onUpdate:modelValue":a[22]||(a[22]=t=>M.value=t),width:"40vw"},{default:l(()=>[e(W,{height:"80vh"},{default:l(()=>[e(h,null,{default:l(()=>[al]),_:1}),e(H,null,{default:l(()=>[e(G,null,{default:l(()=>[e(r,null,{default:l(()=>[e(n,{cols:"12"},{default:l(()=>[e(z,{modelValue:q.value,"onUpdate:modelValue":a[21]||(a[21]=t=>q.value=t),items:F.usersEmails,label:"Benutzer",multiple:"",disabled:b.value,clearable:""},null,8,["modelValue","items","disabled"])]),_:1})]),_:1})]),_:1})]),_:1}),e(Q,null,{default:l(()=>[e(L),e(x,null,{default:l(({isHovering:t,props:f})=>[e(Z,g({href:`mailto:?bcc=${q.value.join(",")}`},f,{color:t?"accent":"primary",disabled:!q.value.length}),{default:l(()=>[y(" Öffnen Sie den Mail-Client ")]),_:2},1040,["href","color","disabled"])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["errors"])],64)}}};export{rl as default};
