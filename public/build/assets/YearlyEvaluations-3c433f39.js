import{d as De}from"./index-82fa8462.js";import{K as Ae,k as g,h as I,m as Ke,T as ne,r as m,n as Pe,f as A,a as e,u as n,w as a,F as oe,o as b,Z as Se,b as u,p as k,d as w,c as J,g as D,t as v,q as Ee,i as xe,O as Te}from"./app-75f613fc.js";import{_ as Ue}from"./AuthenticatedLayout-9bf26adc.js";import{W as q}from"./WarningEvaluationTooltip-ccc57cdf.js";import"./ApplicationLogo-8ab043d2.js";const Ie=u("h2",{class:"tw-font-semibold tw-text-xl tw-text-gray-800 tw-leading-tight"},"Jährliche Rückmeldung",-1),Je={class:"tw-flex tw-items-center tw-justify-end"},Ye=u("span",{class:"tw-text-h5"},"Jährliche Rückmeldung erstellen",-1),Be=u("h3",null,"Rückmeldung betrifft",-1),Fe=u("h3",null,"Angaben zur Rückmeldung",-1),Ne=u("h5",null,"Kinder bis 2,5 Jahre",-1),Ce=u("h5",null,"Kinder bis 4,5 Jahre",-1),qe=u("h4",null,"Wir haben eine Abweichung zwischen der Anzahl der von Ihnen gemeldeten Kinder und der Anzahl über die BeoKiz-Ampel erfassten Kindern festgestellt:",-1),We={class:"tw-flex tw-items-center tw-mt-2"},Re={style:{"list-style-type":"disc","margin-left":"25px"}},Oe={key:0},$e={key:1},je={key:2},Le={key:3},He={class:"tw-table-block tw-max-w-full tw-mx-auto tw-py-6 tw-px-4 sm:tw-px-6 lg:tw-px-8"},Me=["data-id","data-order"],Ze={align:"center"},Ge=u("span",null,"Jährliche Rückmeldung bearbeiten",-1),Qe=u("span",null,"Jährliche Rückmeldung löschen",-1),Xe={class:"tw-py-6"},ea={key:0,class:"tw-mb-4"},aa=u("h3",{class:"tw-mb-4"},"Die Tabelle ist leer. Bitte setzen Sie die Suchfilter zurück.",-1),ia={__name:"YearlyEvaluations",props:{items:Array,currentPage:Number,perPage:Number,lastPage:Number,total:Number,paging:Boolean,orderBy:String,sort:String,filters:Object,errors:Object,kitas:Array,surveyTimePeriods:Array,evaluationsWithDaz2TotalPerYear:Number,evaluationsWithDaz4TotalPerYear:Number,evaluationsWithoutDaz2TotalPerYear:Number,evaluationsWithoutDaz4TotalPerYear:Number},setup(G){const s=G;De.Inertia.on("success",i=>{let l=i.detail.page.props;i.detail.page.component==="YearlyEvaluations/YearlyEvaluations"&&l&&(Y.value=l.currentPage,P.value=l.perPage,se.value=l.orderBy,ie.value=l.sort,Q.value=l.total,_e.value=l.lastPage,S.value=l.filters.search??null)}),Ae().props.auth.user;const Y=g(s.currentPage),P=g(s.perPage),se=g(s.orderBy),ie=g(s.sort),Q=g(s.total),_e=g(s.lastPage),S=g(s.filters.search??null),ue=g(""),h=g(s.errors||{}),W=g(!1),B=g(!1),E=g(!1),F=g(!1),X=g(null),N=g(!1),R=g(!1),de=[{title:"Jahr",key:"year",width:"7%",sortable:!1},{title:"Kitas",key:"kita_name",width:"11%",sortable:!1},{title:"gemeldete Kinder  bis 2,5 Jahre",key:"children_2_born_per_year",width:"18%",sortable:!1},{title:"gemeldete Kinder  bis 4,5 Jahre",key:"children_4_born_per_year",width:"18%",sortable:!1},{title:"Evaluationen für Kinder  bis 2,5 Jahre",key:"evaluations_with_daz_2_total_per_year",width:"18%",sortable:!1},{title:"Evaluationen für Kinder  bis 4,5 Jahre",key:"evaluations_with_daz_4_total_per_year",width:"18%",sortable:!1},{title:"Aktion",key:"actions",width:"10%",sortable:!1,align:"center"}],ce=I(()=>s.items.map(i=>{const l={...i};for(const d in l)(l[d]===null||l[d]===void 0)&&(l[d]="-");return l})),ee=I(()=>S.value===null),me=I(()=>S.value!==null),he=I(()=>te("2.5")),ge=I(()=>te("4.5"));Ke(B,i=>{i||K()});const ae=async({page:i,itemsPerPage:l,sortBy:d,clearFilters:_})=>{if(_&&(S.value=null),i===Y.value&&_||ee||me){W.value=!0;let c={data:{page:i,per_page:l}};d&&d.length>0&&(c.data.order_by=d[0].key,c.data.sort=d[0].order),c.data.search=S.value,await Te.reload(c),Y.value=i,P.value=l,W.value=!1}},ve=i=>{X.value=i.year,x.id=i.id,F.value=!0},x=ne({id:null}),pe=async()=>{x.processing=!0;let i={onSuccess:l=>{K()},onError:l=>{K(),h.value=l},onFinish:()=>{x.processing=!1}};x.delete(route("yearly_evaluations.destroy",{id:x.id}),i)},le=()=>{E.value=!1},fe=()=>{R.value=!0,le()},K=()=>{B.value=!1,E.value=!1,F.value=!1,N.value=!1,R.value=!1,t.reset(),t.clearErrors(),h.value={}},be=()=>{t.reset(),t.clearErrors()},t=ne({year:new Date().getFullYear().toString().padStart(4,"0"),kita_id:(s==null?void 0:s.kitas.length)>0?s==null?void 0:s.kitas[0].id:null,evaluations_with_daz_2_total_per_year:(s==null?void 0:s.evaluationsWithDaz2TotalPerYear)??0,evaluations_with_daz_4_total_per_year:(s==null?void 0:s.evaluationsWithDaz4TotalPerYear)??0,evaluations_without_daz_2_total_per_year:(s==null?void 0:s.evaluationsWithoutDaz2TotalPerYear)??0,evaluations_without_daz_4_total_per_year:(s==null?void 0:s.evaluationsWithoutDaz4TotalPerYear)??0,children_2_born_per_year:null,children_4_born_per_year:null,children_2_with_german_lang:null,children_4_with_german_lang:null,children_2_with_foreign_lang:null,children_4_with_foreign_lang:null}),ye=async()=>{t.processing=!0,t.post(route("yearly_evaluations.store"),{onSuccess:i=>{K()},onError:i=>{h.value=i},onFinish:()=>{t.processing=!1}})},p=i=>{if(i==="2_german")return parseInt(t.evaluations_with_daz_2_total_per_year)!==parseInt(t.children_2_with_german_lang);if(i==="2_foreign")return parseInt(t.evaluations_without_daz_2_total_per_year)!==parseInt(t.children_2_with_foreign_lang);if(i==="4_german")return parseInt(t.evaluations_with_daz_4_total_per_year)!==parseInt(t.children_4_with_german_lang);if(i==="4_foreign")return parseInt(t.evaluations_without_daz_4_total_per_year)!==parseInt(t.children_4_with_foreign_lang)},we=async()=>{(p("2_german")||p("2_foreign")||p("4_german")||p("4_foreign"))&&!R.value?E.value=!0:await ye()},te=i=>{if(i==="2.5"||i==="4.5"){let l=s.surveyTimePeriods.find(d=>d.year===parseInt(t.year)&&d.age==="4.5");if(l){let d=new Date(l.survey_start_date),_=new Date(l.survey_end_date),c=d.getFullYear()+"-"+("0"+(d.getMonth()+1)).slice(-2)+"-"+("0"+d.getDate()).slice(-2),O=_.getFullYear()+"-"+("0"+(_.getMonth()+1)).slice(-2)+"-"+("0"+_.getDate()).slice(-2);return`Gesamtzahl der im Zeitraum ${c} - ${O} geborenen Kinder`}}return"Gesamtzahl der Kinder"};return(i,l)=>{const d=m("v-card-title"),_=m("v-col"),c=m("v-text-field"),O=m("v-select"),f=m("v-row"),T=m("v-card"),$=m("v-container"),j=m("v-card-text"),C=m("v-btn-primary"),V=m("v-hover"),L=m("v-spacer"),U=m("v-btn"),H=m("v-card-actions"),M=m("v-dialog"),Z=m("v-icon"),ke=m("v-checkbox"),re=m("v-tooltip"),ze=m("v-data-table-server"),Ve=Pe("sortable-data-table");return b(),A(oe,null,[e(n(Se),{title:"Jährliche Rückmeldung"}),e(Ue,{errors:h.value},{header:a(()=>[Ie,u("div",Je,[e(V,null,{default:a(({isHovering:o,props:y})=>[e(U,k(y,{color:o?"accent":"primary",dark:""}),{default:a(()=>[w(" ANLEGEN "),e(M,{modelValue:B.value,"onUpdate:modelValue":l[12]||(l[12]=r=>B.value=r),activator:"parent",width:"80vw"},{default:a(()=>[e(T,{height:"80vh"},{default:a(()=>[e(d,null,{default:a(()=>[Ye]),_:1}),e(j,null,{default:a(()=>[e($,null,{default:a(()=>[e(f,null,{default:a(()=>[e(_,{cols:"12",sm:"12"},{default:a(()=>[Be]),_:1}),e(_,{cols:"12",sm:"4"},{default:a(()=>[e(c,{modelValue:n(t).year,"onUpdate:modelValue":l[0]||(l[0]=r=>n(t).year=r),"error-messages":h.value.year,label:"Jahr der Rückmeldung*",required:""},null,8,["modelValue","error-messages"])]),_:1}),e(_,{cols:"12",sm:"4"},{default:a(()=>[e(O,{modelValue:n(t).kita_id,"onUpdate:modelValue":l[1]||(l[1]=r=>n(t).kita_id=r),items:G.kitas,"error-messages":h.value.kita_id,"item-title":"name","item-value":"id",label:"Kita*"},null,8,["modelValue","items","error-messages"])]),_:1})]),_:1}),e(f,null,{default:a(()=>[e(_,{cols:"12",sm:"12"},{default:a(()=>[Fe]),_:1}),e(_,{cols:"12",sm:"6"},{default:a(()=>[e(T,{class:"tw-p-6"},{default:a(()=>[Ne,e(c,{modelValue:n(t).children_2_born_per_year,"onUpdate:modelValue":l[2]||(l[2]=r=>n(t).children_2_born_per_year=r),"error-messages":h.value.children_2_born_per_year,label:he.value,type:"number",required:""},null,8,["modelValue","error-messages","label"]),e(f,null,{default:a(()=>[e(_,{cols:"12",sm:"7"},{default:a(()=>[e(c,{modelValue:n(t).children_2_with_german_lang,"onUpdate:modelValue":l[3]||(l[3]=r=>n(t).children_2_with_german_lang=r),"error-messages":h.value.children_2_with_german_lang,label:"Kinder mit deutscher Herkunftssprache*",type:"number",required:""},null,8,["modelValue","error-messages"])]),_:1}),e(_,{cols:"12",sm:"5"},{default:a(()=>[e(f,null,{default:a(()=>[p("2_german")?(b(),J(q,{key:0})):D("",!0),e(_,{cols:"12",sm:"10"},{default:a(()=>[e(c,{modelValue:n(t).evaluations_with_daz_2_total_per_year,"onUpdate:modelValue":l[4]||(l[4]=r=>n(t).evaluations_with_daz_2_total_per_year=r),"error-messages":h.value.evaluations_with_daz_2_total_per_year,label:"Bisher eingereichte Einschätzungen",type:"number",disabled:"",required:""},null,8,["modelValue","error-messages"])]),_:1})]),_:1})]),_:1})]),_:1}),e(f,null,{default:a(()=>[e(_,{cols:"12",sm:"7"},{default:a(()=>[e(c,{modelValue:n(t).children_2_with_foreign_lang,"onUpdate:modelValue":l[5]||(l[5]=r=>n(t).children_2_with_foreign_lang=r),"error-messages":h.value.children_2_with_foreign_lang,label:"Kinder mit nicht deutscher Herkunftssprache*",type:"number",required:""},null,8,["modelValue","error-messages"])]),_:1}),e(_,{cols:"12",sm:"5"},{default:a(()=>[e(f,null,{default:a(()=>[p("2_foreign")?(b(),J(q,{key:0})):D("",!0),e(_,{cols:"12",sm:"10"},{default:a(()=>[e(c,{modelValue:n(t).evaluations_without_daz_2_total_per_year,"onUpdate:modelValue":l[6]||(l[6]=r=>n(t).evaluations_without_daz_2_total_per_year=r),"error-messages":h.value.evaluations_without_daz_2_total_per_year,label:"Bisher eingereichte Einschätzungen",type:"number",disabled:"",required:""},null,8,["modelValue","error-messages"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),e(_,{cols:"12",sm:"6"},{default:a(()=>[e(T,{class:"tw-p-6"},{default:a(()=>[Ce,e(c,{modelValue:n(t).children_4_born_per_year,"onUpdate:modelValue":l[7]||(l[7]=r=>n(t).children_4_born_per_year=r),"error-messages":h.value.children_4_born_per_year,label:ge.value,type:"number",required:""},null,8,["modelValue","error-messages","label"]),e(f,null,{default:a(()=>[e(_,{cols:"12",sm:"7"},{default:a(()=>[e(c,{modelValue:n(t).children_4_with_german_lang,"onUpdate:modelValue":l[8]||(l[8]=r=>n(t).children_4_with_german_lang=r),"error-messages":h.value.children_4_with_german_lang,label:"Kinder mit deutscher Herkunftssprache*",type:"number",required:""},null,8,["modelValue","error-messages"])]),_:1}),e(_,{cols:"12",sm:"5"},{default:a(()=>[e(f,null,{default:a(()=>[p("4_german")?(b(),J(q,{key:0})):D("",!0),e(_,{cols:"12",sm:"10"},{default:a(()=>[e(c,{modelValue:n(t).evaluations_with_daz_4_total_per_year,"onUpdate:modelValue":l[9]||(l[9]=r=>n(t).evaluations_with_daz_4_total_per_year=r),"error-messages":h.value.evaluations_with_daz_4_total_per_year,label:"Bisher eingereichte Einschätzungen",type:"number",disabled:"",required:""},null,8,["modelValue","error-messages"])]),_:1})]),_:1})]),_:1})]),_:1}),e(f,null,{default:a(()=>[e(_,{cols:"12",sm:"7"},{default:a(()=>[e(c,{modelValue:n(t).children_4_with_foreign_lang,"onUpdate:modelValue":l[10]||(l[10]=r=>n(t).children_4_with_foreign_lang=r),"error-messages":h.value.children_4_with_foreign_lang,label:"Kinder mit nicht deutscher Herkunftssprache*",type:"number",required:""},null,8,["modelValue","error-messages"])]),_:1}),e(_,{cols:"12",sm:"5"},{default:a(()=>[e(f,null,{default:a(()=>[p("4_foreign")?(b(),J(q,{key:0})):D("",!0),e(_,{cols:"12",sm:"10"},{default:a(()=>[e(c,{modelValue:n(t).evaluations_without_daz_4_total_per_year,"onUpdate:modelValue":l[11]||(l[11]=r=>n(t).evaluations_without_daz_4_total_per_year=r),"error-messages":h.value.evaluations_without_daz_4_total_per_year,label:"Bisher eingereichte Einschätzungen",type:"number",disabled:"",required:""},null,8,["modelValue","error-messages"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),e(H,null,{default:a(()=>[e(V,null,{default:a(({isHovering:r,props:z})=>[e(C,k({onClick:be},z,{color:r?"accent":"primary"}),{default:a(()=>[w("Zurücksetzen")]),_:2},1040,["color"])]),_:2},1024),e(L),e(V,null,{default:a(({isHovering:r,props:z})=>[e(U,k({onClick:K},z,{color:r?"accent":"primary"}),{default:a(()=>[w("Stornieren")]),_:2},1040,["color"])]),_:2},1024),e(V,null,{default:a(({isHovering:r,props:z})=>[e(C,k({onClick:we},z,{color:r?"accent":"primary"}),{default:a(()=>[w("Speichern")]),_:2},1040,["color"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1032,["modelValue"])]),_:2},1040,["color"])]),_:1})]),e(M,{modelValue:F.value,"onUpdate:modelValue":l[13]||(l[13]=o=>F.value=o),width:"20vw"},{default:a(()=>[e(T,{height:"30vh"},{default:a(()=>[e(j,null,{default:a(()=>[e($,null,{default:a(()=>[e(f,null,{default:a(()=>[e(_,{cols:"12"},{default:a(()=>[u("p",null,"Sind Sie sicher, dass Sie die Jährliche Rückmeldung "+v(X.value)+" löschen möchten?",1)]),_:1})]),_:1})]),_:1})]),_:1}),e(H,null,{default:a(()=>[e(L),e(V,null,{default:a(({isHovering:o,props:y})=>[e(U,k({onClick:K},y,{color:o?"accent":"primary"}),{default:a(()=>[w("Abbrechen")]),_:2},1040,["color"])]),_:1}),e(V,null,{default:a(({isHovering:o,props:y})=>[e(C,k({onClick:pe},y,{color:o?"accent":"primary"}),{default:a(()=>[w("Löschen")]),_:2},1040,["color"])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(M,{modelValue:E.value,"onUpdate:modelValue":l[15]||(l[15]=o=>E.value=o),width:"80vw"},{default:a(()=>[e(T,{height:"50vh"},{default:a(()=>[e(j,null,{default:a(()=>[e($,null,{default:a(()=>[e(f,null,{default:a(()=>[e(_,{cols:"12"},{default:a(()=>[qe,u("div",We,[e(Z,k(s,{icon:"mdi-alert",color:"orange"}),null,16),u("ul",Re,[p("2_german")?(b(),A("li",Oe," Die Anzahl der Kinder im Alter bis 2,5 Jahre welche Deutsch als Fremdsprache haben Sie mit "+v(n(t).children_2_with_german_lang)+" angegeben, die Anzahl der über die BeoKiz-Ampel erfassten Kindern beträgt "+v(n(t).evaluations_with_daz_2_total_per_year),1)):D("",!0),p("2_foreign")?(b(),A("li",$e," Die Anzahl der Kinder im Alter bis 2,5 Jahre welche Deutsch als Muttersprache haben Sie mit "+v(n(t).children_2_with_foreign_lang)+" angegeben, die Anzahl der über die BeoKiz-Ampel erfassten Kindern beträgt "+v(n(t).evaluations_without_daz_2_total_per_year),1)):D("",!0),p("4_german")?(b(),A("li",je," Die Anzahl der Kinder im Alter bis 4,5 Jahre welche Deutsch als Fremdsprache haben Sie mit "+v(n(t).children_4_with_german_lang)+" angegeben, die Anzahl der über die BeoKiz-Ampel erfassten Kindern beträgt "+v(n(t).evaluations_with_daz_2_total_per_year),1)):D("",!0),p("4_foreign")?(b(),A("li",Le," Die Anzahl der Kinder im Alter bis 4,5 Jahre welche Deutsch als Muttersprache haben Sie mit "+v(n(t).children_4_with_foreign_lang)+" angegeben, die Anzahl der über die BeoKiz-Ampel erfassten Kindern beträgt "+v(n(t).evaluations_without_daz_4_total_per_year),1)):D("",!0)])]),e(ke,{modelValue:N.value,"onUpdate:modelValue":l[14]||(l[14]=o=>N.value=o),label:"Ich habe verstanden, dass es Unstimmigkeiten bei dem Abgelich der gemelden Zahlen gibt, Statusmeldung dennoch absenden."},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),e(H,null,{default:a(()=>[e(L),e(V,null,{default:a(({isHovering:o,props:y})=>[e(U,{onClick:le,color:o?"accent":"primary"},{default:a(()=>[w("Abbrechen")]),_:2},1032,["color"])]),_:1}),e(V,null,{default:a(({isHovering:o,props:y})=>[e(C,k({disabled:!N.value,onClick:fe},y,{color:o?"accent":"primary"}),{default:a(()=>[w("Speichern")]),_:2},1040,["disabled","color"])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),default:a(()=>[u("div",He,[Ee((b(),J(ze,{"items-per-page":P.value,"onUpdate:itemsPerPage":l[17]||(l[17]=o=>P.value=o),"items-per-page-options":[{value:10,title:"10"},{value:25,title:"25"},{value:50,title:"50"},{value:100,title:"100"},{value:-1,title:"$vuetify.dataFooter.itemsPerPageAll"}],"items-per-page-text":"Objekte pro Seite:",headers:de,page:Y.value,"items-length":Q.value,items:ce.value,search:ue.value,loading:W.value,class:"data-table-container elevation-1","item-value":"name","onUpdate:options":ae},{item:a(({item:o})=>{var y,r;return[u("tr",{"data-id":o.selectable.id,"data-order":o.selectable.order},[u("td",null,v(o.selectable.year),1),u("td",null,v((r=(y=o.selectable)==null?void 0:y.kita)==null?void 0:r.formatted_name),1),u("td",null,v(o.selectable.children_2_born_per_year),1),u("td",null,v(o.selectable.children_4_born_per_year),1),u("td",null,v(o.selectable.evaluations_with_daz_2_total_per_year+o.selectable.evaluations_without_daz_2_total_per_year),1),u("td",null,v(o.selectable.evaluations_with_daz_4_total_per_year+o.selectable.evaluations_without_daz_4_total_per_year),1),u("td",Ze,[e(re,{location:"top"},{activator:a(({props:z})=>[e(n(xe),{href:i.route("yearly_evaluations.show",{id:o.selectable.id})},{default:a(()=>[e(Z,k(z,{size:"small",class:"tw-me-2"}),{default:a(()=>[w("mdi-pencil")]),_:2},1040)]),_:2},1032,["href"])]),default:a(()=>[Ge]),_:2},1024),e(re,{location:"top"},{activator:a(({props:z})=>[e(Z,k(z,{size:"small",class:"tw-me-2",onClick:la=>ve(o.raw)}),{default:a(()=>[w("mdi-delete")]),_:2},1040,["onClick"])]),default:a(()=>[Qe]),_:2},1024)])],8,Me)]}),"no-data":a(()=>[u("div",Xe,[ee.value?(b(),A("h3",ea,"Die Tabelle ist leer.")):(b(),A(oe,{key:1},[aa,e(U,{color:"primary",onClick:l[16]||(l[16]=o=>ae({page:1,itemsPerPage:P.value,clearFilters:!0}))},{default:a(()=>[w("Reset")]),_:1})],64))])]),_:1},8,["items-per-page","items-per-page-options","page","items-length","items","search","loading"])),[[Ve]])])]),_:1},8,["errors"])],64)}}};export{ia as default};
