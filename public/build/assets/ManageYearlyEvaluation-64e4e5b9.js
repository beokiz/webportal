import{d as Q}from"./index-a0304548.js";import{K as X,k as y,T as ee,h as q,m as v,r as d,f as k,a,u as _,w as r,F as ae,o as m,Z as le,b as p,t as g,c as E,g as f,i as re,p as I,d as x}from"./app-9eb8fe0c.js";import{_ as te}from"./AuthenticatedLayout-f2b417d9.js";import{W as D}from"./WarningEvaluationTooltip-5cee0dfe.js";import"./ApplicationLogo-71e7e7d1.js";const ne={class:"tw-font-semibold tw-text-xl tw-text-gray-800 tw-leading-tight"},_e={class:"tw-table-block tw-max-w-full tw-mx-auto tw-py-6 tw-px-4 sm:tw-px-6 lg:tw-px-8"},ie=p("h3",null,"Rückmeldung betrifft",-1),oe=p("h3",null,"Angaben zur Rückmeldung",-1),se=p("h5",null,"Kinder bis 2,5 Jahre",-1),de=p("h5",null,"Kinder bis 4,5 Jahre",-1),ue=p("h4",null,"Wir haben eine Abweichung zwischen der Anzahl der von Ihnen gemeldeten Kinder und der Anzahl über die BeoKiz-Ampel erfassten Kindern festgestellt:",-1),he={class:"tw-flex tw-items-center tw-mt-2"},ce={style:{"list-style-type":"disc","margin-left":"25px"}},me={key:0},ge={key:1},pe={key:2},ve={key:3},Ve={__name:"ManageYearlyEvaluation",props:{yearlyEvaluation:Object,errors:Object,kitas:Array,surveyTimePeriods:Array},setup(A){const w=A;Q.Inertia.on("success",i=>{let l=i.detail.page.props;i.detail.page.component==="YearlyEvaluations/Partials/ManageYearlyEvaluation"&&l&&(u.value=l.yearlyEvaluation)}),X().props.auth.user;const u=y(w.yearlyEvaluation),o=y(w.errors||{});y(!1);const V=y(!1),J=y(!1),S=y(!1),T=y(!0),e=ee({id:u.value.id,year:u.value.year,kita_id:u.value.kita_id,children_2_born_per_year:u.value.children_2_born_per_year,children_2_with_german_lang:u.value.children_2_with_german_lang,evaluations_with_daz_2_total_per_year:u.value.evaluations_with_daz_2_total_per_year,children_2_with_foreign_lang:u.value.children_2_with_foreign_lang,evaluations_without_daz_2_total_per_year:u.value.evaluations_without_daz_2_total_per_year,children_4_born_per_year:u.value.children_4_born_per_year,children_4_with_german_lang:u.value.children_4_with_german_lang,evaluations_with_daz_4_total_per_year:u.value.evaluations_with_daz_4_total_per_year,children_4_with_foreign_lang:u.value.children_4_with_foreign_lang,evaluations_without_daz_4_total_per_year:u.value.evaluations_without_daz_4_total_per_year});q(()=>w.yearlyEvaluation.map(i=>{const l={...i};for(const t in l)(l[t]===null||l[t]===void 0)&&(l[t]="-");return l}));const R=q(()=>C("2.5")),H=q(()=>C("4.5"));v(V,i=>{J.value=!0}),v(()=>e.kita_id,i=>{let l=w.kitas.find(t=>i===parseInt(t.id));l&&(e.evaluations_with_daz_2_total_per_year=l.evaluations_with_daz2_total_per_year_count,e.evaluations_with_daz_4_total_per_year=l.evaluations_with_daz4_total_per_year_count,e.evaluations_without_daz_2_total_per_year=l.evaluations_without_daz2_total_per_year_count,e.evaluations_without_daz_4_total_per_year=l.evaluations_without_daz4_total_per_year_count)}),v(()=>e.children_2_born_per_year,()=>{b("2.5")}),v(()=>e.children_2_with_german_lang,()=>{b("2.5")}),v(()=>e.children_2_with_foreign_lang,(i,l)=>{b("2.5")}),v(()=>e.children_4_born_per_year,(i,l)=>{b("4.5")}),v(()=>e.children_4_with_german_lang,(i,l)=>{b("4.5")}),v(()=>e.children_4_with_foreign_lang,(i,l)=>{b("4.5")});const F=()=>{V.value=!1},Y=async()=>{(c("2_german")||c("2_foreign")||c("4_german")||c("4_foreign"))&&!J.value?V.value=!0:await N()},c=i=>{if(i==="2_german")return parseInt(e.evaluations_with_daz_2_total_per_year)!==parseInt(e.children_2_with_german_lang);if(i==="2_foreign")return parseInt(e.evaluations_without_daz_2_total_per_year)!==parseInt(e.children_2_with_foreign_lang);if(i==="4_german")return parseInt(e.evaluations_with_daz_4_total_per_year)!==parseInt(e.children_4_with_german_lang);if(i==="4_foreign")return parseInt(e.evaluations_without_daz_4_total_per_year)!==parseInt(e.children_4_with_foreign_lang)},N=async()=>{e.processing=!0;let i={preserveState:!0,onSuccess:l=>{e.reset(),e.clearErrors(),o.value={}},onError:l=>{o.value=l},onFinish:()=>{F(),e.processing=!1}};e.put(route("yearly_evaluations.update",{id:e.id}),i)},C=i=>{if(i==="2.5"||i==="4.5"){let l=w.surveyTimePeriods.find(t=>t.year===parseInt(e.year)&&t.age==="4.5");if(l){let t=new Date(l.survey_start_date),s=new Date(l.survey_end_date),U=t.getFullYear()+"-"+("0"+(t.getMonth()+1)).slice(-2)+"-"+("0"+t.getDate()).slice(-2),h=s.getFullYear()+"-"+("0"+(s.getMonth()+1)).slice(-2)+"-"+("0"+s.getDate()).slice(-2);return`Gesamtzahl der im Zeitraum ${U} - ${h} geborenen Kinder`}}return"Gesamtzahl der Kinder"},b=i=>{if(i==="2.5"||i==="4.5"){let l=!1,t=!1;e.children_2_with_german_lang!==null&&e.children_2_with_german_lang!==void 0&&e.children_2_with_foreign_lang!==null&&e.children_2_with_foreign_lang!==void 0&&(parseInt(e.children_2_with_german_lang)+parseInt(e.children_2_with_foreign_lang)!==parseInt(e.children_2_born_per_year)?(o.value.children_2_born_per_year='Die ausgewählte "Anzahl der im ausgewählten Jahr geborenen Kinder" ist ungültig.',l=!1):(delete o.value.children_2_born_per_year,l=!0)),e.children_4_with_german_lang!==null&&e.children_4_with_german_lang!==void 0&&e.children_4_with_foreign_lang!==null&&e.children_4_with_foreign_lang!==void 0&&(parseInt(e.children_4_with_german_lang)+parseInt(e.children_4_with_foreign_lang)!==parseInt(e.children_4_born_per_year)?(o.value.children_4_born_per_year='Die ausgewählte "Anzahl der im ausgewählten Jahr geborenen Kinder" ist ungültig.',t=!1):(delete o.value.children_4_born_per_year,t=!0)),T.value=l&&t}};return(i,l)=>{const t=d("v-col"),s=d("v-text-field"),U=d("v-select"),h=d("v-row"),B=d("v-card"),M=d("v-btn"),K=d("v-hover"),P=d("v-btn-primary"),O=d("v-container"),Z=d("v-icon"),$=d("v-checkbox"),j=d("v-card-text"),L=d("v-spacer"),W=d("v-card-actions"),G=d("v-dialog");return m(),k(ae,null,[a(_(le),{title:`Verwalte Jährliche Rückmeldung ${A.yearlyEvaluation.year}`},null,8,["title"]),a(te,{errors:o.value},{header:r(()=>[p("h2",ne,"Jährliche Rückmeldung "+g(A.yearlyEvaluation.year),1)]),default:r(()=>[p("div",_e,[a(O,null,{default:r(()=>[a(h,null,{default:r(()=>[a(t,{cols:"12",sm:"12"},{default:r(()=>[ie]),_:1}),a(t,{cols:"12",sm:"4"},{default:r(()=>[a(s,{modelValue:_(e).year,"onUpdate:modelValue":l[0]||(l[0]=n=>_(e).year=n),"error-messages":o.value.year,label:"Jahr der Rückmeldung*",required:""},null,8,["modelValue","error-messages"])]),_:1}),a(t,{cols:"12",sm:"4"},{default:r(()=>[a(U,{modelValue:_(e).kita_id,"onUpdate:modelValue":l[1]||(l[1]=n=>_(e).kita_id=n),items:A.kitas,"error-messages":o.value.kita_id,"item-title":"name","item-value":"id",label:"Kita*"},null,8,["modelValue","items","error-messages"])]),_:1})]),_:1}),a(h,null,{default:r(()=>[a(t,{cols:"12",sm:"12"},{default:r(()=>[oe]),_:1}),a(t,{cols:"12",sm:"6"},{default:r(()=>[a(B,{class:"tw-p-6"},{default:r(()=>[se,a(s,{modelValue:_(e).children_2_born_per_year,"onUpdate:modelValue":l[2]||(l[2]=n=>_(e).children_2_born_per_year=n),"error-messages":o.value.children_2_born_per_year,label:R.value,type:"number",required:""},null,8,["modelValue","error-messages","label"]),a(h,null,{default:r(()=>[a(t,{cols:"12",sm:"7"},{default:r(()=>[a(s,{modelValue:_(e).children_2_with_german_lang,"onUpdate:modelValue":l[3]||(l[3]=n=>_(e).children_2_with_german_lang=n),"error-messages":o.value.children_2_with_german_lang,label:"Kinder mit deutscher Herkunftssprache*",type:"number",required:""},null,8,["modelValue","error-messages"])]),_:1}),a(t,{cols:"12",sm:"5"},{default:r(()=>[a(h,null,{default:r(()=>[c("2_german")?(m(),E(D,{key:0})):f("",!0),a(t,{cols:"12",sm:"10"},{default:r(()=>[a(s,{modelValue:_(e).evaluations_with_daz_2_total_per_year,"onUpdate:modelValue":l[4]||(l[4]=n=>_(e).evaluations_with_daz_2_total_per_year=n),"error-messages":o.value.evaluations_with_daz_2_total_per_year,label:"Bisher eingereichte Einschätzungen",type:"number",disabled:"",required:""},null,8,["modelValue","error-messages"])]),_:1})]),_:1})]),_:1})]),_:1}),a(h,null,{default:r(()=>[a(t,{cols:"12",sm:"7"},{default:r(()=>[a(s,{modelValue:_(e).children_2_with_foreign_lang,"onUpdate:modelValue":l[5]||(l[5]=n=>_(e).children_2_with_foreign_lang=n),"error-messages":o.value.children_2_with_foreign_lang,label:"Kinder mit nicht deutscher Herkunftssprache*",type:"number",required:""},null,8,["modelValue","error-messages"])]),_:1}),a(t,{cols:"12",sm:"5"},{default:r(()=>[a(h,null,{default:r(()=>[c("2_foreign")?(m(),E(D,{key:0})):f("",!0),a(t,{cols:"12",sm:"10"},{default:r(()=>[a(s,{modelValue:_(e).evaluations_without_daz_2_total_per_year,"onUpdate:modelValue":l[6]||(l[6]=n=>_(e).evaluations_without_daz_2_total_per_year=n),"error-messages":o.value.evaluations_without_daz_2_total_per_year,label:"Bisher eingereichte Einschätzungen",type:"number",disabled:"",required:""},null,8,["modelValue","error-messages"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),a(t,{cols:"12",sm:"6"},{default:r(()=>[a(B,{class:"tw-p-6"},{default:r(()=>[de,a(s,{modelValue:_(e).children_4_born_per_year,"onUpdate:modelValue":l[7]||(l[7]=n=>_(e).children_4_born_per_year=n),"error-messages":o.value.children_4_born_per_year,label:H.value,type:"number",required:""},null,8,["modelValue","error-messages","label"]),a(h,null,{default:r(()=>[a(t,{cols:"12",sm:"7"},{default:r(()=>[a(s,{modelValue:_(e).children_4_with_german_lang,"onUpdate:modelValue":l[8]||(l[8]=n=>_(e).children_4_with_german_lang=n),"error-messages":o.value.children_4_with_german_lang,label:"Kinder mit deutscher Herkunftssprache*",type:"number",required:""},null,8,["modelValue","error-messages"])]),_:1}),a(t,{cols:"12",sm:"5"},{default:r(()=>[a(h,null,{default:r(()=>[c("4_german")?(m(),E(D,{key:0})):f("",!0),a(t,{cols:"12",sm:"10"},{default:r(()=>[a(s,{modelValue:_(e).evaluations_with_daz_4_total_per_year,"onUpdate:modelValue":l[9]||(l[9]=n=>_(e).evaluations_with_daz_4_total_per_year=n),"error-messages":o.value.evaluations_with_daz_4_total_per_year,label:"Bisher eingereichte Einschätzungen",type:"number",disabled:"",required:""},null,8,["modelValue","error-messages"])]),_:1})]),_:1})]),_:1})]),_:1}),a(h,null,{default:r(()=>[a(t,{cols:"12",sm:"7"},{default:r(()=>[a(s,{modelValue:_(e).children_4_with_foreign_lang,"onUpdate:modelValue":l[10]||(l[10]=n=>_(e).children_4_with_foreign_lang=n),"error-messages":o.value.children_4_with_foreign_lang,label:"Kinder mit nicht deutscher Herkunftssprache*",type:"number",required:""},null,8,["modelValue","error-messages"])]),_:1}),a(t,{cols:"12",sm:"5"},{default:r(()=>[a(h,null,{default:r(()=>[c("4_foreign")?(m(),E(D,{key:0})):f("",!0),a(t,{cols:"12",sm:"10"},{default:r(()=>[a(s,{modelValue:_(e).evaluations_without_daz_4_total_per_year,"onUpdate:modelValue":l[11]||(l[11]=n=>_(e).evaluations_without_daz_4_total_per_year=n),"error-messages":o.value.evaluations_without_daz_4_total_per_year,label:"Bisher eingereichte Einschätzungen",type:"number",disabled:"",required:""},null,8,["modelValue","error-messages"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),a(h,null,{default:r(()=>[a(t,{cols:"12",sm:"12",align:"right"},{default:r(()=>[a(K,null,{default:r(({isHovering:n,props:z})=>[a(_(re),{href:i.route("yearly_evaluations.index")},{default:r(()=>[a(M,I({class:"mr-2",variant:"text"},z,{color:n?"accent":"primary"}),{default:r(()=>[x("Zurück")]),_:2},1040,["color"])]),_:2},1032,["href"])]),_:1}),a(K,null,{default:r(({isHovering:n,props:z})=>[a(P,I({onClick:Y},z,{color:n?"accent":"primary",disabled:!T.value}),{default:r(()=>[x(" Speichern ")]),_:2},1040,["color","disabled"])]),_:1})]),_:1})]),_:1})]),_:1}),a(G,{modelValue:V.value,"onUpdate:modelValue":l[13]||(l[13]=n=>V.value=n),width:"80vw"},{default:r(()=>[a(B,{height:"50vh"},{default:r(()=>[a(j,null,{default:r(()=>[a(O,null,{default:r(()=>[a(h,null,{default:r(()=>[a(t,{cols:"12"},{default:r(()=>[ue,p("div",he,[a(Z,I(w,{icon:"mdi-alert",color:"orange"}),null,16),p("ul",ce,[c("2_german")?(m(),k("li",me," Die Anzahl der Kinder im Alter bis 2,5 Jahre welche Deutsch als Fremdsprache haben Sie mit "+g(_(e).children_2_with_german_lang)+" angegeben, die Anzahl der über die BeoKiz-Ampel erfassten Kindern beträgt "+g(_(e).evaluations_with_daz_2_total_per_year),1)):f("",!0),c("2_foreign")?(m(),k("li",ge," Die Anzahl der Kinder im Alter bis 2,5 Jahre welche Deutsch als Muttersprache haben Sie mit "+g(_(e).children_2_with_foreign_lang)+" angegeben, die Anzahl der über die BeoKiz-Ampel erfassten Kindern beträgt "+g(_(e).evaluations_without_daz_2_total_per_year),1)):f("",!0),c("4_german")?(m(),k("li",pe," Die Anzahl der Kinder im Alter bis 4,5 Jahre welche Deutsch als Fremdsprache haben Sie mit "+g(_(e).children_4_with_german_lang)+" angegeben, die Anzahl der über die BeoKiz-Ampel erfassten Kindern beträgt "+g(_(e).evaluations_with_daz_2_total_per_year),1)):f("",!0),c("4_foreign")?(m(),k("li",ve," Die Anzahl der Kinder im Alter bis 4,5 Jahre welche Deutsch als Muttersprache haben Sie mit "+g(_(e).children_4_with_foreign_lang)+" angegeben, die Anzahl der über die BeoKiz-Ampel erfassten Kindern beträgt "+g(_(e).evaluations_without_daz_4_total_per_year),1)):f("",!0)])]),a($,{modelValue:S.value,"onUpdate:modelValue":l[12]||(l[12]=n=>S.value=n),label:"Ich habe verstanden, dass es Unstimmigkeiten bei dem Abgelich der gemelden Zahlen gibt, Statusmeldung dennoch absenden."},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),a(W,null,{default:r(()=>[a(L),a(K,null,{default:r(({isHovering:n,props:z})=>[a(M,{onClick:F,color:n?"accent":"primary"},{default:r(()=>[x("Abbrechen")]),_:2},1032,["color"])]),_:1}),a(K,null,{default:r(({isHovering:n,props:z})=>[a(P,I({disabled:!S.value,onClick:Y},z,{color:n?"accent":"primary"}),{default:r(()=>[x("Speichern")]),_:2},1040,["disabled","color"])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])])]),_:1},8,["errors"])],64)}}};export{Ve as default};
