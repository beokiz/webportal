import{d as xe}from"./index-7f365590.js";import{K as Pe,k as g,h as E,m as de,T as ce,r as m,n as Ie,f as A,a as e,u as s,w as t,F as me,o as y,Z as Ue,b as u,p as k,d as w,c as B,g as K,t as v,q as Je,i as Be,O as Fe}from"./app-a86e01ca.js";import{_ as Ce}from"./AuthenticatedLayout-853530bf.js";import{W as R}from"./WarningEvaluationTooltip-6ee16b02.js";import"./ApplicationLogo-db7c023a.js";const Te=u("h2",{class:"tw-font-semibold tw-text-xl tw-text-gray-800 tw-leading-tight"},"Jährliche Rückmeldung",-1),qe={class:"tw-flex tw-items-center tw-justify-end"},Ne=u("span",{class:"tw-text-h5"},"Jährliche Rückmeldung erstellen",-1),Re=u("h3",null,"Rückmeldung betrifft",-1),Ye=u("h3",null,"Angaben zur Rückmeldung",-1),Oe=u("h5",null,"Kinder bis 2,5 Jahre",-1),$e=u("h5",null,"Kinder bis 4,5 Jahre",-1),je=u("h4",null,"Wir haben eine Abweichung zwischen der Anzahl der von Ihnen gemeldeten Kinder und der Anzahl über die BeoKiz-Ampel erfassten Kindern festgestellt:",-1),Le={class:"tw-flex tw-items-center tw-mt-2"},He={style:{"list-style-type":"disc","margin-left":"25px"}},Me={key:0},Ze={key:1},Ge={key:2},We={key:3},Qe={class:"tw-table-block tw-max-w-full tw-mx-auto tw-py-6 tw-px-4 sm:tw-px-6 lg:tw-px-8"},Xe=["data-id","data-order"],et={align:"center"},tt=u("span",null,"Jährliche Rückmeldung bearbeiten",-1),at=u("span",null,"Jährliche Rückmeldung löschen",-1),lt={class:"tw-py-6"},rt={key:0,class:"tw-mb-4"},nt=u("h3",{class:"tw-mb-4"},"Die Tabelle ist leer. Bitte setzen Sie die Suchfilter zurück.",-1),ct={__name:"YearlyEvaluations",props:{items:Array,currentPage:Number,perPage:Number,lastPage:Number,total:Number,paging:Boolean,orderBy:String,sort:String,filters:Object,errors:Object,kitas:Array,surveyTimePeriods:Array},setup(W){var ne,oe,se,_e,ie;const r=W;xe.Inertia.on("success",n=>{let a=n.detail.page.props;n.detail.page.component==="YearlyEvaluations/YearlyEvaluations"&&a&&(F.value=a.currentPage,x.value=a.perPage,he.value=a.orderBy,ge.value=a.sort,Q.value=a.total,ve.value=a.lastPage,P.value=a.filters.search??null)}),Pe().props.auth.user;const F=g(r.currentPage),x=g(r.perPage),he=g(r.orderBy),ge=g(r.sort),Q=g(r.total),ve=g(r.lastPage),P=g(r.filters.search??null),pe=g(""),h=g(r.errors||{}),Y=g(!1),C=g(!1),S=g(!1),T=g(!1),X=g(null),q=g(!1),O=g(!1),fe=[{title:"Jahr",key:"year",width:"7%",sortable:!1},{title:"Kitas",key:"kita_name",width:"11%",sortable:!1},{title:"gemeldete Kinder  bis 2,5 Jahre",key:"children_2_born_per_year",width:"18%",sortable:!1},{title:"gemeldete Kinder  bis 4,5 Jahre",key:"children_4_born_per_year",width:"18%",sortable:!1},{title:"Evaluationen für Kinder  bis 2,5 Jahre",key:"evaluations_with_daz_2_total_per_year",width:"18%",sortable:!1},{title:"Evaluationen für Kinder  bis 4,5 Jahre",key:"evaluations_with_daz_4_total_per_year",width:"18%",sortable:!1},{title:"Aktion",key:"actions",width:"10%",sortable:!1,align:"center"}],ye=E(()=>r.items.map(n=>{const a={...n};for(const d in a)(a[d]===null||a[d]===void 0)&&(a[d]="-");return a})),ee=E(()=>P.value===null),be=E(()=>P.value!==null),we=E(()=>re("2.5")),ke=E(()=>re("4.5"));E(()=>{let n=r.kitas.find(a=>l.kita_id===parseInt(a.id));return n&&(l.evaluations_with_daz_2_total_per_year=n.evaluations_with_daz2_total_per_year_count,l.evaluations_with_daz_4_total_per_year=n.evaluations_with_daz4_total_per_year_count,l.evaluations_without_daz_2_total_per_year=n.evaluations_without_daz2_total_per_year_count,l.evaluations_without_daz_4_total_per_year=n.evaluations_without_daz4_total_per_year_count),n}),de(C,n=>{n||D()}),de(S,n=>{O.value=!0});const te=async({page:n,itemsPerPage:a,sortBy:d,clearFilters:i})=>{if(i&&(P.value=null),n===F.value&&i||ee||be){Y.value=!0;let c={data:{page:n,per_page:a}};d&&d.length>0&&(c.data.order_by=d[0].key,c.data.sort=d[0].order),c.data.search=P.value,await Fe.reload(c),F.value=n,x.value=a,Y.value=!1}},ze=n=>{X.value=n.year,I.id=n.id,T.value=!0},I=ce({id:null}),Ve=async()=>{I.processing=!0;let n={onSuccess:a=>{D()},onError:a=>{D(),h.value=a},onFinish:()=>{I.processing=!1}};I.delete(route("yearly_evaluations.destroy",{id:I.id}),n)},ae=()=>{S.value=!1},D=()=>{C.value=!1,S.value=!1,T.value=!1,q.value=!1,O.value=!1,l.reset(),l.clearErrors(),h.value={}},Ke=()=>{l.reset(),l.clearErrors()},l=ce({year:new Date().getFullYear().toString().padStart(4,"0"),kita_id:(r==null?void 0:r.kitas.length)>0?(ne=r==null?void 0:r.kitas[0])==null?void 0:ne.id:null,evaluations_with_daz_2_total_per_year:(r==null?void 0:r.kitas.length)>0?(oe=r==null?void 0:r.kitas[0])==null?void 0:oe.evaluations_with_daz2_total_per_year_count:0,evaluations_with_daz_4_total_per_year:(r==null?void 0:r.kitas.length)>0?(se=r==null?void 0:r.kitas[0])==null?void 0:se.evaluations_with_daz4_total_per_year_count:0,evaluations_without_daz_2_total_per_year:(r==null?void 0:r.kitas.length)>0?(_e=r==null?void 0:r.kitas[0])==null?void 0:_e.evaluations_without_daz2_total_per_year_count:0,evaluations_without_daz_4_total_per_year:(r==null?void 0:r.kitas.length)>0?(ie=r==null?void 0:r.kitas[0])==null?void 0:ie.evaluations_without_daz4_total_per_year_count:0,children_2_born_per_year:0,children_4_born_per_year:0,children_2_with_german_lang:0,children_4_with_german_lang:0,children_2_with_foreign_lang:0,children_4_with_foreign_lang:0}),Ae=async()=>{l.processing=!0,l.post(route("yearly_evaluations.store"),{preserveState:!0,onSuccess:n=>{D()},onError:n=>{h.value=n},onFinish:()=>{ae(),l.processing=!1}})},p=n=>{if(n==="2_german")return parseInt(l.evaluations_with_daz_2_total_per_year)!==parseInt(l.children_2_with_german_lang);if(n==="2_foreign")return parseInt(l.evaluations_without_daz_2_total_per_year)!==parseInt(l.children_2_with_foreign_lang);if(n==="4_german")return parseInt(l.evaluations_with_daz_4_total_per_year)!==parseInt(l.children_4_with_german_lang);if(n==="4_foreign")return parseInt(l.evaluations_without_daz_4_total_per_year)!==parseInt(l.children_4_with_foreign_lang)},le=async()=>{(p("2_german")||p("2_foreign")||p("4_german")||p("4_foreign"))&&!O.value?S.value=!0:await Ae()},re=n=>{if(n==="2.5"||n==="4.5"){let a=r.surveyTimePeriods.find(d=>d.year===parseInt(l.year)&&d.age==="4.5");if(a){let d=new Date(a.survey_start_date),i=new Date(a.survey_end_date),c=d.getFullYear()+"-"+("0"+(d.getMonth()+1)).slice(-2)+"-"+("0"+d.getDate()).slice(-2),$=i.getFullYear()+"-"+("0"+(i.getMonth()+1)).slice(-2)+"-"+("0"+i.getDate()).slice(-2);return`Gesamtzahl der im Zeitraum ${c} - ${$} geborenen Kinder`}}return"Gesamtzahl der Kinder"};return(n,a)=>{const d=m("v-card-title"),i=m("v-col"),c=m("v-text-field"),$=m("v-select"),f=m("v-row"),U=m("v-card"),j=m("v-container"),L=m("v-card-text"),N=m("v-btn-primary"),V=m("v-hover"),H=m("v-spacer"),J=m("v-btn"),M=m("v-card-actions"),Z=m("v-dialog"),G=m("v-icon"),Se=m("v-checkbox"),ue=m("v-tooltip"),De=m("v-data-table-server"),Ee=Ie("sortable-data-table");return y(),A(me,null,[e(s(Ue),{title:"Jährliche Rückmeldung"}),e(Ce,{errors:h.value},{header:t(()=>[Te,u("div",qe,[e(V,null,{default:t(({isHovering:_,props:b})=>[e(J,k(b,{color:_?"accent":"primary",dark:""}),{default:t(()=>[w(" ANLEGEN "),e(Z,{modelValue:C.value,"onUpdate:modelValue":a[12]||(a[12]=o=>C.value=o),activator:"parent",width:"80vw"},{default:t(()=>[e(U,{height:"80vh"},{default:t(()=>[e(d,null,{default:t(()=>[Ne]),_:1}),e(L,null,{default:t(()=>[e(j,null,{default:t(()=>[e(f,null,{default:t(()=>[e(i,{cols:"12",sm:"12"},{default:t(()=>[Re]),_:1}),e(i,{cols:"12",sm:"4"},{default:t(()=>[e(c,{modelValue:s(l).year,"onUpdate:modelValue":a[0]||(a[0]=o=>s(l).year=o),"error-messages":h.value.year,label:"Jahr der Rückmeldung*",required:""},null,8,["modelValue","error-messages"])]),_:1}),e(i,{cols:"12",sm:"4"},{default:t(()=>[e($,{modelValue:s(l).kita_id,"onUpdate:modelValue":a[1]||(a[1]=o=>s(l).kita_id=o),items:W.kitas,"error-messages":h.value.kita_id,"item-title":"name","item-value":"id",label:"Kita*"},null,8,["modelValue","items","error-messages"])]),_:1})]),_:1}),e(f,null,{default:t(()=>[e(i,{cols:"12",sm:"12"},{default:t(()=>[Ye]),_:1}),e(i,{cols:"12",sm:"6"},{default:t(()=>[e(U,{class:"tw-p-6"},{default:t(()=>[Oe,e(c,{modelValue:s(l).children_2_born_per_year,"onUpdate:modelValue":a[2]||(a[2]=o=>s(l).children_2_born_per_year=o),"error-messages":h.value.children_2_born_per_year,label:we.value,type:"number",required:""},null,8,["modelValue","error-messages","label"]),e(f,null,{default:t(()=>[e(i,{cols:"12",sm:"7"},{default:t(()=>[e(c,{modelValue:s(l).children_2_with_german_lang,"onUpdate:modelValue":a[3]||(a[3]=o=>s(l).children_2_with_german_lang=o),"error-messages":h.value.children_2_with_german_lang,label:"Kinder mit deutscher Herkunftssprache*",type:"number",required:""},null,8,["modelValue","error-messages"])]),_:1}),e(i,{cols:"12",sm:"5"},{default:t(()=>[e(f,null,{default:t(()=>[p("2_german")?(y(),B(R,{key:0})):K("",!0),e(i,{cols:"12",sm:"10"},{default:t(()=>[e(c,{modelValue:s(l).evaluations_with_daz_2_total_per_year,"onUpdate:modelValue":a[4]||(a[4]=o=>s(l).evaluations_with_daz_2_total_per_year=o),"error-messages":h.value.evaluations_with_daz_2_total_per_year,label:"Bisher eingereichte Einschätzungen",type:"number",disabled:"",required:""},null,8,["modelValue","error-messages"])]),_:1})]),_:1})]),_:1})]),_:1}),e(f,null,{default:t(()=>[e(i,{cols:"12",sm:"7"},{default:t(()=>[e(c,{modelValue:s(l).children_2_with_foreign_lang,"onUpdate:modelValue":a[5]||(a[5]=o=>s(l).children_2_with_foreign_lang=o),"error-messages":h.value.children_2_with_foreign_lang,label:"Kinder mit nicht deutscher Herkunftssprache*",type:"number",required:""},null,8,["modelValue","error-messages"])]),_:1}),e(i,{cols:"12",sm:"5"},{default:t(()=>[e(f,null,{default:t(()=>[p("2_foreign")?(y(),B(R,{key:0})):K("",!0),e(i,{cols:"12",sm:"10"},{default:t(()=>[e(c,{modelValue:s(l).evaluations_without_daz_2_total_per_year,"onUpdate:modelValue":a[6]||(a[6]=o=>s(l).evaluations_without_daz_2_total_per_year=o),"error-messages":h.value.evaluations_without_daz_2_total_per_year,label:"Bisher eingereichte Einschätzungen",type:"number",disabled:"",required:""},null,8,["modelValue","error-messages"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),e(i,{cols:"12",sm:"6"},{default:t(()=>[e(U,{class:"tw-p-6"},{default:t(()=>[$e,e(c,{modelValue:s(l).children_4_born_per_year,"onUpdate:modelValue":a[7]||(a[7]=o=>s(l).children_4_born_per_year=o),"error-messages":h.value.children_4_born_per_year,label:ke.value,type:"number",required:""},null,8,["modelValue","error-messages","label"]),e(f,null,{default:t(()=>[e(i,{cols:"12",sm:"7"},{default:t(()=>[e(c,{modelValue:s(l).children_4_with_german_lang,"onUpdate:modelValue":a[8]||(a[8]=o=>s(l).children_4_with_german_lang=o),"error-messages":h.value.children_4_with_german_lang,label:"Kinder mit deutscher Herkunftssprache*",type:"number",required:""},null,8,["modelValue","error-messages"])]),_:1}),e(i,{cols:"12",sm:"5"},{default:t(()=>[e(f,null,{default:t(()=>[p("4_german")?(y(),B(R,{key:0})):K("",!0),e(i,{cols:"12",sm:"10"},{default:t(()=>[e(c,{modelValue:s(l).evaluations_with_daz_4_total_per_year,"onUpdate:modelValue":a[9]||(a[9]=o=>s(l).evaluations_with_daz_4_total_per_year=o),"error-messages":h.value.evaluations_with_daz_4_total_per_year,label:"Bisher eingereichte Einschätzungen",type:"number",disabled:"",required:""},null,8,["modelValue","error-messages"])]),_:1})]),_:1})]),_:1})]),_:1}),e(f,null,{default:t(()=>[e(i,{cols:"12",sm:"7"},{default:t(()=>[e(c,{modelValue:s(l).children_4_with_foreign_lang,"onUpdate:modelValue":a[10]||(a[10]=o=>s(l).children_4_with_foreign_lang=o),"error-messages":h.value.children_4_with_foreign_lang,label:"Kinder mit nicht deutscher Herkunftssprache*",type:"number",required:""},null,8,["modelValue","error-messages"])]),_:1}),e(i,{cols:"12",sm:"5"},{default:t(()=>[e(f,null,{default:t(()=>[p("4_foreign")?(y(),B(R,{key:0})):K("",!0),e(i,{cols:"12",sm:"10"},{default:t(()=>[e(c,{modelValue:s(l).evaluations_without_daz_4_total_per_year,"onUpdate:modelValue":a[11]||(a[11]=o=>s(l).evaluations_without_daz_4_total_per_year=o),"error-messages":h.value.evaluations_without_daz_4_total_per_year,label:"Bisher eingereichte Einschätzungen",type:"number",disabled:"",required:""},null,8,["modelValue","error-messages"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),e(M,null,{default:t(()=>[e(V,null,{default:t(({isHovering:o,props:z})=>[e(N,k({onClick:Ke},z,{color:o?"accent":"primary"}),{default:t(()=>[w("Zurücksetzen")]),_:2},1040,["color"])]),_:2},1024),e(H),e(V,null,{default:t(({isHovering:o,props:z})=>[e(J,k({onClick:D},z,{color:o?"accent":"primary"}),{default:t(()=>[w("Stornieren")]),_:2},1040,["color"])]),_:2},1024),e(V,null,{default:t(({isHovering:o,props:z})=>[e(N,k({onClick:le},z,{color:o?"accent":"primary"}),{default:t(()=>[w("Speichern")]),_:2},1040,["color"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1032,["modelValue"])]),_:2},1040,["color"])]),_:1})]),e(Z,{modelValue:T.value,"onUpdate:modelValue":a[13]||(a[13]=_=>T.value=_),width:"20vw"},{default:t(()=>[e(U,{height:"30vh"},{default:t(()=>[e(L,null,{default:t(()=>[e(j,null,{default:t(()=>[e(f,null,{default:t(()=>[e(i,{cols:"12"},{default:t(()=>[u("p",null,"Sind Sie sicher, dass Sie die Jährliche Rückmeldung "+v(X.value)+" löschen möchten?",1)]),_:1})]),_:1})]),_:1})]),_:1}),e(M,null,{default:t(()=>[e(H),e(V,null,{default:t(({isHovering:_,props:b})=>[e(J,k({onClick:D},b,{color:_?"accent":"primary"}),{default:t(()=>[w("Abbrechen")]),_:2},1040,["color"])]),_:1}),e(V,null,{default:t(({isHovering:_,props:b})=>[e(N,k({onClick:Ve},b,{color:_?"accent":"primary"}),{default:t(()=>[w("Löschen")]),_:2},1040,["color"])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(Z,{modelValue:S.value,"onUpdate:modelValue":a[15]||(a[15]=_=>S.value=_),width:"80vw"},{default:t(()=>[e(U,{height:"50vh"},{default:t(()=>[e(L,null,{default:t(()=>[e(j,null,{default:t(()=>[e(f,null,{default:t(()=>[e(i,{cols:"12"},{default:t(()=>[je,u("div",Le,[e(G,k(r,{icon:"mdi-alert",color:"orange"}),null,16),u("ul",He,[p("2_german")?(y(),A("li",Me," Die Anzahl der Kinder im Alter bis 2,5 Jahre welche Deutsch als Fremdsprache haben Sie mit "+v(s(l).children_2_with_german_lang)+" angegeben, die Anzahl der über die BeoKiz-Ampel erfassten Kindern beträgt "+v(s(l).evaluations_with_daz_2_total_per_year),1)):K("",!0),p("2_foreign")?(y(),A("li",Ze," Die Anzahl der Kinder im Alter bis 2,5 Jahre welche Deutsch als Muttersprache haben Sie mit "+v(s(l).children_2_with_foreign_lang)+" angegeben, die Anzahl der über die BeoKiz-Ampel erfassten Kindern beträgt "+v(s(l).evaluations_without_daz_2_total_per_year),1)):K("",!0),p("4_german")?(y(),A("li",Ge," Die Anzahl der Kinder im Alter bis 4,5 Jahre welche Deutsch als Fremdsprache haben Sie mit "+v(s(l).children_4_with_german_lang)+" angegeben, die Anzahl der über die BeoKiz-Ampel erfassten Kindern beträgt "+v(s(l).evaluations_with_daz_2_total_per_year),1)):K("",!0),p("4_foreign")?(y(),A("li",We," Die Anzahl der Kinder im Alter bis 4,5 Jahre welche Deutsch als Muttersprache haben Sie mit "+v(s(l).children_4_with_foreign_lang)+" angegeben, die Anzahl der über die BeoKiz-Ampel erfassten Kindern beträgt "+v(s(l).evaluations_without_daz_4_total_per_year),1)):K("",!0)])]),e(Se,{modelValue:q.value,"onUpdate:modelValue":a[14]||(a[14]=_=>q.value=_),label:"Ich habe verstanden, dass es Unstimmigkeiten bei dem Abgelich der gemelden Zahlen gibt, Statusmeldung dennoch absenden."},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),e(M,null,{default:t(()=>[e(H),e(V,null,{default:t(({isHovering:_,props:b})=>[e(J,{onClick:ae,color:_?"accent":"primary"},{default:t(()=>[w("Abbrechen")]),_:2},1032,["color"])]),_:1}),e(V,null,{default:t(({isHovering:_,props:b})=>[e(N,k({disabled:!q.value,onClick:le},b,{color:_?"accent":"primary"}),{default:t(()=>[w("Speichern")]),_:2},1040,["disabled","color"])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),default:t(()=>[u("div",Qe,[Je((y(),B(De,{"items-per-page":x.value,"onUpdate:itemsPerPage":a[17]||(a[17]=_=>x.value=_),"items-per-page-options":[{value:10,title:"10"},{value:25,title:"25"},{value:50,title:"50"},{value:100,title:"100"},{value:-1,title:"$vuetify.dataFooter.itemsPerPageAll"}],"items-per-page-text":"Objekte pro Seite:",headers:fe,page:F.value,"items-length":Q.value,items:ye.value,search:pe.value,loading:Y.value,class:"data-table-container elevation-1","item-value":"name","onUpdate:options":te},{item:t(({item:_})=>{var b,o;return[u("tr",{"data-id":_.selectable.id,"data-order":_.selectable.order},[u("td",null,v(_.selectable.year),1),u("td",null,v((o=(b=_.selectable)==null?void 0:b.kita)==null?void 0:o.formatted_name),1),u("td",null,v(_.selectable.children_2_born_per_year),1),u("td",null,v(_.selectable.children_4_born_per_year),1),u("td",null,v(_.selectable.evaluations_with_daz_2_total_per_year+_.selectable.evaluations_without_daz_2_total_per_year),1),u("td",null,v(_.selectable.evaluations_with_daz_4_total_per_year+_.selectable.evaluations_without_daz_4_total_per_year),1),u("td",et,[e(ue,{location:"top"},{activator:t(({props:z})=>[e(s(Be),{href:n.route("yearly_evaluations.show",{id:_.selectable.id})},{default:t(()=>[e(G,k(z,{size:"small",class:"tw-me-2"}),{default:t(()=>[w("mdi-pencil")]),_:2},1040)]),_:2},1032,["href"])]),default:t(()=>[tt]),_:2},1024),e(ue,{location:"top"},{activator:t(({props:z})=>[e(G,k(z,{size:"small",class:"tw-me-2",onClick:ot=>ze(_.raw)}),{default:t(()=>[w("mdi-delete")]),_:2},1040,["onClick"])]),default:t(()=>[at]),_:2},1024)])],8,Xe)]}),"no-data":t(()=>[u("div",lt,[ee.value?(y(),A("h3",rt,"Die Tabelle ist leer.")):(y(),A(me,{key:1},[nt,e(J,{color:"primary",onClick:a[16]||(a[16]=_=>te({page:1,itemsPerPage:x.value,clearFilters:!0}))},{default:t(()=>[w("Reset")]),_:1})],64))])]),_:1},8,["items-per-page","items-per-page-options","page","items-length","items","search","loading"])),[[Ee]])])]),_:1},8,["errors"])],64)}}};export{ct as default};
