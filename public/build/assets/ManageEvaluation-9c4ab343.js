import{d as le}from"./index-3d8425cc.js";import{K as ne,k as w,h as se,s as oe,l as re,T as N,m as ie,r as i,f as $,a as e,u as o,w as a,F as ue,o as k,Z as de,b as p,c as C,g as P,p as V,d as _,t as ce,v as me}from"./app-cff3aad5.js";import{p as B,a as ve}from"./common-1f9d3448.js";import{_ as pe}from"./AuthenticatedLayout-d9864ee0.js";import{_ as j}from"./EvaluationDomainsList-566afbaa.js";import{v as _e}from"./v4-4a60fe23.js";import"./ApplicationLogo-6c4ba6ee.js";const fe=p("h2",{class:"tw-font-semibold tw-text-xl tw-text-gray-800 tw-leading-tight"},"Auswertung erstellen",-1),ge={class:"tw-table-block tw-max-w-full tw-mx-auto tw-py-6 tw-px-4 sm:tw-px-6 lg:tw-px-8"},he=p("h3",null,"Eigenschaften",-1),we={key:0,class:"tw-flex justify-center items-center tw-bg-white"},be={class:"tw-text-right"},ke=["href"],Ve={class:"tw-text-center"},xe=p("h1",{class:"tw-uppercase text-primary tw-font-black tw-text-xl tw-mb-8"}," Screening wurde eingereicht ",-1),ye=p("p",{class:"tw-mb-8"}," Folgendes Screening wurde eingereicht und kann nur bis 15 Minuten nach Einreichung bearbeitet werden. Danach verschwindet es aus Ihrer Übersicht. Sollten Sie es zurückziehen oder bearbeiten wollen, klicke Sie auf 'Abgabe zurückziehen. Nachfolgend erhalten Sie eine Übersicht des eingereichten Screenings, welches Sie über den Download-Button als PDF herunterladen können. ",-1),ze=p("span",{class:"tw-font-black"},"Bezeichner des Screenings",-1),Ie={__name:"ManageEvaluation",props:{evaluation:Object,kitas:Array,domains:Array,errors:Object},setup(x){const d=x;le.Inertia.on("success",r=>{r.detail.page.props,r.detail.page.component});const K=ne().props.auth.user??{},I=w(null),u=w(d.errors||{}),b=w(!1),D=w([]),y=w(!1),f=w(null),z=w([{name:"1 - 12 Monate",id:1},{name:"12 - 24 Monate",id:2},{name:"24 - 36 Monate",id:3}]),m=se(()=>!!d.evaluation);oe(()=>{m.value||O()}),re(()=>{m.value||A()});const A=()=>{I.value=_e(),t.uuid=I.value},O=()=>{t.ratings=B(d.domains)},U=()=>{u.value={},y.value=!1},Z=()=>{t.reset(),t.clearErrors(),u.value={},t.ratings=B(d.domains),m.value||A()},t=N({uuid:m.value?d.evaluation.uuid:null,user_id:m.value?d.evaluation.user_id:K.id,kita_id:m.value?d.evaluation.kita_id:null,period_id:m.value?d.evaluation.period_id:null,age:m.value?d.evaluation.age:null,is_daz:m.value?d.evaluation.is_daz:!1,ratings:m.value?d.evaluation.data:[]});ie(()=>t.age,r=>{if(t.ratings=B(d.domains),t.age===4.5)z.value.push({name:"Länger als 36 Monate",id:4});else{const l=z.value.findIndex(s=>s.id===4);l!==-1&&z.value.splice(l,1)}t.age!==4.5&&(t.period_id=null)});const T=r=>{t.ratings=r},q=r=>{D.value=me(r)?r.value:r},H=async()=>{t.processing=!0,b.value=!0;let r=[];D.value.map(s=>(s.subdomains.map(c=>(c.milestones.map(g=>(r.push(parseInt(g.id)),g)),c)),s)),t.ratings=t.ratings.map(s=>(s.milestones.map(c=>(r.includes(parseInt(c.id))||(c.value=0),c)),s));let l={onSuccess:s=>{t.clearErrors(),u.value={},y.value=!0,f.value=s.props.data},onError:s=>{u.value=s},onFinish:()=>{t.processing=!1,b.value=!1}};m.value?t.put(route("evaluations.update",{evaluation:d.evaluation.id}),l):t.post(route("evaluations.store"),l)},L=async()=>{t.processing=!0,b.value=!0,t.post(route("evaluations.save"),{preserveState:!1,onSuccess:r=>{t.clearErrors(),u.value={}},onError:r=>{u.value=r},onFinish:()=>{t.processing=!1,b.value=!1}})},E=N({}),G=async r=>{E.processing=!0,E.post(route("evaluations.unfinished",{id:r}),{preserveState:!1,onSuccess:l=>{E.clearErrors(),u.value={},U()},onError:l=>{u.value=l},onFinish:()=>{E.processing=!1,b.value=!1}})};return(r,l)=>{const s=i("v-col"),c=i("v-row"),g=i("v-container"),J=i("v-text-field"),F=i("v-select"),M=i("v-checkbox"),Q=i("v-progress-circular"),S=i("v-btn"),h=i("v-hover"),R=i("v-btn-primary"),W=i("v-icon"),X=i("v-card-text"),Y=i("v-spacer"),ee=i("v-card-actions"),ae=i("v-card"),te=i("v-dialog");return k(),$(ue,null,[e(o(de),{title:"Auswertung erstellen"}),e(pe,{errors:u.value},{header:a(()=>[fe]),default:a(()=>[p("div",ge,[e(g,null,{default:a(()=>[e(c,null,{default:a(()=>[e(s,{cols:"12"},{default:a(()=>[he]),_:1})]),_:1})]),_:1}),e(g,null,{default:a(()=>[e(c,null,{default:a(()=>[e(s,{cols:"12",sm:"3"},{default:a(()=>[e(J,{modelValue:o(t).uuid,"onUpdate:modelValue":l[0]||(l[0]=n=>o(t).uuid=n),"error-messages":u.value.uuid,readonly:"",label:"Bezeichner der Einschatzung",required:""},null,8,["modelValue","error-messages"])]),_:1}),e(s,{cols:"12",sm:"2"},{default:a(()=>[e(F,{modelValue:o(t).age,"onUpdate:modelValue":l[1]||(l[1]=n=>o(t).age=n),items:o(ve),"error-messages":u.value.age,"item-title":"age_name","item-value":"age_number",label:"Altersgruppe"},null,8,["modelValue","items","error-messages"])]),_:1}),e(s,{cols:"12",sm:"2"},{default:a(()=>[e(F,{modelValue:o(t).kita_id,"onUpdate:modelValue":l[2]||(l[2]=n=>o(t).kita_id=n),items:x.kitas,"error-messages":u.value.kita_id,"item-title":"name","item-value":"id",label:"Kita"},null,8,["modelValue","items","error-messages"])]),_:1}),e(s,{cols:"12",sm:"2"},{default:a(()=>[e(F,{modelValue:o(t).period_id,"onUpdate:modelValue":l[3]||(l[3]=n=>o(t).period_id=n),items:z.value,"error-messages":u.value.period_id,"item-title":"name","item-value":"id",label:"Zeitraum in der Kita"},null,8,["modelValue","items","error-messages"])]),_:1}),e(s,{cols:"12",sm:"3"},{default:a(()=>[e(M,{modelValue:o(t).is_daz,"onUpdate:modelValue":l[4]||(l[4]=n=>o(t).is_daz=n),label:"Deutsch ist nicht Muttersprache"},null,8,["modelValue"]),e(M,{modelValue:o(t).is_daz,"onUpdate:modelValue":l[5]||(l[5]=n=>o(t).is_daz=n),label:"Integrationsstatus"},null,8,["modelValue"]),e(M,{modelValue:o(t).is_daz,"onUpdate:modelValue":l[6]||(l[6]=n=>o(t).is_daz=n),label:"in logopädische Behandlung"},null,8,["modelValue"])]),_:1})]),_:1}),e(c,{class:"manage-evaluation-domains"},{default:a(()=>[o(t).age?(k(),C(j,{key:0,ratings:o(t).ratings,age:o(t).age,domains:x.domains,errors:u.value,onUpdateRatingData:T,onUpdateDomainsData:q},null,8,["ratings","age","domains","errors"])):P("",!0)]),_:1})]),_:1}),e(g,null,{default:a(()=>[b.value?(k(),$("div",we,[e(Q,{indeterminate:"",size:40})])):(k(),C(c,{key:1},{default:a(()=>[e(s,{cols:"12",sm:"6"},{default:a(()=>[e(h,null,{default:a(({isHovering:n,props:v})=>[e(S,V({onClick:Z},v,{color:n?"primary":"accent"}),{default:a(()=>[_(" Zurücksetzen ")]),_:2},1040,["color"])]),_:1})]),_:1}),e(s,{cols:"12",sm:"6",align:"right"},{default:a(()=>[e(h,null,{default:a(({isHovering:n,props:v})=>[e(S,V({class:"mr-2",onClick:L,variant:"text"},v,{color:n?"accent":"primary"}),{default:a(()=>[_(" Speichern ")]),_:2},1040,["color"])]),_:1}),o(t).age&&D.value.length>0?(k(),C(h,{key:0},{default:a(({isHovering:n,props:v})=>[e(R,V({onClick:H},v,{color:n?"accent":"primary"}),{default:a(()=>[_(" Prüfen und Einreichen ")]),_:2},1040,["color"])]),_:1})):P("",!0)]),_:1})]),_:1}))]),_:1})]),e(te,{modelValue:y.value,"onUpdate:modelValue":l[9]||(l[9]=n=>y.value=n),width:"95vw"},{default:a(()=>[e(ae,{height:"95vh"},{default:a(()=>[e(X,null,{default:a(()=>[e(g,null,{default:a(()=>[e(c,{class:"result-evaluation-domains"},{default:a(()=>[e(s,{cols:"12"},{default:a(()=>[e(h,null,{default:a(({isHovering:n,props:v})=>[p("div",be,[p("a",{href:r.route("evaluations.pdf",{id:f.value.item.id}),onClick:U,title:"Fenster schließen"},[e(W,V(v,{size:"small",class:"tw-me-2",onClick:l[7]||(l[7]=()=>{})}),{default:a(()=>[_("mdi-close")]),_:2},1040)],8,ke)])]),_:1})]),_:1})]),_:1}),e(c,{class:"result-evaluation-domains"},{default:a(()=>[e(s,{cols:"8",offset:"2"},{default:a(()=>[p("div",Ve,[xe,ye,e(h,null,{default:a(({isHovering:n,props:v})=>[e(S,{href:r.route("evaluations.pdf",{id:f.value.item.id}),class:"tw-px-2 tw-py-3 tw-mb-4 tw-mr-4 tw-normal-case",color:n?"primary":"accent"},{default:a(()=>[_(" Screening als PDF downloaden ")]),_:2},1032,["href","color"])]),_:1}),e(h,null,{default:a(({isHovering:n,props:v})=>[e(S,{onClick:l[8]||(l[8]=Ee=>G(f.value.item.id)),class:"tw-px-2 tw-py-3 tw-mb-4 tw-normal-case",color:n?"accent":"primary"},{default:a(()=>[_(" Abgabe zurückziehen ")]),_:2},1032,["color"])]),_:1})])]),_:1}),e(s,{cols:"12"},{default:a(()=>[p("p",null,[ze,_(": "+ce(`${f.value.item.kita.formatted_name}_${f.value.item.uuid}`),1)])]),_:1}),e(s,{cols:"12"},{default:a(()=>[e(j,{ratings:f.value.item.data,age:o(t).age,domains:x.domains,disabled:!0},null,8,["ratings","age","domains"])]),_:1})]),_:1})]),_:1})]),_:1}),e(ee,null,{default:a(()=>[e(Y),e(h,null,{default:a(({isHovering:n,props:v})=>[e(R,V({onClick:U},v,{color:n?"accent":"primary"}),{default:a(()=>[_("Abbrechen")]),_:2},1040,["color"])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["errors"])],64)}}};export{Ie as default};
