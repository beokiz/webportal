import{K as Je,k as m,h as ae,m as N,A as ke,T as Ee,r as c,n as Oe,f as te,a as e,u as d,w as l,F as Se,o as T,Z as Me,b as n,c as R,p as g,d as b,g as oe,t as A,q as Ye,i as Ze,O as Re}from"./app-a11764a8.js";import{d as Ge}from"./index-a01c9824.js";import{_ as He}from"./AuthenticatedLayout-0da9a8dc.js";import"./ApplicationLogo-ee46da18.js";const Le=n("h2",{class:"tw-font-semibold tw-text-xl tw-text-gray-800 tw-leading-tight"},"Einrichtungen",-1),Qe={class:"tw-flex tw-items-center tw-justify-end"},We=n("span",{class:"tw-text-h5"},"Verwalte Einrichtung",-1),Xe=n("h4",null,"Adresse",-1),el=n("h4",null,"Eigenschaften",-1),ll={class:"tw-table-block tw-max-w-full tw-mx-auto tw-py-6 tw-px-4 sm:tw-px-6 lg:tw-px-8"},al={class:"tw-bg-white tw-flex tw-justify-between tw-px-6 tw-py-6"},tl={class:"tw-w-full"},ol=n("span",null,"Schreibe E-Mail an Auswahl",-1),sl=["data-id","data-order"],rl={class:"text-right"},ul=["href"],nl=n("span",null,"Schreibe E-Mail",-1),il=n("span",null,"Einrichtung bearbeiten",-1),dl=n("span",null,"Einrichtung löschen",-1),ml={class:"tw-py-6"},cl={key:0,class:"tw-mb-4"},pl=n("h3",{class:"tw-mb-4"},"Die Tabelle ist leer. Bitte setzen Sie die Suchfilter zurück.",-1),vl=n("span",{class:"tw-text-h5"},"Schreibe E-Mail an Auswahl",-1),hl={__name:"Kitas",props:{items:Array,currentPage:Number,perPage:Number,lastPage:Number,total:Number,paging:Boolean,orderBy:String,sort:String,filters:Object,errors:Object,types:Array,zipCodes:Array,operators:Array,usersEmails:Array},setup(z){var de,me,ce,pe,ve;const _=z;Ge.Inertia.on("success",r=>{let a=r.detail.page.props;r.detail.page.component==="Kitas/Kitas"&&a&&(I.value=a.currentPage,$.value=a.perPage,Ue.value=a.orderBy,xe.value=a.sort,se.value=a.total,Pe.value=a.lastPage)}),Je().props.auth.user;const I=m(_.currentPage),$=m(_.perPage),Ue=m(_.orderBy),xe=m(_.sort),se=m(_.total),Pe=m(_.lastPage),w=m(((de=_.filters)==null?void 0:de.search)??null),k=m(((me=_.filters)==null?void 0:me.has_yearly_evaluations)??null),F=m(((ce=_.filters)==null?void 0:ce.approved)??null),E=m(null),S=m(((pe=_.filters)==null?void 0:pe.type)??null),U=m(((ve=_.filters)==null?void 0:ve.zip_code)??null),re=m(""),f=m(_.errors||{}),B=m([]),h=m(!1),J=m(!1),O=m(!1),M=m(!1),ue=m(null),ze=[{title:"Ja",value:"true"},{title:"Nein",value:"false"}],Fe=[{title:"Ja",value:"true"},{title:"Nein",value:"false"}],Ce=[{title:"Name",key:"name",width:"15%",sortable:!0},{title:`Jährliche Rückmeldung ${new Date().getFullYear()} abgeschlossen`,key:"has_yearly_evaluations",width:"35%",sortable:!0},{title:"Zugelassen",key:"approved",width:"10%",sortable:!0},{title:"Träger",key:"operator_id",width:"10%",sortable:!0},{title:"Typ",key:"type",width:"10%",sortable:!0},{title:"Postleitzahl",key:"zip_code",width:"10%",sortable:!0},{title:"Aktion",key:"actions",width:"10%",sortable:!1,align:"center"}],Ne=ae(()=>_.items.map(r=>{const a={...r};for(const y in a)(a[y]===null||a[y]===void 0)&&(a[y]="-");return a})),ne=ae(()=>w.value===null&&k.value===null&&F.value===null&&E.value===null&&S.value===null&&U.value===null),Te=ae(()=>w.value!==null||k.value!==null||F.value!==null||E.value!==null||S.value!==null||U.value!==null);N(J,r=>{r||C()}),N(w,ke.debounce(r=>{D()},500)),N(k,r=>{D()}),N(F,r=>{D()}),N(E,r=>{D()}),N(S,r=>{D()}),N(U,ke.debounce(r=>{D()},500));const Ae=()=>{O.value=!0,B.value=_.usersEmails},D=()=>{h.value=!0,re.value=String(Date.now())},ie=async({page:r,itemsPerPage:a,sortBy:y,clearFilters:i})=>{if(i&&(w.value=null,k.value=null,E.value=null,S.value=null,U.value=null),r===I.value&&i||ne||Te){h.value=!0;let u={page:r,per_page:a};y&&y.length>0?(u.order_by=y[0].key,u.sort=y[0].order):(u.order_by=null,u.sort=null),w.value&&(u.search=w.value),k.value&&(u.has_yearly_evaluations=k.value),F.value&&(u.approved=F.value),E.value&&(u.operator_id=E.value),S.value&&(u.type=S.value),U.value&&(u.zip_code=U.value),await Re.get(route(route().current()),u,{preserveScroll:!0,preserveState:!0,onCancelToken:p=>{},onCancel:()=>{},onBefore:p=>{h.value=!0},onStart:p=>{},onProgress:p=>{},onSuccess:p=>{I.value=u.page,$.value=u.per_page},onError:p=>{console.log(p)},onFinish:p=>{h.value=!1}})}},De=r=>{ue.value=r.name,j.id=r.id,M.value=!0},j=Ee({id:null}),qe=async()=>{j.processing=!0;let r={onSuccess:a=>{C()},onError:a=>{C(),f.value=a},onFinish:()=>{j.processing=!1}};j.delete(route("kitas.destroy",{id:j.id}),r)},C=()=>{J.value=!1,M.value=!1,O.value=!1,s.reset(),s.clearErrors(),f.value={}},Ke=()=>{s.reset(),s.clearErrors()},s=Ee({name:null,number:null,street:null,house_number:null,city:null,additional_info:null,zip_code:null,operator_id:null,num_pedagogical_staff:null,approved:!0,type:null}),$e=async()=>{s.processing=!0,s.post(route("kitas.store"),{onSuccess:r=>{C()},onError:r=>{f.value=r},onFinish:()=>{s.processing=!1}})};return(r,a)=>{const y=c("v-card-title"),i=c("v-col"),u=c("v-row"),p=c("v-text-field"),x=c("v-select"),Be=c("v-checkbox"),G=c("v-container"),H=c("v-card-text"),Y=c("v-btn-primary"),V=c("v-hover"),L=c("v-spacer"),q=c("v-btn"),Q=c("v-card-actions"),W=c("v-card"),X=c("v-dialog"),Z=c("v-icon"),ee=c("v-tooltip"),je=c("v-data-table-server"),Ie=Oe("sortable-data-table");return T(),te(Se,null,[e(d(Me),{title:"Einrichtungen"}),e(He,{errors:f.value},{header:l(()=>[Le,n("div",Qe,[r.$page.props.auth.user.is_manager?oe("",!0):(T(),R(V,{key:0},{default:l(({isHovering:t,props:v})=>[e(q,g(v,{color:t?"accent":"primary",dark:""}),{default:l(()=>[b(" Anlegen "),e(X,{modelValue:J.value,"onUpdate:modelValue":a[11]||(a[11]=o=>J.value=o),activator:"parent",width:"80vw"},{default:l(()=>[e(W,{height:"80vh"},{default:l(()=>[e(y,null,{default:l(()=>[We]),_:1}),e(H,null,{default:l(()=>[e(G,null,{default:l(()=>[e(u,null,{default:l(()=>[e(i,{cols:"12"},{default:l(()=>[Xe]),_:1})]),_:1}),e(u,null,{default:l(()=>[e(i,{cols:"12",sm:"6"},{default:l(()=>[e(p,{modelValue:d(s).name,"onUpdate:modelValue":a[0]||(a[0]=o=>d(s).name=o),"error-messages":f.value.name,label:"Name der Einrichtung / Einrichtung*",required:""},null,8,["modelValue","error-messages"])]),_:1}),e(i,{cols:"12",sm:"6"},{default:l(()=>[e(p,{modelValue:d(s).number,"onUpdate:modelValue":a[1]||(a[1]=o=>d(s).number=o),"error-messages":f.value.number,label:"Kita Nummer*",type:"number",required:""},null,8,["modelValue","error-messages"])]),_:1})]),_:1}),e(u,null,{default:l(()=>[e(i,{cols:"12",sm:"6"},{default:l(()=>[e(p,{modelValue:d(s).street,"onUpdate:modelValue":a[2]||(a[2]=o=>d(s).street=o),"error-messages":f.value.street,label:"Straße*",required:""},null,8,["modelValue","error-messages"])]),_:1}),e(i,{cols:"12",sm:"6"},{default:l(()=>[e(p,{modelValue:d(s).house_number,"onUpdate:modelValue":a[3]||(a[3]=o=>d(s).house_number=o),"error-messages":f.value.house_number,label:"Hausnummer*",required:""},null,8,["modelValue","error-messages"])]),_:1})]),_:1}),e(u,null,{default:l(()=>[e(i,{cols:"12"},{default:l(()=>[e(p,{modelValue:d(s).additional_info,"onUpdate:modelValue":a[4]||(a[4]=o=>d(s).additional_info=o),"error-messages":f.value.additional_info,label:"Sonstiges",required:""},null,8,["modelValue","error-messages"])]),_:1})]),_:1}),e(u,null,{default:l(()=>[e(i,{cols:"12",sm:"6"},{default:l(()=>[e(p,{modelValue:d(s).zip_code,"onUpdate:modelValue":a[5]||(a[5]=o=>d(s).zip_code=o),"error-messages":f.value.zip_code,label:"Postleitzahl*",type:"number",required:""},null,8,["modelValue","error-messages"])]),_:1}),e(i,{cols:"12",sm:"6"},{default:l(()=>[e(p,{modelValue:d(s).city,"onUpdate:modelValue":a[6]||(a[6]=o=>d(s).city=o),"error-messages":f.value.city,label:"Stadt*",required:""},null,8,["modelValue","error-messages"])]),_:1})]),_:1}),e(u,null,{default:l(()=>[e(i,{cols:"12"},{default:l(()=>[el]),_:1})]),_:1}),e(u,null,{default:l(()=>[e(i,{cols:"12",sm:"6"},{default:l(()=>[e(x,{modelValue:d(s).operator_id,"onUpdate:modelValue":a[7]||(a[7]=o=>d(s).operator_id=o),items:z.operators,"error-messages":f.value.operator_id,"item-title":"name","item-value":"id",label:"Träger der Einrichtung*",required:""},null,8,["modelValue","items","error-messages"])]),_:1}),e(i,{cols:"12",sm:"6"},{default:l(()=>[e(p,{modelValue:d(s).num_pedagogical_staff,"onUpdate:modelValue":a[8]||(a[8]=o=>d(s).num_pedagogical_staff=o),"error-messages":f.value.num_pedagogical_staff,label:"Größe pädagogisches Team",type:"number"},null,8,["modelValue","error-messages"])]),_:1})]),_:1}),e(u,null,{default:l(()=>[e(i,{cols:"12",sm:"6"},{default:l(()=>[e(Be,{modelValue:d(s).approved,"onUpdate:modelValue":a[9]||(a[9]=o=>d(s).approved=o),label:"Kita zur Ampel zugelassen",value:!0},null,8,["modelValue"])]),_:1}),e(i,{cols:"12",sm:"6"},{default:l(()=>[e(x,{modelValue:d(s).type,"onUpdate:modelValue":a[10]||(a[10]=o=>d(s).type=o),items:z.types,"error-messages":f.value.type,label:"Träger der Einrichtung*",required:""},null,8,["modelValue","items","error-messages"])]),_:1})]),_:1})]),_:1})]),_:1}),e(Q,null,{default:l(()=>[e(V,null,{default:l(({isHovering:o,props:P})=>[e(Y,g({onClick:Ke},P,{color:o?"accent":"primary"}),{default:l(()=>[b("Zurücksetzen")]),_:2},1040,["color"])]),_:2},1024),e(L),e(V,null,{default:l(({isHovering:o,props:P})=>[e(q,g({onClick:C},P,{color:o?"accent":"primary"}),{default:l(()=>[b("Stornieren")]),_:2},1040,["color"])]),_:2},1024),e(V,null,{default:l(({isHovering:o,props:P})=>[e(Y,g({onClick:$e},P,{color:o?"accent":"primary"}),{default:l(()=>[b("Speichern")]),_:2},1040,["color"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1032,["modelValue"])]),_:2},1040,["color"])]),_:1}))]),e(X,{modelValue:M.value,"onUpdate:modelValue":a[12]||(a[12]=t=>M.value=t),width:"20vw"},{default:l(()=>[e(W,{height:"30vh"},{default:l(()=>[e(H,null,{default:l(()=>[e(G,null,{default:l(()=>[e(u,null,{default:l(()=>[e(i,{cols:"12"},{default:l(()=>[n("p",null,"Sind Sie sicher, dass Sie die Einrichtung "+A(ue.value)+" löschen möchten?",1)]),_:1})]),_:1})]),_:1})]),_:1}),e(Q,null,{default:l(()=>[e(L),e(V,null,{default:l(({isHovering:t,props:v})=>[e(q,g({onClick:C},v,{color:t?"accent":"primary"}),{default:l(()=>[b("Abbrechen")]),_:2},1040,["color"])]),_:1}),e(V,null,{default:l(({isHovering:t,props:v})=>[e(Y,g({onClick:qe},v,{color:t?"accent":"primary"}),{default:l(()=>[b("Löschen")]),_:2},1040,["color"])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),default:l(()=>[n("div",ll,[n("div",al,[n("div",tl,[e(u,null,{default:l(()=>[e(i,{cols:"12",sm:"4"},{default:l(()=>[e(p,{modelValue:w.value,"onUpdate:modelValue":a[13]||(a[13]=t=>w.value=t),label:"Suchen",disabled:h.value,clearable:""},null,8,["modelValue","disabled"])]),_:1}),e(i,{cols:"12",sm:"4"},{default:l(()=>[e(x,{modelValue:k.value,"onUpdate:modelValue":a[14]||(a[14]=t=>k.value=t),items:ze,label:`Jährliche Rückmeldung ${new Date().getFullYear()} abgeschlossen`,multiple:"",disabled:h.value,clearable:""},null,8,["modelValue","label","disabled"])]),_:1}),e(i,{cols:"12",sm:"4"},{default:l(()=>[e(x,{modelValue:F.value,"onUpdate:modelValue":a[15]||(a[15]=t=>F.value=t),items:Fe,label:"Zugelassen",multiple:"",disabled:h.value,clearable:""},null,8,["modelValue","disabled"])]),_:1})]),_:1}),e(u,null,{default:l(()=>[e(i,{cols:"12",sm:"4"},{default:l(()=>[e(x,{modelValue:E.value,"onUpdate:modelValue":a[16]||(a[16]=t=>E.value=t),items:z.operators,"item-title":"name","item-value":"id",label:"Träger",multiple:"",disabled:h.value,clearable:""},null,8,["modelValue","items","disabled"])]),_:1}),e(i,{cols:"12",sm:"4"},{default:l(()=>[e(x,{modelValue:S.value,"onUpdate:modelValue":a[17]||(a[17]=t=>S.value=t),items:z.types,label:"Typ",multiple:"",disabled:h.value,clearable:""},null,8,["modelValue","items","disabled"])]),_:1}),e(i,{cols:"12",sm:"4"},{default:l(()=>[e(x,{modelValue:U.value,"onUpdate:modelValue":a[18]||(a[18]=t=>U.value=t),items:z.zipCodes,label:"Postleitzahl",multiple:"",disabled:h.value,clearable:""},null,8,["modelValue","items","disabled"])]),_:1})]),_:1})])]),n("div",null,[e(u,{class:"flex justify-end mb-4"},{default:l(()=>[e(V,null,{default:l(({isHovering:t,props:v})=>[e(i,{cols:"12",sm:"4",class:"text-right"},{default:l(()=>[e(q,g(v,{color:t?"accent":"primary",dark:"",onClick:Ae}),{default:l(()=>[e(Z,g(v,{size:"small",class:"tw-me-2"}),{default:l(()=>[b("mdi-email")]),_:2},1040),ol]),_:2},1040,["color"])]),_:2},1024)]),_:1})]),_:1})]),Ye((T(),R(je,{"items-per-page":$.value,"onUpdate:itemsPerPage":a[20]||(a[20]=t=>$.value=t),"items-per-page-options":[{value:10,title:"10"},{value:25,title:"25"},{value:50,title:"50"},{value:100,title:"100"},{value:-1,title:"$vuetify.dataFooter.itemsPerPageAll"}],"items-per-page-text":"Objekte pro Seite:",headers:Ce,page:I.value,"items-length":se.value,items:Ne.value,search:re.value,loading:h.value,class:"data-table-container elevation-1","item-value":"name","onUpdate:options":ie},{item:l(({item:t})=>{var v,o,P,_e,fe,ge,be,he,ye,Ve,we;return[n("tr",{"data-id":t.selectable.id,"data-order":t.selectable.order},[n("td",null,A((v=t.selectable)==null?void 0:v.name),1),n("td",null,A((o=t.selectable)!=null&&o.has_yearly_evaluations?"Ja":"Nein"),1),n("td",null,A((P=t.selectable)!=null&&P.approved?"Ja":"Nein"),1),n("td",null,A(((fe=(_e=t.selectable)==null?void 0:_e.operator)==null?void 0:fe.name)??"-"),1),n("td",null,A(((ge=t.selectable)==null?void 0:ge.formatted_type)??((be=t.selectable)==null?void 0:be.type)),1),n("td",null,A((he=t.selectable)==null?void 0:he.zip_code),1),n("td",rl,[(ye=t.selectable)!=null&&ye.approved&&((Ve=t.selectable)==null?void 0:Ve.users_emails.length)>0&&!((we=t.selectable)!=null&&we.has_yearly_evaluations)?(T(),R(ee,{key:0,location:"top"},{activator:l(({props:K})=>{var le;return[n("a",g({href:`mailto:?bcc=${(le=t.selectable)==null?void 0:le.users_emails.join(",")}`},K),[e(Z,g(K,{size:"small",class:"tw-me-2"}),{default:l(()=>[b("mdi-email")]),_:2},1040)],16,ul)]}),default:l(()=>[nl]),_:2},1024)):oe("",!0),e(ee,{location:"top"},{activator:l(({props:K})=>[e(d(Ze),{href:r.route("kitas.show",{id:t.selectable.id})},{default:l(()=>[e(Z,g(K,{size:"small",class:"tw-me-2"}),{default:l(()=>[b("mdi-pencil")]),_:2},1040)]),_:2},1032,["href"])]),default:l(()=>[il]),_:2},1024),r.$page.props.auth.user.is_manager?oe("",!0):(T(),R(ee,{key:1,location:"top"},{activator:l(({props:K})=>[e(Z,g(K,{size:"small",class:"tw-me-2",onClick:le=>De(t.raw)}),{default:l(()=>[b("mdi-delete")]),_:2},1040,["onClick"])]),default:l(()=>[dl]),_:2},1024))])],8,sl)]}),"no-data":l(()=>[n("div",ml,[ne.value?(T(),te("h3",cl,"Die Tabelle ist leer.")):(T(),te(Se,{key:1},[pl,e(q,{color:"primary",onClick:a[19]||(a[19]=t=>ie({page:1,itemsPerPage:$.value,clearFilters:!0}))},{default:l(()=>[b("Reset")]),_:1})],64))])]),_:1},8,["items-per-page","items-per-page-options","page","items-length","items","search","loading"])),[[Ie]])]),e(X,{modelValue:O.value,"onUpdate:modelValue":a[22]||(a[22]=t=>O.value=t),width:"40vw"},{default:l(()=>[e(W,{height:"80vh"},{default:l(()=>[e(y,null,{default:l(()=>[vl]),_:1}),e(H,null,{default:l(()=>[e(G,null,{default:l(()=>[e(u,null,{default:l(()=>[e(i,{cols:"12"},{default:l(()=>[e(x,{modelValue:B.value,"onUpdate:modelValue":a[21]||(a[21]=t=>B.value=t),items:z.usersEmails,label:"Benutzer",multiple:"",disabled:h.value,clearable:""},null,8,["modelValue","items","disabled"])]),_:1})]),_:1})]),_:1})]),_:1}),e(Q,null,{default:l(()=>[e(V,null,{default:l(({isHovering:t,props:v})=>[e(q,g({onClick:C},v,{color:t?"accent":"primary"}),{default:l(()=>[b(" Abbrechen ")]),_:2},1040,["color"])]),_:1}),e(L),e(V,null,{default:l(({isHovering:t,props:v})=>[e(Y,g({href:`mailto:?bcc=${B.value.join(",")}`},v,{color:t?"accent":"primary",disabled:!B.value.length}),{default:l(()=>[b(" Öffnen Sie den Mail-Client ")]),_:2},1040,["href","color","disabled"])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["errors"])],64)}}};export{hl as default};
