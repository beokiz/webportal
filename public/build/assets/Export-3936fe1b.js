import{d as j}from"./index-7b7a254b.js";import{K as H,k as r,h as P,m as B,T as I,r as d,o as J,f as L,a as t,u as O,w as o,F as S,Z as T,b as f,p as y,d as R,N as $}from"./app-b1b196f8.js";import{_ as K}from"./AuthenticatedLayout-c78cbc5f.js";import{a as Y}from"./common-6599ea66.js";import{v as Z}from"./v4-4a60fe23.js";import"./ApplicationLogo-fc9faf66.js";const q=f("h2",{class:"tw-font-semibold tw-text-xl tw-text-gray-800 tw-leading-tight"},"Screenings exportieren",-1),G={class:"tw-table-block tw-max-w-full tw-mx-auto tw-py-6 tw-px-4 sm:tw-px-6 lg:tw-px-8"},Q={class:"tw-bg-white tw-flex tw-justify-between tw-px-6 tw-py-6"},W={class:"tw-w-full"},X={class:"tw-ml-6"},ne={__name:"Export",props:{domains:Object,errors:Object},setup(N){const k=N;j.Inertia.on("success",a=>{a.detail.page.props,a.detail.page.component}),H().props.auth.user;const _=r(k.errors||{}),u=r(!1),A=r(null),D=r(null),p=r(),v=r(),w=r("2.5"),g=r(null),x=r(null),V=r(!1),h=r(!1),z=P(()=>{let a=[{id:null,name:"Alle"}];return k.domains.map(e=>(a.push({id:e.id,name:e.name}),e)),a});B(p,a=>{A.value=F(a)}),B(v,a=>{D.value=F(a)});const F=a=>{console.log(a);const e=new Date(a),s=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],i=e.getDate(),m=s[e.getMonth()],n=e.getFullYear();return`${e.toDateString().slice(0,3)}, ${i}. ${m} ${n}`};I({});const C=async()=>{$.start(),u.value=!0;let a=new Date(p.value),e=new Date(v.value);a.setHours(a.getHours()+12),e.setHours(e.getHours()+12);try{const s=await axios.post(route("export.make"),{finished_after:a,finished_before:e,age:w.value,zip_code:g.value,domains:x.value},{responseType:"blob"});console.log(s.headers);const i=s.headers["content-disposition"],m=i.indexOf("filename=");let n;m!==-1?n=i.slice(m+9).replace(/['"]/g,""):n=Z();const b=new Blob([s.data],{type:s.headers["content-type"]}),c=document.createElement("a");c.href=window.URL.createObjectURL(b),c.download=n,c.click()}catch(s){console.error(s)}$.done(),u.value=!1};return(a,e)=>{const s=d("v-text-field"),i=d("v-date-picker"),m=d("v-menu"),n=d("v-col"),b=d("v-row"),c=d("v-select"),U=d("v-btn"),E=d("v-hover");return J(),L(S,null,[t(O(T),{title:"Screenings exportieren"}),t(K,{errors:_.value},{header:o(()=>[q]),default:o(()=>[f("div",G,[f("div",Q,[f("div",W,[t(b,null,{default:o(()=>[t(n,{cols:"12",sm:"6"},{default:o(()=>[t(m,{modelValue:V.value,"onUpdate:modelValue":e[2]||(e[2]=l=>V.value=l),"return-value":p.value,"close-on-content-click":!1},{activator:o(({props:l})=>[t(s,y({label:"Abgegeben ab",class:"tw-cursor-pointer","model-value":A.value,"prepend-icon":"mdi-calendar",readonly:""},l,{disabled:u.value}),null,16,["model-value","disabled"])]),default:o(()=>[t(i,{"onUpdate:modelValue":[e[0]||(e[0]=l=>V.value=!1),e[1]||(e[1]=l=>p.value=l)],modelValue:p.value},null,8,["modelValue"])]),_:1},8,["modelValue","return-value"])]),_:1}),t(n,{cols:"12",sm:"6"},{default:o(()=>[t(m,{modelValue:h.value,"onUpdate:modelValue":e[5]||(e[5]=l=>h.value=l),"return-value":v.value,"close-on-content-click":!1},{activator:o(({props:l})=>[t(s,y({label:"Abgegeben bis",class:"tw-cursor-pointer","model-value":D.value,"prepend-icon":"mdi-calendar",readonly:""},l,{disabled:u.value}),null,16,["model-value","disabled"])]),default:o(()=>[t(i,{"onUpdate:modelValue":[e[3]||(e[3]=l=>h.value=!1),e[4]||(e[4]=l=>v.value=l)],modelValue:v.value},null,8,["modelValue"])]),_:1},8,["modelValue","return-value"])]),_:1})]),_:1}),t(b,null,{default:o(()=>[t(n,{cols:"12",sm:"4"},{default:o(()=>[t(c,{modelValue:x.value,"onUpdate:modelValue":e[6]||(e[6]=l=>x.value=l),items:z.value,"error-messages":_.value.domain,"item-title":"name","item-value":"id",label:"DomÃ¤ne",disabled:u.value},null,8,["modelValue","items","error-messages","disabled"])]),_:1}),t(n,{cols:"12",sm:"4"},{default:o(()=>[t(c,{modelValue:w.value,"onUpdate:modelValue":e[7]||(e[7]=l=>w.value=l),items:O(Y),"error-messages":_.value.age,"item-title":"age_name","item-value":"age_number",label:"Altersgruppe",disabled:u.value},null,8,["modelValue","items","error-messages","disabled"])]),_:1}),t(n,{cols:"12",sm:"4"},{default:o(()=>[t(s,{modelValue:g.value,"onUpdate:modelValue":e[8]||(e[8]=l=>g.value=l),type:"number","error-messages":_.value.zipCode,label:"Postleitzahl",disabled:u.value},null,8,["modelValue","error-messages","disabled"])]),_:1})]),_:1})]),f("div",X,[t(E,null,{default:o(({isHovering:l,props:M})=>[t(U,y({class:"tw-mt-2"},M,{color:l?"accent":"primary",onClick:C,dark:"",disabled:u.value}),{default:o(()=>[R("Exportieren")]),_:2},1040,["color","disabled"])]),_:1})])])])]),_:1},8,["errors"])],64)}}};export{ne as default};
