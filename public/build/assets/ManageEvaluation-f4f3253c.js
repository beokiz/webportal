import{d as le}from"./index-fe724e35.js";import{K as se,j as h,k as oe,v as ie,s as re,T as R,l as ue,r as u,o as k,f as K,a as e,u as i,w as a,F as de,Z as ce,b as v,c as I,h as N,m as x,d as p,t as me,x as _e}from"./app-34c8cf6c.js";import{p as F,a as ve}from"./common-ea192878.js";import{_ as pe}from"./AuthenticatedLayout-178e3968.js";import{_ as Y}from"./EvaluationDomainsList-996743d2.js";import{v as ge}from"./v4-4a60fe23.js";import"./ApplicationLogo-ae113348.js";const fe=v("h2",{class:"tw-font-semibold tw-text-xl tw-text-gray-800 tw-leading-tight"},"Auswertung erstellen",-1),he={class:"tw-table-block tw-max-w-full tw-mx-auto tw-py-6 tw-px-4 sm:tw-px-6 lg:tw-px-8"},we=v("h3",null,"Eigenschaften",-1),be={key:0,class:"tw-flex justify-center items-center tw-bg-white"},ke={class:"tw-text-right"},xe={class:"tw-text-center"},ye=v("h1",{class:"tw-uppercase text-primary tw-font-black tw-text-xl tw-mb-8"}," Einschätzung wurde eingereicht ",-1),Ve=v("p",{class:"tw-mb-8"}," Folgendes Einschätzung wurde eingereicht und kann nur bis 15 Minuten nach Einreichung bearbeitet werden. Danach verschwindet es aus Ihrer Übersicht. Sollten Sie es zurückziehen oder bearbeiten wollen, klicke Sie auf 'Abgabe zurückziehen. Nachfolgend erhalten Sie eine Übersicht des eingereichten Screenings, welches Sie über den Download-Button als PDF herunterladen können. ",-1),Ee=v("span",{class:"tw-font-black"},"Bezeichner des Einschätzung",-1),Me={__name:"ManageEvaluation",props:{evaluation:Object,kitas:Array,domains:Array,errors:Object,newCustomUniqueId:String},setup(y){const r=y;le.Inertia.on("success",s=>{s.detail.page.props,s.detail.page.component});const $=se().props.auth.user??{},M=h(null),c=h(r.errors||{}),w=h(!1),U=h([]),V=h(!1),b=h(null),E=h([{name:"1 - 12 Monate",id:"upToOneYear"},{name:"12 - 24 Monate",id:"upToTwoYears"},{name:"24 - 36 Monate",id:"upToThreeYears"}]),d=oe(()=>!!r.evaluation);ie(()=>{d.value||j()}),re(()=>{var s;B((s=r.evaluation)==null?void 0:s.age),d.value||q()});const q=()=>{M.value=ge(),t.uuid=M.value},B=s=>{if(s===4.5)E.value.push({name:"Länger als 36 Monate",id:"moreThanThreeYears"});else{const l=E.value.findIndex(o=>o.id==="moreThanThreeYears");l!==-1&&E.value.splice(l,1)}},j=()=>{t.ratings=F(r.domains)},S=()=>{c.value={},V.value=!1},O=()=>{t.reset(),t.clearErrors(),c.value={},t.ratings=F(r.domains),d.value||q()},t=R({id:d.value?r.evaluation.id:null,custom_unique_id:d.value?r.evaluation.custom_unique_id:r.newCustomUniqueId,uuid:d.value?r.evaluation.uuid:null,user_id:d.value?r.evaluation.user_id:$.id,kita_id:d.value?r.evaluation.kita_id:null,age:d.value?r.evaluation.age:null,child_duration_in_kita:d.value?r.evaluation.child_duration_in_kita:null,is_daz:d.value?r.evaluation.is_daz:!1,integration_status:d.value?r.evaluation.integration_status:!1,speech_therapy_status:d.value?r.evaluation.speech_therapy_status:!1,ratings:d.value?r.evaluation.data:[]});ue(()=>t.age,s=>{t.ratings=F(r.domains),B(s),s!==4.5&&(t.child_duration_in_kita=null)});const P=s=>{t.ratings=s},Z=s=>{U.value=_e(s)?s.value:s},H=async()=>{t.processing=!0,w.value=!0;let s=[];U.value.map(o=>(o.subdomains.map(m=>(m.milestones.map(g=>(s.push(parseInt(g.id)),g)),m)),o)),t.ratings=t.ratings.map(o=>(o.milestones.map(m=>(s.includes(parseInt(m.id))||(m.value=0),m)),o));let l={onSuccess:o=>{t.clearErrors(),c.value={},V.value=!0,b.value=o.props.data},onError:o=>{c.value=o},onFinish:()=>{t.processing=!1,w.value=!1}};d.value?t.put(route("evaluations.update",{evaluation:r.evaluation.id}),l):t.post(route("evaluations.store"),l)},L=async()=>{t.processing=!0,w.value=!0,t.post(route("evaluations.save"),{preserveState:!1,onSuccess:s=>{t.clearErrors(),c.value={}},onError:s=>{c.value=s},onFinish:()=>{t.processing=!1,w.value=!1}})},z=R({}),G=async s=>{z.processing=!0,z.post(route("evaluations.unfinished",{id:s}),{preserveState:!1,onSuccess:l=>{z.clearErrors(),c.value={},S()},onError:l=>{c.value=l},onFinish:()=>{z.processing=!1,w.value=!1}})};return(s,l)=>{const o=u("v-col"),m=u("v-row"),g=u("v-container"),J=u("v-text-field"),T=u("v-select"),C=u("v-checkbox"),Q=u("v-progress-circular"),D=u("v-btn"),f=u("v-hover"),A=u("v-btn-primary"),W=u("v-icon"),X=u("v-card-text"),ee=u("v-spacer"),ae=u("v-card-actions"),te=u("v-card"),ne=u("v-dialog");return k(),K(de,null,[e(i(ce),{title:"Auswertung erstellen"}),e(pe,{errors:c.value},{header:a(()=>[fe]),default:a(()=>[v("div",he,[e(g,null,{default:a(()=>[e(m,null,{default:a(()=>[e(o,{cols:"12"},{default:a(()=>[we]),_:1})]),_:1})]),_:1}),e(g,null,{default:a(()=>[e(m,null,{default:a(()=>[e(o,{cols:"12",sm:"3"},{default:a(()=>[e(J,{modelValue:i(t).custom_unique_id,"onUpdate:modelValue":l[0]||(l[0]=n=>i(t).custom_unique_id=n),"error-messages":c.value.custom_unique_id,readonly:"",label:"Bezeichner der Einschatzung",required:""},null,8,["modelValue","error-messages"])]),_:1}),e(o,{cols:"12",sm:"2"},{default:a(()=>[e(T,{modelValue:i(t).age,"onUpdate:modelValue":l[1]||(l[1]=n=>i(t).age=n),items:i(ve),"error-messages":c.value.age,"item-title":"age_name","item-value":"age_number",label:"Altersgruppe"},null,8,["modelValue","items","error-messages"])]),_:1}),e(o,{cols:"12",sm:"2"},{default:a(()=>[e(T,{modelValue:i(t).kita_id,"onUpdate:modelValue":l[2]||(l[2]=n=>i(t).kita_id=n),items:y.kitas,"error-messages":c.value.kita_id,"item-title":"name","item-value":"id",label:"KiTa"},null,8,["modelValue","items","error-messages"])]),_:1}),e(o,{cols:"12",sm:"2"},{default:a(()=>[e(T,{modelValue:i(t).child_duration_in_kita,"onUpdate:modelValue":l[3]||(l[3]=n=>i(t).child_duration_in_kita=n),items:E.value,"error-messages":c.value.child_duration_in_kita,"item-title":"name","item-value":"id",label:"Zeitraum in der KiTa"},null,8,["modelValue","items","error-messages"])]),_:1}),e(o,{cols:"12",sm:"3"},{default:a(()=>[e(C,{modelValue:i(t).is_daz,"onUpdate:modelValue":l[4]||(l[4]=n=>i(t).is_daz=n),label:"Deutsch ist nicht Erstsprache des Kindes"},null,8,["modelValue"]),e(C,{modelValue:i(t).integration_status,"onUpdate:modelValue":l[5]||(l[5]=n=>i(t).integration_status=n),label:"Integrationsstatus"},null,8,["modelValue"]),e(C,{modelValue:i(t).speech_therapy_status,"onUpdate:modelValue":l[6]||(l[6]=n=>i(t).speech_therapy_status=n),label:"in logopädische Behandlung"},null,8,["modelValue"])]),_:1})]),_:1}),e(m,{class:"manage-evaluation-domains"},{default:a(()=>[i(t).age?(k(),I(Y,{key:0,ratings:i(t).ratings,age:i(t).age,domains:y.domains,errors:c.value,onUpdateRatingData:P,onUpdateDomainsData:Z},null,8,["ratings","age","domains","errors"])):N("",!0)]),_:1})]),_:1}),e(g,null,{default:a(()=>[w.value?(k(),K("div",be,[e(Q,{indeterminate:"",size:40})])):(k(),I(m,{key:1},{default:a(()=>[e(o,{cols:"12",sm:"6"},{default:a(()=>[e(f,null,{default:a(({isHovering:n,props:_})=>[e(D,x({onClick:O},_,{color:n?"primary":"accent"}),{default:a(()=>[p(" Zurücksetzen ")]),_:2},1040,["color"])]),_:1})]),_:1}),e(o,{cols:"12",sm:"6",align:"right"},{default:a(()=>[e(f,null,{default:a(({isHovering:n,props:_})=>[e(D,x({class:"mr-2",onClick:L,variant:"text"},_,{color:n?"accent":"primary"}),{default:a(()=>[p(" Speichern ")]),_:2},1040,["color"])]),_:1}),i(t).age&&U.value.length>0?(k(),I(f,{key:0},{default:a(({isHovering:n,props:_})=>[e(A,x({onClick:H},_,{color:n?"accent":"primary"}),{default:a(()=>[p(" Prüfen und Einreichen ")]),_:2},1040,["color"])]),_:1})):N("",!0)]),_:1})]),_:1}))]),_:1})]),e(ne,{modelValue:V.value,"onUpdate:modelValue":l[8]||(l[8]=n=>V.value=n),width:"95vw"},{default:a(()=>[e(te,{height:"95vh"},{default:a(()=>[e(X,null,{default:a(()=>[e(g,null,{default:a(()=>[e(m,{class:"result-evaluation-domains"},{default:a(()=>[e(o,{cols:"12"},{default:a(()=>[e(f,null,{default:a(({isHovering:n,props:_})=>[v("div",ke,[e(W,x(_,{size:"small",class:"tw-me-2",onClick:S,title:"Fenster schließen"}),{default:a(()=>[p("mdi-close")]),_:2},1040)])]),_:1})]),_:1})]),_:1}),e(m,{class:"result-evaluation-domains"},{default:a(()=>[e(o,{cols:"8",offset:"2"},{default:a(()=>[v("div",xe,[ye,Ve,e(f,null,{default:a(({isHovering:n,props:_})=>[e(D,{href:s.route("evaluations.pdf",{id:b.value.item.id}),class:"tw-px-2 tw-py-3 tw-mb-4 tw-mr-4 tw-normal-case",color:n?"primary":"accent"},{default:a(()=>[p(" Einschätzung als PDF downloaden ")]),_:2},1032,["href","color"])]),_:1}),e(f,null,{default:a(({isHovering:n,props:_})=>[e(D,{onClick:l[7]||(l[7]=ze=>G(b.value.item.id)),class:"tw-px-2 tw-py-3 tw-mb-4 tw-normal-case",color:n?"accent":"primary"},{default:a(()=>[p(" Abgabe zurückziehen ")]),_:2},1032,["color"])]),_:1})])]),_:1}),e(o,{cols:"12"},{default:a(()=>[v("p",null,[Ee,p(": "+me(`${b.value.item.kita.formatted_name}_${b.value.item.custom_unique_id}`),1)])]),_:1}),e(o,{cols:"12"},{default:a(()=>[e(Y,{ratings:b.value.item.data,age:i(t).age,domains:y.domains,disabled:!0},null,8,["ratings","age","domains"])]),_:1})]),_:1})]),_:1})]),_:1}),e(ae,null,{default:a(()=>[e(ee),e(f,null,{default:a(({isHovering:n,props:_})=>[e(A,x({onClick:S},_,{color:n?"accent":"primary"}),{default:a(()=>[p("Abbrechen")]),_:2},1040,["color"])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["errors"])],64)}}};export{Me as default};
