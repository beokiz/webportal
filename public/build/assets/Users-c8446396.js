import{d as me}from"./index-b18ae77a.js";import{K as _e,x as d,h as O,k as pe,T as Q,r as n,o as B,f as I,a as e,u as c,w as t,F as W,Z as fe,b as o,A as w,d as f,n as ve,t as C,i as ge,O as we}from"./app-e941b204.js";import{_ as be}from"./AuthenticatedLayout-d88382df.js";import"./ApplicationLogo-d23b7f20.js";const X=F=>{const m={year:"numeric",month:"2-digit",day:"2-digit"};return new Date(F).toLocaleDateString("en-US",m).replace(/\//g,".")},ye=o("h2",{class:"tw-font-semibold tw-text-xl tw-text-gray-800 tw-leading-tight"},"Users",-1),he={class:"tw-flex tw-items-center tw-justify-end"},Ve=o("span",{class:"tw-text-h5"},"New User",-1),ke=o("p",null,"Are you sure that you want to delete current user?",-1),xe={class:"tw-table-block tw-max-w-full tw-mx-auto tw-py-6 tw-px-4 sm:tw-px-6 lg:tw-px-8"},Ue={class:"tw-bg-white tw-flex tw-justify-between tw-px-6 tw-py-6"},Pe={class:"tw-w-full"},Ne={class:"tw-ml-6"},Ce={align:"center"},Fe=o("span",null,"Edit user",-1),De=o("span",null,"Delete User",-1),Se={class:"tw-py-6"},Ee={key:0,class:"tw-mb-4"},Ae=o("h3",{class:"tw-mb-4"},"Table is empty. Please, reset search filters",-1),je={__name:"Users",props:{items:Array,currentPage:Number,perPage:Number,lastPage:Number,total:Number,paging:Boolean,orderBy:String,sort:String,filters:Object,errors:Object,roles:Array},setup(F){const m=F;me.Inertia.on("success",s=>{let l=s.detail.page.props;s.detail.page.component==="Users"&&l&&(V.value=l.currentPage,k.value=l.perPage,Y.value=l.orderBy,ee.value=l.sort,j.value=l.total,le.value=l.lastPage,b.value=l.filters.full_name??null,y.value=l.filters.email??null)}),_e().props.auth.user;const V=d(m.currentPage),k=d(m.perPage),Y=d(m.orderBy),ee=d(m.sort),j=d(m.total),le=d(m.lastPage),b=d(m.filters.full_name??null),y=d(m.filters.email??null),q=d(""),v=d(m.errors||{}),E=d(!1),D=d(!1),S=d(!1),te=d(-1),ae=[{title:"Status",key:"is_online",width:"5%",sortable:!1,align:"center"},{title:"Name",key:"first_name",width:"25%",sortable:!1},{title:"Email",key:"email",width:"20%",sortable:!1},{title:"Role",key:"primary_role_name",width:"10%",sortable:!1},{title:"Last Seen",key:"last_seen_at",width:"15%",sortable:!1},{title:"First Login",key:"first_login_at",width:"15%",sortable:!1},{title:"Actions",key:"actions",width:"10%",sortable:!1}],oe=O(()=>m.items.map(s=>{const l={...s};for(const _ in l)(l[_]===null||l[_]===void 0)&&(l[_]="-");return l})),z=O(()=>b.value===null&&y.value===null),se=O(()=>b.value!==null||y.value!==null);pe(D,s=>{s||U()});const L=async({page:s,itemsPerPage:l,sortBy:_,clearFilters:g})=>{if(g&&(b.value=null,y.value=null),s===V.value&&g||z||se){E.value=!0;let i={data:{page:s,per_page:l}};_&&_.length>0&&(i.data.order_by=_[0].key,i.data.sort=_[0].order),i.data.full_name=b.value,i.data.email=y.value,await we.reload(i),V.value=s,k.value=l,E.value=!1}},ne=s=>{x.id=s.id,S.value=!0},x=Q({id:null}),re=async()=>{x.processing=!0;let s={onSuccess:l=>{U()},onError:l=>{v.value=l},onFinish:()=>{x.processing=!1}};x.delete(route("users.destroy",{id:x.id}),s)},U=()=>{D.value=!1,S.value=!1,u.reset(),u.clearErrors(),te.value=-1,v.value={}},u=Q({first_name:null,last_name:null,email:null,role:null,two_factor_auth_enabled:!1}),ue=async()=>{u.processing=!0;let s={onSuccess:l=>{U()},onError:l=>{v.value=l},onFinish:()=>{u.processing=!1}};u.post(route("users.store"),s)};return(s,l)=>{const _=n("v-card-title"),g=n("v-text-field"),i=n("v-col"),P=n("v-row"),ie=n("v-select"),de=n("v-checkbox"),$=n("v-container"),R=n("v-card-text"),K=n("v-spacer"),N=n("v-btn"),h=n("v-hover"),Z=n("v-btn-primary"),G=n("v-card-actions"),H=n("v-card"),J=n("v-dialog"),A=n("v-icon"),M=n("v-tooltip"),ce=n("v-data-table-server");return B(),I(W,null,[e(c(fe),{title:"Users"}),e(be,{errors:v.value},{header:t(()=>[ye,o("div",he,[e(h,null,{default:t(({isHovering:a,props:p})=>[e(N,w(p,{color:a?"accent":"primary",dark:""}),{default:t(()=>[f(" Add New User "),e(J,{modelValue:D.value,"onUpdate:modelValue":l[5]||(l[5]=r=>D.value=r),activator:"parent",width:"80vw"},{default:t(()=>[e(H,{height:"80vh"},{default:t(()=>[e(_,null,{default:t(()=>[Ve]),_:1}),e(R,null,{default:t(()=>[e($,null,{default:t(()=>[e(P,null,{default:t(()=>[e(i,{cols:"12",sm:"6"},{default:t(()=>[e(g,{modelValue:c(u).first_name,"onUpdate:modelValue":l[0]||(l[0]=r=>c(u).first_name=r),"error-messages":v.value.first_name,label:"First Name",required:""},null,8,["modelValue","error-messages"])]),_:1}),e(i,{cols:"12",sm:"6"},{default:t(()=>[e(g,{modelValue:c(u).last_name,"onUpdate:modelValue":l[1]||(l[1]=r=>c(u).last_name=r),"error-messages":v.value.last_name,label:"Last Name",required:""},null,8,["modelValue","error-messages"])]),_:1})]),_:1}),e(P,null,{default:t(()=>[e(i,{cols:"12",sm:"6"},{default:t(()=>[e(g,{modelValue:c(u).email,"onUpdate:modelValue":l[2]||(l[2]=r=>c(u).email=r),"error-messages":v.value.email,label:"Email",required:""},null,8,["modelValue","error-messages"])]),_:1}),e(i,{cols:"12",sm:"6"},{default:t(()=>[e(ie,{modelValue:c(u).role,"onUpdate:modelValue":l[3]||(l[3]=r=>c(u).role=r),items:F.roles,"error-messages":v.value.role,"item-title":"name","item-value":"id",label:"Role",required:""},null,8,["modelValue","items","error-messages"])]),_:1})]),_:1}),e(P,null,{default:t(()=>[e(i,{cols:"12",md:"4",sm:"6"},{default:t(()=>[e(de,{modelValue:c(u).two_factor_auth_enabled,"onUpdate:modelValue":l[4]||(l[4]=r=>c(u).two_factor_auth_enabled=r),label:"2-Factor Authentication",value:!0},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),e(G,null,{default:t(()=>[e(K),e(h,null,{default:t(({isHovering:r,props:T})=>[e(N,w({onClick:U},T,{color:r?"accent":"primary"}),{default:t(()=>[f("Cancel")]),_:2},1040,["color"])]),_:2},1024),e(h,null,{default:t(({isHovering:r,props:T})=>[e(Z,w({onClick:ue},T,{color:r?"accent":"primary"}),{default:t(()=>[f("Save")]),_:2},1040,["color"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1032,["modelValue"])]),_:2},1040,["color"])]),_:1})]),e(J,{modelValue:S.value,"onUpdate:modelValue":l[6]||(l[6]=a=>S.value=a),activator:"parent",width:"20vw"},{default:t(()=>[e(H,{height:"30vh"},{default:t(()=>[e(R,null,{default:t(()=>[e($,null,{default:t(()=>[e(P,null,{default:t(()=>[e(i,{cols:"12"},{default:t(()=>[ke]),_:1})]),_:1})]),_:1})]),_:1}),e(G,null,{default:t(()=>[e(K),e(h,null,{default:t(({isHovering:a,props:p})=>[e(N,w({onClick:U},p,{color:a?"accent":"primary"}),{default:t(()=>[f("Cancel")]),_:2},1040,["color"])]),_:1}),e(h,null,{default:t(({isHovering:a,props:p})=>[e(Z,w({onClick:re},p,{color:a?"accent":"primary"}),{default:t(()=>[f("Delete")]),_:2},1040,["color"])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),default:t(()=>[o("div",xe,[o("div",Ue,[o("div",Pe,[e(P,null,{default:t(()=>[e(i,{cols:"12",sm:"3"},{default:t(()=>[e(g,{modelValue:b.value,"onUpdate:modelValue":l[7]||(l[7]=a=>b.value=a),label:"Name"},null,8,["modelValue"])]),_:1}),e(i,{cols:"12",sm:"3"},{default:t(()=>[e(g,{modelValue:y.value,"onUpdate:modelValue":l[8]||(l[8]=a=>y.value=a),label:"Email"},null,8,["modelValue"])]),_:1})]),_:1})]),o("div",Ne,[e(h,null,{default:t(({isHovering:a,props:p})=>[e(N,w({class:"tw-mt-2"},p,{color:a?"accent":"primary",onClick:l[9]||(l[9]=r=>q.value=String(Date.now())),dark:""}),{default:t(()=>[f("Search")]),_:2},1040,["color"])]),_:1})])]),e(ce,{"items-per-page":k.value,"onUpdate:itemsPerPage":l[11]||(l[11]=a=>k.value=a),headers:ae,page:V.value,"items-length":j.value,items:oe.value,search:q.value,loading:E.value,class:"data-table-container elevation-1","item-value":"name","onUpdate:options":L},{item:t(({item:a})=>[o("tr",null,[o("td",Ce,[e(A,{size:"medium",class:ve({active:a.selectable.is_online})},{default:t(()=>[f("mdi-circle")]),_:2},1032,["class"])]),o("td",null,C(a.selectable.full_name),1),o("td",null,C(a.selectable.email),1),o("td",null,C(a.selectable.primary_role_name),1),o("td",null,C(c(X)(a.selectable.last_seen_at)),1),o("td",null,C(c(X)(a.selectable.first_login_at)),1),o("td",null,[e(M,{location:"top"},{activator:t(({props:p})=>[e(c(ge),{href:s.route("users.edit",{id:a.selectable.id})},{default:t(()=>[e(A,w(p,{size:"small",class:"tw-me-2"}),{default:t(()=>[f("mdi-pencil")]),_:2},1040)]),_:2},1032,["href"])]),default:t(()=>[Fe]),_:2},1024),e(M,{location:"top"},{activator:t(({props:p})=>[e(A,w(p,{size:"small",class:"tw-me-2",onClick:r=>ne(a.raw)}),{default:t(()=>[f("mdi-delete")]),_:2},1040,["onClick"])]),default:t(()=>[De]),_:2},1024)])])]),"no-data":t(()=>[o("div",Se,[z.value?(B(),I("h3",Ee,"Table is empty")):(B(),I(W,{key:1},[Ae,e(N,{color:"primary",onClick:l[10]||(l[10]=a=>L({page:1,itemsPerPage:k.value,clearFilters:!0}))},{default:t(()=>[f("Reset")]),_:1})],64))])]),_:1},8,["items-per-page","page","items-length","items","search","loading"])])]),_:1},8,["errors"])],64)}}};export{je as default};
