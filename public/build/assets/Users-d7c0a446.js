import{d as me}from"./index-532baf4b.js";import{K as _e,l as m,h as A,n as pe,T as X,r as n,o as x,f as O,a as e,u as c,w as l,F as Y,Z as fe,b as o,A as y,d as f,s as ve,t as B,c as ee,i as ge,g as te,O as be}from"./app-e3b52d3a.js";import{_ as he}from"./AuthenticatedLayout-be37f04c.js";import"./ApplicationLogo-8cab8e64.js";const we=(g,i="en-US")=>{const b=new Date(g);if(isNaN(b.getTime()))return"-";const v={year:"numeric",month:"2-digit",day:"2-digit"};return new Date(g).toLocaleDateString(i,v).replace(/\//g,".")},ye=(g,i="en-US",b=!1)=>{const v=new Date(g);if(isNaN(v.getTime()))return"-";const D={year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"};return b&&(D.second="2-digit"),new Date(g).toLocaleDateString(i,D).replace(/\//g,".")},ke=o("h2",{class:"tw-font-semibold tw-text-xl tw-text-gray-800 tw-leading-tight"},"Benutzer",-1),Ve={class:"tw-flex tw-items-center tw-justify-end"},Ue=o("span",{class:"tw-text-h5"},"Neuen Benutzer",-1),De=o("p",null,"Sind Sie sicher, dass Sie den aktuellen Benutzer löschen möchten?",-1),Ne={class:"tw-table-block tw-max-w-full tw-mx-auto tw-py-6 tw-px-4 sm:tw-px-6 lg:tw-px-8"},Se={class:"tw-bg-white tw-flex tw-justify-between tw-px-6 tw-py-6"},ze={class:"tw-w-full"},Pe={class:"tw-ml-6"},xe={align:"center"},Be=o("span",null,"Benutzer bearbeiten",-1),Ce=o("span",null,"Benutzer löschen",-1),Ee={class:"tw-py-6"},Fe={key:0,class:"tw-mb-4"},Te=o("h3",{class:"tw-mb-4"},"Die Tabelle ist leer. Bitte setzen Sie die Suchfilter zurück.",-1),Le={__name:"Users",props:{items:Array,currentPage:Number,perPage:Number,lastPage:Number,total:Number,paging:Boolean,orderBy:String,sort:String,filters:Object,errors:Object,roles:Array},setup(g){const i=g;me.Inertia.on("success",s=>{let t=s.detail.page.props;s.detail.page.component==="Users/Users"&&t&&(b.value=t.currentPage,v.value=t.perPage,D.value=t.orderBy,j.value=t.sort,L.value=t.total,le.value=t.lastPage,k.value=t.filters.full_name??null,V.value=t.filters.email??null)}),_e().props.auth.user;const b=m(i.currentPage),v=m(i.perPage),D=m(i.orderBy),j=m(i.sort),L=m(i.total),le=m(i.lastPage),k=m(i.filters.full_name??null),V=m(i.filters.email??null),q=m(""),h=m(i.errors||{}),F=m(!1),C=m(!1),E=m(!1),ae=[{title:"Status",key:"is_online",width:"5%",sortable:!1,align:"center"},{title:"Name",key:"first_name",width:"25%",sortable:!1},{title:"Email",key:"email",width:"20%",sortable:!1},{title:"Rolle",key:"primary_role_name",width:"10%",sortable:!1},{title:"Letzter Login",key:"last_seen_at",width:"15%",sortable:!1},{title:"Erster Login",key:"first_login_at",width:"15%",sortable:!1},{title:"Aktionen",key:"actions",width:"10%",sortable:!1}],se=A(()=>i.items.map(s=>{const t={...s};for(const _ in t)(t[_]===null||t[_]===void 0)&&(t[_]="-");return t})),I=A(()=>k.value===null&&V.value===null),oe=A(()=>k.value!==null||V.value!==null);pe(C,s=>{s||S()});const Z=async({page:s,itemsPerPage:t,sortBy:_,clearFilters:w})=>{if(w&&(k.value=null,V.value=null),s===b.value&&w||I||oe){F.value=!0;let d={data:{page:s,per_page:t}};_&&_.length>0&&(d.data.order_by=_[0].key,d.data.sort=_[0].order),d.data.full_name=k.value,d.data.email=V.value,await be.reload(d),b.value=s,v.value=t,F.value=!1}},ne=s=>{N.id=s.id,E.value=!0},N=X({id:null}),re=async()=>{N.processing=!0;let s={onSuccess:t=>{S()},onError:t=>{h.value=t},onFinish:()=>{N.processing=!1}};N.delete(route("users.destroy",{id:N.id}),s)},S=()=>{C.value=!1,E.value=!1,u.reset(),u.clearErrors(),h.value={}},u=X({first_name:null,last_name:null,email:null,role:null,two_factor_auth_enabled:!1}),ue=async()=>{u.processing=!0;let s={onSuccess:t=>{S()},onError:t=>{h.value=t},onFinish:()=>{u.processing=!1}};u.post(route("users.store"),s)};return(s,t)=>{const _=n("v-card-title"),w=n("v-text-field"),d=n("v-col"),z=n("v-row"),ie=n("v-select"),de=n("v-checkbox"),R=n("v-container"),K=n("v-card-text"),G=n("v-spacer"),P=n("v-btn"),U=n("v-hover"),H=n("v-btn-primary"),J=n("v-card-actions"),M=n("v-card"),Q=n("v-dialog"),T=n("v-icon"),W=n("v-tooltip"),ce=n("v-data-table-server");return x(),O(Y,null,[e(c(fe),{title:"Benutzer"}),e(he,{errors:h.value},{header:l(()=>[ke,o("div",Ve,[e(U,null,{default:l(({isHovering:a,props:p})=>[e(P,y(p,{color:a?"accent":"primary",dark:""}),{default:l(()=>[f(" Neuen Benutzer hinzufügen "),e(Q,{modelValue:C.value,"onUpdate:modelValue":t[5]||(t[5]=r=>C.value=r),activator:"parent",width:"80vw"},{default:l(()=>[e(M,{height:"80vh"},{default:l(()=>[e(_,null,{default:l(()=>[Ue]),_:1}),e(K,null,{default:l(()=>[e(R,null,{default:l(()=>[e(z,null,{default:l(()=>[e(d,{cols:"12",sm:"6"},{default:l(()=>[e(w,{modelValue:c(u).first_name,"onUpdate:modelValue":t[0]||(t[0]=r=>c(u).first_name=r),"error-messages":h.value.first_name,label:"Vorname",required:""},null,8,["modelValue","error-messages"])]),_:1}),e(d,{cols:"12",sm:"6"},{default:l(()=>[e(w,{modelValue:c(u).last_name,"onUpdate:modelValue":t[1]||(t[1]=r=>c(u).last_name=r),"error-messages":h.value.last_name,label:"Nachname",required:""},null,8,["modelValue","error-messages"])]),_:1})]),_:1}),e(z,null,{default:l(()=>[e(d,{cols:"12",sm:"6"},{default:l(()=>[e(w,{modelValue:c(u).email,"onUpdate:modelValue":t[2]||(t[2]=r=>c(u).email=r),"error-messages":h.value.email,label:"Email",required:""},null,8,["modelValue","error-messages"])]),_:1}),e(d,{cols:"12",sm:"6"},{default:l(()=>[e(ie,{modelValue:c(u).role,"onUpdate:modelValue":t[3]||(t[3]=r=>c(u).role=r),items:g.roles,"error-messages":h.value.role,"item-title":"human_name","item-value":"id",label:"Role",required:""},null,8,["modelValue","items","error-messages"])]),_:1})]),_:1}),e(z,null,{default:l(()=>[e(d,{cols:"12",md:"4",sm:"6"},{default:l(()=>[e(de,{modelValue:c(u).two_factor_auth_enabled,"onUpdate:modelValue":t[4]||(t[4]=r=>c(u).two_factor_auth_enabled=r),label:"Zwei-Faktor-Authentifizierung",value:!0},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),e(J,null,{default:l(()=>[e(G),e(U,null,{default:l(({isHovering:r,props:$})=>[e(P,y({onClick:S},$,{color:r?"accent":"primary"}),{default:l(()=>[f("Abbrechen")]),_:2},1040,["color"])]),_:2},1024),e(U,null,{default:l(({isHovering:r,props:$})=>[e(H,y({onClick:ue},$,{color:r?"accent":"primary"}),{default:l(()=>[f("Speichern")]),_:2},1040,["color"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1032,["modelValue"])]),_:2},1040,["color"])]),_:1})]),e(Q,{modelValue:E.value,"onUpdate:modelValue":t[6]||(t[6]=a=>E.value=a),activator:"parent",width:"20vw"},{default:l(()=>[e(M,{height:"30vh"},{default:l(()=>[e(K,null,{default:l(()=>[e(R,null,{default:l(()=>[e(z,null,{default:l(()=>[e(d,{cols:"12"},{default:l(()=>[De]),_:1})]),_:1})]),_:1})]),_:1}),e(J,null,{default:l(()=>[e(G),e(U,null,{default:l(({isHovering:a,props:p})=>[e(P,y({onClick:S},p,{color:a?"accent":"primary"}),{default:l(()=>[f("Abbrechen")]),_:2},1040,["color"])]),_:1}),e(U,null,{default:l(({isHovering:a,props:p})=>[e(H,y({onClick:re},p,{color:a?"accent":"primary"}),{default:l(()=>[f("Löschen")]),_:2},1040,["color"])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),default:l(()=>[o("div",Ne,[o("div",Se,[o("div",ze,[e(z,null,{default:l(()=>[e(d,{cols:"12",sm:"3"},{default:l(()=>[e(w,{modelValue:k.value,"onUpdate:modelValue":t[7]||(t[7]=a=>k.value=a),label:"Name"},null,8,["modelValue"])]),_:1}),e(d,{cols:"12",sm:"3"},{default:l(()=>[e(w,{modelValue:V.value,"onUpdate:modelValue":t[8]||(t[8]=a=>V.value=a),label:"Email"},null,8,["modelValue"])]),_:1})]),_:1})]),o("div",Pe,[e(U,null,{default:l(({isHovering:a,props:p})=>[e(P,y({class:"tw-mt-2"},p,{color:a?"accent":"primary",onClick:t[9]||(t[9]=r=>q.value=String(Date.now())),dark:""}),{default:l(()=>[f("Suche")]),_:2},1040,["color"])]),_:1})])]),e(ce,{"items-per-page":v.value,"onUpdate:itemsPerPage":t[11]||(t[11]=a=>v.value=a),headers:ae,page:b.value,"items-length":L.value,items:se.value,search:q.value,loading:F.value,class:"data-table-container elevation-1","item-value":"name","onUpdate:options":Z},{item:l(({item:a})=>[o("tr",null,[o("td",xe,[e(T,{size:"medium",class:ve({active:a.selectable.is_online})},{default:l(()=>[f("mdi-circle")]),_:2},1032,["class"])]),o("td",null,B(a.selectable.full_name),1),o("td",null,B(a.selectable.email),1),o("td",null,B(a.selectable.primary_role_human_name),1),o("td",null,B(!a.selectable.last_seen_at||a.selectable.last_seen_at==="-"?a.selectable.last_seen_at:c(ye)(a.selectable.last_seen_at,"sv-SE")),1),o("td",null,B(!a.selectable.first_login_at||a.selectable.first_login_at==="-"?a.selectable.first_login_at:c(we)(a.selectable.first_login_at,"fr-CA")),1),o("td",null,[s.$page.props.auth.user.is_super_admin||s.$page.props.auth.user.is_admin&&!a.selectable.is_super_admin&&!a.selectable.is_admin||s.$page.props.auth.user.is_admin&&s.$page.props.auth.user.id===a.selectable.id?(x(),ee(W,{key:0,location:"top"},{activator:l(({props:p})=>[e(c(ge),{href:s.route("users.edit",{id:a.selectable.id})},{default:l(()=>[e(T,y(p,{size:"small",class:"tw-me-2"}),{default:l(()=>[f("mdi-pencil")]),_:2},1040)]),_:2},1032,["href"])]),default:l(()=>[Be]),_:2},1024)):te("",!0),s.$page.props.auth.user.is_super_admin||s.$page.props.auth.user.is_admin&&!a.selectable.is_super_admin&&!a.selectable.is_admin?(x(),ee(W,{key:1,location:"top"},{activator:l(({props:p})=>[e(T,y(p,{size:"small",class:"tw-me-2",onClick:r=>ne(a.raw)}),{default:l(()=>[f("mdi-delete")]),_:2},1040,["onClick"])]),default:l(()=>[Ce]),_:2},1024)):te("",!0)])])]),"no-data":l(()=>[o("div",Ee,[I.value?(x(),O("h3",Fe,"Die Tabelle ist leer.")):(x(),O(Y,{key:1},[Te,e(P,{color:"primary",onClick:t[10]||(t[10]=a=>Z({page:1,itemsPerPage:v.value,clearFilters:!0}))},{default:l(()=>[f("Zurücksetzen")]),_:1})],64))])]),_:1},8,["items-per-page","page","items-length","items","search","loading"])])]),_:1},8,["errors"])],64)}}};export{Le as default};
