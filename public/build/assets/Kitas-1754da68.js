import{K as xe,j as p,k as oe,l as C,A as ge,T as be,r as c,o as w,f as q,a as e,u as d,w as l,F as se,Z as Ae,b as i,c as L,m as b,d as V,h as D,t as N,i as De,O as Ke}from"./app-df813ddc.js";import{d as je}from"./index-3b33a1cb.js";import{_ as qe}from"./AuthenticatedLayout-1f1c3f3b.js";import"./ApplicationLogo-c2db0697.js";const Be=i("h2",{class:"tw-font-semibold tw-text-xl tw-text-gray-800 tw-leading-tight"},"Einrichtungen",-1),Oe={class:"tw-flex tw-items-center tw-justify-end"},Ie=i("span",{class:"tw-text-h5"},"Verwalte Einrichtung",-1),Je=i("h4",null,"Adresse",-1),Me=i("h4",null,"Eigenschaften",-1),Ye={class:"tw-table-block tw-max-w-full tw-mx-auto tw-py-6 tw-px-4 sm:tw-px-6 lg:tw-px-8"},Ze={key:0,class:"tw-bg-white tw-flex tw-justify-between tw-px-6 tw-py-6"},Re={class:"tw-w-full"},Ge={key:1},He=i("span",null,"Schreibe E-Mail an Auswahl",-1),Le=["data-id","data-order"],Qe={class:"text-center"},We=["href"],Xe=i("span",null,"Schreibe E-Mail",-1),el=i("span",null,"Einrichtung bearbeiten",-1),ll=i("span",null,"Einrichtung löschen",-1),al={class:"tw-py-6"},tl={key:0,class:"tw-mb-4"},ol=i("h3",{class:"tw-mb-4"},"Die Tabelle ist leer. Bitte setzen Sie die Suchfilter zurück.",-1),sl=i("span",{class:"tw-text-h5"},"Schreibe E-Mail an Auswahl",-1),pl={__name:"Kitas",props:{items:Array,currentPage:Number,perPage:Number,lastPage:Number,total:Number,paging:Boolean,orderBy:String,sort:String,filters:Object,errors:Object,types:Array,zipCodes:Array,operators:Array,usersEmails:Array},setup(x){var pe,me,ce,ve,_e,fe;const v=x;je.Inertia.on("success",o=>{let t=o.detail.page.props;o.detail.page.component==="Kitas/Kitas"&&t&&(M.value=t.currentPage,B.value=t.perPage,he.value=t.orderBy,ye.value=t.sort,re.value=t.total,Ve.value=t.lastPage)});const K=xe().props.auth.user??{},M=p(v.currentPage),B=p(v.perPage),he=p(v.orderBy),ye=p(v.sort),re=p(v.total),Ve=p(v.lastPage),k=p(((pe=v.filters)==null?void 0:pe.search)??null),E=p(((me=v.filters)==null?void 0:me.has_yearly_evaluations)??null),S=p(((ce=v.filters)==null?void 0:ce.approved)??null),P=p(null),U=p(((ve=v.filters)==null?void 0:ve.other_operator)??null),z=p(((_e=v.filters)==null?void 0:_e.type)??null),F=p(((fe=v.filters)==null?void 0:fe.zip_code)??null),ue=p(""),_=p(v.errors||{}),O=p([]),f=p(!1),Y=p(!1),Z=p(!1),R=p(!1),ne=p(null),we=[{title:"Ja",value:"true"},{title:"Nein",value:"false"}],ke=[{title:"Ja",value:"true"},{title:"Nein",value:"false"}],Ee=[{title:"Name",key:"name",width:"15%",sortable:!0},{title:`Jährliche Rückmeldung ${new Date().getFullYear()} abgeschlossen`,key:"has_yearly_evaluations",width:"25%",sortable:!0},{title:"Zugelassen",key:"approved",width:"10%",sortable:!0},{title:"Träger",key:"operator_id",width:"10%",sortable:!0},{title:"Sonstiger Träger",key:"other_operator",width:"10%",sortable:!0},{title:"Typ",key:"type",width:"10%",sortable:!0},{title:"Postleitzahl",key:"zip_code",width:"10%",sortable:!0},{title:"Aktion",key:"actions",width:"10%",sortable:!1,align:"center"}],Se=oe(()=>v.items.map(o=>{const t={...o};for(const h in t)(t[h]===null||t[h]===void 0)&&(t[h]="-");return t})),de=oe(()=>k.value===null&&E.value===null&&S.value===null&&P.value===null&&U.value===null&&z.value===null&&F.value===null),Pe=oe(()=>k.value!==null||E.value!==null||S.value!==null||P.value!==null||U.value!==null||z.value!==null||F.value!==null);C(Y,o=>{o||j()}),C(k,ge.debounce(o=>{A()},500)),C(E,o=>{A()}),C(S,o=>{A()}),C(P,o=>{A()}),C(U,ge.debounce(o=>{A()},500)),C(z,o=>{A()}),C(F,o=>{A()});const Ue=()=>{Z.value=!0,O.value=v.usersEmails.map(o=>o.value)},A=()=>{f.value=!0,ue.value=String(Date.now())},ie=async({page:o,itemsPerPage:t,sortBy:h,clearFilters:n})=>{if(n&&(k.value=null,E.value=null,S.value=null,P.value=null,U.value=null,z.value=null,F.value=null),o===M.value&&n||de||Pe){f.value=!0;let u={page:o,per_page:t};h&&h.length>0?(u.order_by=h[0].key,u.sort=h[0].order):(u.order_by=null,u.sort=null),k.value&&(u.search=k.value),E.value&&(u.has_yearly_evaluations=E.value),S.value&&(u.approved=S.value),P.value&&(u.operator_id=P.value),U.value&&(u.other_operator=U.value),z.value&&(u.type=z.value),F.value&&(u.zip_code=F.value),await Ke.get(route(route().current()),u,{preserveScroll:!0,preserveState:!0,onCancelToken:m=>{},onCancel:()=>{},onBefore:m=>{f.value=!0},onStart:m=>{},onProgress:m=>{},onSuccess:m=>{M.value=u.page,B.value=u.per_page},onError:m=>{console.log(m)},onFinish:m=>{f.value=!1}})}},ze=o=>{ne.value=o.name,I.id=o.id,R.value=!0},I=be({id:null}),Fe=async()=>{I.processing=!0;let o={onSuccess:t=>{j()},onError:t=>{j(),_.value=t},onFinish:()=>{I.processing=!1}};I.delete(route("kitas.destroy",{id:I.id}),o)},j=()=>{Y.value=!1,R.value=!1,Z.value=!1,r.reset(),r.clearErrors(),_.value={}},Te=()=>{r.reset(),r.clearErrors()},r=be({name:null,number:null,street:null,house_number:null,city:null,additional_info:null,zip_code:null,operator_id:null,other_operator:null,num_pedagogical_staff:null,approved:(K==null?void 0:K.is_super_admin)||(K==null?void 0:K.is_admin),type:null}),$e=async()=>{r.processing=!0,r.post(route("kitas.store"),{onSuccess:o=>{j()},onError:o=>{_.value=o},onFinish:()=>{r.processing=!1}})};return(o,t)=>{const h=c("v-card-title"),n=c("v-col"),u=c("v-row"),m=c("v-text-field"),T=c("v-select"),Ce=c("v-checkbox"),Q=c("v-container"),W=c("v-card-text"),G=c("v-btn-primary"),$=c("v-hover"),X=c("v-spacer"),J=c("v-btn"),ee=c("v-card-actions"),le=c("v-card"),ae=c("v-dialog"),H=c("v-icon"),te=c("v-tooltip"),Ne=c("v-data-table-server");return w(),q(se,null,[e(d(Ae),{title:"Einrichtungen"}),e(qe,{errors:_.value},{header:l(()=>[Be,i("div",Oe,[o.$page.props.auth.user.is_manager?D("",!0):(w(),L($,{key:0},{default:l(({isHovering:a,props:g})=>[e(J,b(g,{color:a?"accent":"primary",dark:""}),{default:l(()=>[V(" Anlegen "),e(ae,{modelValue:Y.value,"onUpdate:modelValue":t[12]||(t[12]=s=>Y.value=s),activator:"parent",width:"80vw"},{default:l(()=>[e(le,{height:"80vh"},{default:l(()=>[e(h,null,{default:l(()=>[Ie]),_:1}),e(W,null,{default:l(()=>[e(Q,null,{default:l(()=>[e(u,null,{default:l(()=>[e(n,{cols:"12"},{default:l(()=>[Je]),_:1})]),_:1}),e(u,null,{default:l(()=>[e(n,{cols:"12",sm:"6"},{default:l(()=>[e(m,{modelValue:d(r).name,"onUpdate:modelValue":t[0]||(t[0]=s=>d(r).name=s),"error-messages":_.value.name,label:"Name der Einrichtung / Einrichtung*",required:""},null,8,["modelValue","error-messages"])]),_:1}),e(n,{cols:"12",sm:"6"},{default:l(()=>[e(m,{modelValue:d(r).number,"onUpdate:modelValue":t[1]||(t[1]=s=>d(r).number=s),"error-messages":_.value.number,label:"KiTa Nummer*",required:""},null,8,["modelValue","error-messages"])]),_:1})]),_:1}),e(u,null,{default:l(()=>[e(n,{cols:"12",sm:"6"},{default:l(()=>[e(m,{modelValue:d(r).street,"onUpdate:modelValue":t[2]||(t[2]=s=>d(r).street=s),"error-messages":_.value.street,label:"Straße*",required:""},null,8,["modelValue","error-messages"])]),_:1}),e(n,{cols:"12",sm:"6"},{default:l(()=>[e(m,{modelValue:d(r).house_number,"onUpdate:modelValue":t[3]||(t[3]=s=>d(r).house_number=s),"error-messages":_.value.house_number,label:"Hausnummer*",required:""},null,8,["modelValue","error-messages"])]),_:1})]),_:1}),e(u,null,{default:l(()=>[e(n,{cols:"12"},{default:l(()=>[e(m,{modelValue:d(r).additional_info,"onUpdate:modelValue":t[4]||(t[4]=s=>d(r).additional_info=s),"error-messages":_.value.additional_info,label:"Sonstiges",required:""},null,8,["modelValue","error-messages"])]),_:1})]),_:1}),e(u,null,{default:l(()=>[e(n,{cols:"12",sm:"6"},{default:l(()=>[e(m,{modelValue:d(r).zip_code,"onUpdate:modelValue":t[5]||(t[5]=s=>d(r).zip_code=s),"error-messages":_.value.zip_code,label:"Postleitzahl*",type:"number",required:""},null,8,["modelValue","error-messages"])]),_:1}),e(n,{cols:"12",sm:"6"},{default:l(()=>[e(m,{modelValue:d(r).city,"onUpdate:modelValue":t[6]||(t[6]=s=>d(r).city=s),"error-messages":_.value.city,label:"Stadt*",required:""},null,8,["modelValue","error-messages"])]),_:1})]),_:1}),e(u,null,{default:l(()=>[e(n,{cols:"12"},{default:l(()=>[Me]),_:1})]),_:1}),e(u,null,{default:l(()=>[e(n,{cols:"12",sm:"4"},{default:l(()=>[e(T,{modelValue:d(r).operator_id,"onUpdate:modelValue":t[7]||(t[7]=s=>d(r).operator_id=s),items:x.operators,"error-messages":_.value.operator_id,"item-title":"name","item-value":"id",label:"Träger der Einrichtung*",required:""},null,8,["modelValue","items","error-messages"])]),_:1}),e(n,{cols:"12",sm:"4"},{default:l(()=>[e(m,{modelValue:d(r).other_operator,"onUpdate:modelValue":t[8]||(t[8]=s=>d(r).other_operator=s),"error-messages":_.value.other_operator,label:"Sonstiger Träger",disabled:o.$page.props.auth.user.is_user_multiplier||d(r).operator_id},null,8,["modelValue","error-messages","disabled"])]),_:2},1024),e(n,{cols:"12",sm:"4"},{default:l(()=>[e(m,{modelValue:d(r).num_pedagogical_staff,"onUpdate:modelValue":t[9]||(t[9]=s=>d(r).num_pedagogical_staff=s),"error-messages":_.value.num_pedagogical_staff,label:"Größe pädagogisches Team",type:"number"},null,8,["modelValue","error-messages"])]),_:1})]),_:2},1024),e(u,null,{default:l(()=>[o.$page.props.auth.user.is_super_admin||o.$page.props.auth.user.is_admin?(w(),L(n,{key:0,cols:"12",sm:"6"},{default:l(()=>[e(Ce,{modelValue:d(r).approved,"onUpdate:modelValue":t[10]||(t[10]=s=>d(r).approved=s),label:"KiTa zur Ampel zugelassen",value:!0},null,8,["modelValue"])]),_:1})):D("",!0),e(n,{cols:"12",sm:"6"},{default:l(()=>[e(T,{modelValue:d(r).type,"onUpdate:modelValue":t[11]||(t[11]=s=>d(r).type=s),items:x.types,"error-messages":_.value.type,label:"Größe der Einrichtung (1-10: klein, 11+: groß)*",required:""},null,8,["modelValue","items","error-messages"])]),_:1})]),_:2},1024)]),_:2},1024)]),_:2},1024),e(ee,null,{default:l(()=>[e($,null,{default:l(({isHovering:s,props:y})=>[e(G,b({onClick:Te},y,{color:s?"accent":"primary"}),{default:l(()=>[V("Zurücksetzen")]),_:2},1040,["color"])]),_:2},1024),e(X),e($,null,{default:l(({isHovering:s,props:y})=>[e(J,b({onClick:j},y,{color:s?"accent":"primary"}),{default:l(()=>[V("Stornieren")]),_:2},1040,["color"])]),_:2},1024),e($,null,{default:l(({isHovering:s,props:y})=>[e(G,b({onClick:$e},y,{color:s?"accent":"primary"}),{default:l(()=>[V("Speichern")]),_:2},1040,["color"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1032,["modelValue"])]),_:2},1040,["color"])]),_:1}))]),e(ae,{modelValue:R.value,"onUpdate:modelValue":t[13]||(t[13]=a=>R.value=a),width:"20vw"},{default:l(()=>[e(le,{height:"30vh"},{default:l(()=>[e(W,null,{default:l(()=>[e(Q,null,{default:l(()=>[e(u,null,{default:l(()=>[e(n,{cols:"12"},{default:l(()=>[i("p",null,"Sind Sie sicher, dass Sie die Einrichtung "+N(ne.value)+" löschen möchten?",1)]),_:1})]),_:1})]),_:1})]),_:1}),e(ee,null,{default:l(()=>[e(X),e($,null,{default:l(({isHovering:a,props:g})=>[e(J,b({onClick:j},g,{color:a?"accent":"primary"}),{default:l(()=>[V("Abbrechen")]),_:2},1040,["color"])]),_:1}),e($,null,{default:l(({isHovering:a,props:g})=>[e(G,b({onClick:Fe},g,{color:a?"accent":"primary"}),{default:l(()=>[V("Löschen")]),_:2},1040,["color"])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),default:l(()=>[i("div",Ye,[o.$page.props.auth.user.is_super_admin||o.$page.props.auth.user.is_admin?(w(),q("div",Ze,[i("div",Re,[e(u,null,{default:l(()=>[e(n,{cols:"12",sm:"4"},{default:l(()=>[e(m,{modelValue:k.value,"onUpdate:modelValue":t[14]||(t[14]=a=>k.value=a),label:"Suchen",disabled:f.value,clearable:""},null,8,["modelValue","disabled"])]),_:1}),e(n,{cols:"12",sm:"4"},{default:l(()=>[e(T,{modelValue:E.value,"onUpdate:modelValue":t[15]||(t[15]=a=>E.value=a),items:we,label:`Jährliche Rückmeldung ${new Date().getFullYear()} abgeschlossen`,multiple:"",disabled:f.value,clearable:""},null,8,["modelValue","label","disabled"])]),_:1}),e(n,{cols:"12",sm:"4"},{default:l(()=>[e(T,{modelValue:S.value,"onUpdate:modelValue":t[16]||(t[16]=a=>S.value=a),items:ke,label:"Zugelassen",multiple:"",disabled:f.value,clearable:""},null,8,["modelValue","disabled"])]),_:1})]),_:1}),e(u,null,{default:l(()=>[e(n,{cols:"12",sm:"6"},{default:l(()=>[e(T,{modelValue:P.value,"onUpdate:modelValue":t[17]||(t[17]=a=>P.value=a),items:x.operators,"item-title":"name","item-value":"id",label:"Träger",multiple:"",disabled:f.value,clearable:""},null,8,["modelValue","items","disabled"])]),_:1}),e(n,{cols:"12",sm:"6"},{default:l(()=>[e(m,{modelValue:U.value,"onUpdate:modelValue":t[18]||(t[18]=a=>U.value=a),label:"Sonstiger Träger",disabled:f.value,clearable:""},null,8,["modelValue","disabled"])]),_:1})]),_:1}),e(u,null,{default:l(()=>[e(n,{cols:"12",sm:"6"},{default:l(()=>[e(T,{modelValue:z.value,"onUpdate:modelValue":t[19]||(t[19]=a=>z.value=a),items:x.types,label:"Typ",multiple:"",disabled:f.value,clearable:""},null,8,["modelValue","items","disabled"])]),_:1}),e(n,{cols:"12",sm:"6"},{default:l(()=>[e(T,{modelValue:F.value,"onUpdate:modelValue":t[20]||(t[20]=a=>F.value=a),items:x.zipCodes,label:"Postleitzahl",multiple:"",disabled:f.value,clearable:""},null,8,["modelValue","items","disabled"])]),_:1})]),_:1})])])):D("",!0),o.$page.props.auth.user.is_super_admin||o.$page.props.auth.user.is_admin?(w(),q("div",Ge,[e(u,{class:"flex justify-end mb-4"},{default:l(()=>[e($,null,{default:l(({isHovering:a,props:g})=>[e(n,{cols:"12",sm:"4",class:"text-right"},{default:l(()=>[e(J,b(g,{color:a?"accent":"primary",dark:"",onClick:Ue}),{default:l(()=>[e(H,b(g,{size:"small",class:"tw-me-2"}),{default:l(()=>[V("mdi-email")]),_:2},1040),He]),_:2},1040,["color"])]),_:2},1024)]),_:1})]),_:1})])):D("",!0),e(Ne,{"items-per-page":B.value,"onUpdate:itemsPerPage":t[22]||(t[22]=a=>B.value=a),"items-per-page-options":[{value:10,title:"10"},{value:25,title:"25"},{value:50,title:"50"},{value:100,title:"100"},{value:-1,title:"$vuetify.dataFooter.itemsPerPageAll"}],"items-per-page-text":"Objekte pro Seite:",headers:Ee,page:M.value,"items-length":re.value,items:Se.value,search:ue.value,loading:f.value,class:"data-table-container elevation-1","item-value":"name","onUpdate:options":ie},{item:l(({item:a})=>{var g,s;return[i("tr",{"data-id":a.id,"data-order":a.order},[i("td",null,N(a==null?void 0:a.name),1),i("td",null,N(a!=null&&a.has_yearly_evaluations?"Ja":"Nein"),1),i("td",null,N(a!=null&&a.approved?"Ja":"Nein"),1),i("td",null,N(((g=a==null?void 0:a.operator)==null?void 0:g.name)??"-"),1),i("td",null,N(!((s=a==null?void 0:a.operator)!=null&&s.name)&&(a!=null&&a.other_operator)?a==null?void 0:a.other_operator:"-"),1),i("td",null,N((a==null?void 0:a.formatted_type)??(a==null?void 0:a.type)),1),i("td",null,N(a==null?void 0:a.zip_code),1),i("td",Qe,[o.$page.props.auth.user.is_super_admin||o.$page.props.auth.user.is_admin?(w(),q(se,{key:0},[a!=null&&a.approved&&(a==null?void 0:a.users_emails.length)>0?(w(),L(te,{key:0,location:"top"},{activator:l(({props:y})=>[i("a",b({href:`mailto:?bcc=${a==null?void 0:a.users_emails.join(",")}`},y),[e(H,b(y,{size:"small",class:"tw-me-2"}),{default:l(()=>[V("mdi-email")]),_:2},1040)],16,We)]),default:l(()=>[Xe]),_:2},1024)):D("",!0)],64)):D("",!0),e(te,{location:"top"},{activator:l(({props:y})=>[e(d(De),{href:o.route("kitas.show",{id:a.id})},{default:l(()=>[e(H,b(y,{size:"small",class:"tw-me-2"}),{default:l(()=>[V("mdi-pencil")]),_:2},1040)]),_:2},1032,["href"])]),default:l(()=>[el]),_:2},1024),!o.$page.props.auth.user.is_manager&&!o.$page.props.auth.user.is_user_multiplier?(w(),L(te,{key:1,location:"top"},{activator:l(({props:y})=>[e(H,b(y,{size:"small",class:"tw-me-2",onClick:rl=>ze(a)}),{default:l(()=>[V("mdi-delete")]),_:2},1040,["onClick"])]),default:l(()=>[ll]),_:2},1024)):D("",!0)])],8,Le)]}),"no-data":l(()=>[i("div",al,[de.value?(w(),q("h3",tl,"Die Tabelle ist leer.")):(w(),q(se,{key:1},[ol,e(J,{color:"primary",onClick:t[21]||(t[21]=a=>ie({page:1,itemsPerPage:B.value,clearFilters:!0}))},{default:l(()=>[V("Reset")]),_:1})],64))])]),_:1},8,["items-per-page","items-per-page-options","page","items-length","items","search","loading"])]),e(ae,{modelValue:Z.value,"onUpdate:modelValue":t[24]||(t[24]=a=>Z.value=a),width:"40vw"},{default:l(()=>[e(le,{height:"80vh"},{default:l(()=>[e(h,null,{default:l(()=>[sl]),_:1}),e(W,null,{default:l(()=>[e(Q,null,{default:l(()=>[e(u,null,{default:l(()=>[e(n,{cols:"12"},{default:l(()=>[e(T,{modelValue:O.value,"onUpdate:modelValue":t[23]||(t[23]=a=>O.value=a),items:x.usersEmails,label:"Benutzer",multiple:"",disabled:f.value,clearable:""},null,8,["modelValue","items","disabled"])]),_:1})]),_:1})]),_:1})]),_:1}),e(ee,null,{default:l(()=>[e(X),e($,null,{default:l(({isHovering:a,props:g})=>[e(G,b({href:`mailto:?bcc=${O.value.join(",")}`},g,{color:a?"accent":"primary",disabled:!O.value.length}),{default:l(()=>[V(" Öffnen Sie den Mail-Client ")]),_:2},1040,["href","color","disabled"])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["errors"])],64)}}};export{pl as default};
