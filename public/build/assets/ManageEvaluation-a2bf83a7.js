import{d as te}from"./index-5dddf9b0.js";import{K as ne,k as b,h as le,s as se,l as oe,T as M,m as re,r,o as k,f as R,a as e,u as i,w as a,F as ie,Z as ue,b as _,c as F,g as N,p as x,d as p,t as ce,v as de}from"./app-46e3f0f2.js";import{p as U,a as me}from"./common-326e1711.js";import{_ as ve}from"./AuthenticatedLayout-b9a282ad.js";import{_ as $}from"./EvaluationDomainsList-97d68782.js";import{v as _e}from"./v4-4a60fe23.js";import"./ApplicationLogo-502f85a3.js";const pe=_("h2",{class:"tw-font-semibold tw-text-xl tw-text-gray-800 tw-leading-tight"},"Auswertung erstellen",-1),fe={class:"tw-table-block tw-max-w-full tw-mx-auto tw-py-6 tw-px-4 sm:tw-px-6 lg:tw-px-8"},ge=_("h3",null,"Eigenschaften",-1),he={key:0,class:"tw-flex justify-center items-center tw-bg-white"},we={class:"tw-text-right"},be=["href"],ke={class:"tw-text-center"},xe=_("h1",{class:"tw-uppercase text-primary tw-font-black tw-text-xl tw-mb-8"}," Screening wurde eingereicht ",-1),ye=_("p",{class:"tw-mb-8"}," Folgendes Screening wurde eingereicht und kann nur bis 15 Minuten nach Einreichung bearbeitet werden. Danach verschwindet es aus Ihrer Übersicht. Sollten Sie es zurückziehen oder bearbeiten wollen, klicke Sie auf 'Abgabe zurückziehen. Nachfolgend erhalten Sie eine Übersicht des eingereichten Screenings, welches Sie über den Download-Button als PDF herunterladen können. ",-1),Ve=_("span",{class:"tw-font-black"},"Bezeichner des Screenings",-1),Be={__name:"ManageEvaluation",props:{evaluation:Object,kitas:Array,domains:Array,errors:Object},setup(y){const d=y;te.Inertia.on("success",s=>{s.detail.page.props,s.detail.page.component});const P=ne().props.auth.user??{},C=b(null),u=b(d.errors||{}),w=b(!1),z=b([]),V=b(!1),f=b(null),v=le(()=>!!d.evaluation);se(()=>{v.value||j()}),oe(()=>{v.value||A()});const A=()=>{C.value=_e(),t.uuid=C.value},j=()=>{t.ratings=U(d.domains)},D=()=>{u.value={},V.value=!1},O=()=>{t.reset(),t.clearErrors(),u.value={},t.ratings=U(d.domains),v.value||A()},t=M({uuid:v.value?d.evaluation.uuid:null,user_id:v.value?d.evaluation.user_id:P.id,kita_id:v.value?d.evaluation.kita_id:null,age:v.value?d.evaluation.age:null,is_daz:v.value?d.evaluation.is_daz:!1,ratings:v.value?d.evaluation.data:[]});re(()=>t.age,s=>{t.ratings=U(d.domains)});const K=s=>{t.ratings=s},T=s=>{z.value=de(s)?s.value:s},Z=async()=>{t.processing=!0,w.value=!0;let s=[];z.value.map(l=>(l.subdomains.map(c=>(c.milestones.map(g=>(s.push(parseInt(g.id)),g)),c)),l)),t.ratings=t.ratings.map(l=>(l.milestones.map(c=>(s.includes(parseInt(c.id))||(c.value=0),c)),l));let o={onSuccess:l=>{t.clearErrors(),u.value={},V.value=!0,f.value=l.props.data},onError:l=>{u.value=l},onFinish:()=>{t.processing=!1,w.value=!1}};v.value?t.put(route("evaluations.update",{evaluation:d.evaluation.id}),o):t.post(route("evaluations.store"),o)},q=async()=>{t.processing=!0,w.value=!0,t.post(route("evaluations.save"),{preserveState:!1,onSuccess:s=>{t.clearErrors(),u.value={}},onError:s=>{u.value=s},onFinish:()=>{t.processing=!1,w.value=!1}})},E=M({}),H=async s=>{E.processing=!0,E.post(route("evaluations.unfinished",{id:s}),{preserveState:!1,onSuccess:o=>{E.clearErrors(),u.value={},D()},onError:o=>{u.value=o},onFinish:()=>{E.processing=!1,w.value=!1}})};return(s,o)=>{const l=r("v-col"),c=r("v-row"),g=r("v-container"),G=r("v-text-field"),B=r("v-select"),J=r("v-checkbox"),L=r("v-progress-circular"),S=r("v-btn"),h=r("v-hover"),I=r("v-btn-primary"),Q=r("v-icon"),W=r("v-card-text"),X=r("v-spacer"),Y=r("v-card-actions"),ee=r("v-card"),ae=r("v-dialog");return k(),R(ie,null,[e(i(ue),{title:"Auswertung erstellen"}),e(ve,{errors:u.value},{header:a(()=>[pe]),default:a(()=>[_("div",fe,[e(g,null,{default:a(()=>[e(c,null,{default:a(()=>[e(l,{cols:"12"},{default:a(()=>[ge]),_:1})]),_:1})]),_:1}),e(g,null,{default:a(()=>[e(c,null,{default:a(()=>[e(l,{cols:"12",sm:"3"},{default:a(()=>[e(G,{modelValue:i(t).uuid,"onUpdate:modelValue":o[0]||(o[0]=n=>i(t).uuid=n),"error-messages":u.value.uuid,readonly:"",label:"Bezeichner der Einschatzung",required:""},null,8,["modelValue","error-messages"])]),_:1}),e(l,{cols:"12",sm:"3"},{default:a(()=>[e(B,{modelValue:i(t).age,"onUpdate:modelValue":o[1]||(o[1]=n=>i(t).age=n),items:i(me),"error-messages":u.value.age,"item-title":"age_name","item-value":"age_number",label:"Altersgruppe"},null,8,["modelValue","items","error-messages"])]),_:1}),e(l,{cols:"12",sm:"3"},{default:a(()=>[e(B,{modelValue:i(t).kita_id,"onUpdate:modelValue":o[2]||(o[2]=n=>i(t).kita_id=n),items:y.kitas,"error-messages":u.value.kita_id,"item-title":"name","item-value":"id",label:"Kita"},null,8,["modelValue","items","error-messages"])]),_:1}),e(l,{cols:"12",sm:"3"},{default:a(()=>[e(J,{modelValue:i(t).is_daz,"onUpdate:modelValue":o[3]||(o[3]=n=>i(t).is_daz=n),label:"Deutsch ist nicht Muttersprache"},null,8,["modelValue"])]),_:1})]),_:1}),e(c,{class:"manage-evaluation-domains"},{default:a(()=>[i(t).age?(k(),F($,{key:0,ratings:i(t).ratings,age:i(t).age,domains:y.domains,errors:u.value,onUpdateRatingData:K,onUpdateDomainsData:T},null,8,["ratings","age","domains","errors"])):N("",!0)]),_:1})]),_:1}),e(g,null,{default:a(()=>[w.value?(k(),R("div",he,[e(L,{indeterminate:"",size:40})])):(k(),F(c,{key:1},{default:a(()=>[e(l,{cols:"12",sm:"6"},{default:a(()=>[e(h,null,{default:a(({isHovering:n,props:m})=>[e(S,x({onClick:O},m,{color:n?"primary":"accent"}),{default:a(()=>[p(" Zurücksetzen ")]),_:2},1040,["color"])]),_:1})]),_:1}),e(l,{cols:"12",sm:"6",align:"right"},{default:a(()=>[e(h,null,{default:a(({isHovering:n,props:m})=>[e(S,x({class:"mr-2",onClick:q,variant:"text"},m,{color:n?"accent":"primary"}),{default:a(()=>[p(" Speichern ")]),_:2},1040,["color"])]),_:1}),i(t).age&&z.value.length>0?(k(),F(h,{key:0},{default:a(({isHovering:n,props:m})=>[e(I,x({onClick:Z},m,{color:n?"accent":"primary"}),{default:a(()=>[p(" Prüfen und Einreichen ")]),_:2},1040,["color"])]),_:1})):N("",!0)]),_:1})]),_:1}))]),_:1})]),e(ae,{modelValue:V.value,"onUpdate:modelValue":o[6]||(o[6]=n=>V.value=n),width:"95vw"},{default:a(()=>[e(ee,{height:"95vh"},{default:a(()=>[e(W,null,{default:a(()=>[e(g,null,{default:a(()=>[e(c,{class:"result-evaluation-domains"},{default:a(()=>[e(l,{cols:"12"},{default:a(()=>[e(h,null,{default:a(({isHovering:n,props:m})=>[_("div",we,[_("a",{href:s.route("evaluations.pdf",{id:f.value.item.id}),onClick:D,title:"Fenster schließen"},[e(Q,x(m,{size:"small",class:"tw-me-2",onClick:o[4]||(o[4]=()=>{})}),{default:a(()=>[p("mdi-close")]),_:2},1040)],8,be)])]),_:1})]),_:1})]),_:1}),e(c,{class:"result-evaluation-domains"},{default:a(()=>[e(l,{cols:"8",offset:"2"},{default:a(()=>[_("div",ke,[xe,ye,e(h,null,{default:a(({isHovering:n,props:m})=>[e(S,{href:s.route("evaluations.pdf",{id:f.value.item.id}),class:"tw-px-2 tw-py-3 tw-mb-4 tw-mr-4 tw-normal-case",color:n?"primary":"accent"},{default:a(()=>[p(" Screening als PDF downloaden ")]),_:2},1032,["href","color"])]),_:1}),e(h,null,{default:a(({isHovering:n,props:m})=>[e(S,{onClick:o[5]||(o[5]=Ee=>H(f.value.item.id)),class:"tw-px-2 tw-py-3 tw-mb-4 tw-normal-case",color:n?"accent":"primary"},{default:a(()=>[p(" Abgabe zurückziehen ")]),_:2},1032,["color"])]),_:1})])]),_:1}),e(l,{cols:"12"},{default:a(()=>[_("p",null,[Ve,p(": "+ce(`${f.value.item.kita.formatted_name}_${f.value.item.uuid}`),1)])]),_:1}),e(l,{cols:"12"},{default:a(()=>[e($,{ratings:f.value.item.data,age:i(t).age,domains:y.domains,disabled:!0},null,8,["ratings","age","domains"])]),_:1})]),_:1})]),_:1})]),_:1}),e(Y,null,{default:a(()=>[e(X),e(h,null,{default:a(({isHovering:n,props:m})=>[e(I,x({onClick:D},m,{color:n?"accent":"primary"}),{default:a(()=>[p("Abbrechen")]),_:2},1040,["color"])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["errors"])],64)}}};export{Be as default};
