import{d as ke}from"./index-669f99da.js";import{K as ze,k as h,h as G,m as Ve,T as te,r as d,n as Se,f as S,a as e,u as r,w as a,F as re,o as b,Z as De,b as _,p as k,d as w,c as I,g as V,t as g,q as Ke,i as Ae,O as Pe}from"./app-c1b78740.js";import{_ as Ee}from"./AuthenticatedLayout-3fec963a.js";import{W as F}from"./WarningEvaluationTooltip-c796a7ec.js";import"./ApplicationLogo-bb68a240.js";const xe=_("h2",{class:"tw-font-semibold tw-text-xl tw-text-gray-800 tw-leading-tight"},"Jährliche Rückmeldung",-1),Ue={class:"tw-flex tw-items-center tw-justify-end"},Je=_("span",{class:"tw-text-h5"},"Jährliche Rückmeldung erstellen",-1),Ie=_("h3",null,"Rückmeldung betrifft",-1),Be=_("h3",null,"Angaben zur Rückmeldung",-1),Ne=_("h5",null,"Kinder bis 2,5 Jahre",-1),Te=_("h5",null,"Kinder bis 4,5 Jahre",-1),Ye=_("h4",null,"Wir haben eine Abweichung zwischen der Anzahl der von Ihnen gemeldeten Kinder und der Anzahl über die BeoKiz-Ampel erfassten Kindern festgestellt:",-1),Ce={class:"tw-flex tw-items-center tw-mt-2"},Fe={style:{"list-style-type":"disc","margin-left":"25px"}},qe={key:0},We={key:1},Re={key:2},Oe={key:3},Ze={class:"tw-table-block tw-max-w-full tw-mx-auto tw-py-6 tw-px-4 sm:tw-px-6 lg:tw-px-8"},je=["data-id","data-order"],He={align:"center"},$e=_("span",null,"Jährliche Rückmeldung bearbeiten",-1),Ge=_("span",null,"Jährliche Rückmeldung löschen",-1),Le={class:"tw-py-6"},Me={key:0,class:"tw-mb-4"},Qe=_("h3",{class:"tw-mb-4"},"Die Tabelle ist leer. Bitte setzen Sie die Suchfilter zurück.",-1),ra={__name:"YearlyEvaluations",props:{items:Array,currentPage:Number,perPage:Number,lastPage:Number,total:Number,paging:Boolean,orderBy:String,sort:String,filters:Object,errors:Object,kitas:Array,evaluationsWithDaz2TotalPerYear:Number,evaluationsWithDaz4TotalPerYear:Number,evaluationsWithoutDaz2TotalPerYear:Number,evaluationsWithoutDaz4TotalPerYear:Number},setup(L){const s=L;ke.Inertia.on("success",i=>{let l=i.detail.page.props;i.detail.page.component==="YearlyEvaluations/YearlyEvaluations"&&l&&(B.value=l.currentPage,K.value=l.perPage,ne.value=l.orderBy,oe.value=l.sort,M.value=l.total,se.value=l.lastPage,A.value=l.filters.search??null)}),ze().props.auth.user;const B=h(s.currentPage),K=h(s.perPage),ne=h(s.orderBy),oe=h(s.sort),M=h(s.total),se=h(s.lastPage),A=h(s.filters.search??null),ie=h(""),c=h(s.errors||{}),q=h(!1),N=h(!1),P=h(!1),T=h(!1),Q=h(null),Y=h(!1),W=h(!1),_e=[{title:"Jahr",key:"year",width:"7%",sortable:!1},{title:"Kita",key:"kita",width:"11%",sortable:!1},{title:"gemeldete Kinder  bis 2,5 Jahre",key:"children_2_born_per_year",width:"18%",sortable:!1},{title:"gemeldete Kinder  bis 4,5 Jahre",key:"children_4_born_per_year",width:"18%",sortable:!1},{title:"Evaluationen für Kinder  bis 2,5 Jahre",key:"evaluations_with_daz_2_total_per_year",width:"18%",sortable:!1},{title:"Evaluationen für Kinder  bis 4,5 Jahre",key:"evaluations_with_daz_4_total_per_year",width:"18%",sortable:!1},{title:"Aktion",key:"actions",width:"10%",sortable:!1,align:"center"}],ue=G(()=>s.items.map(i=>{const l={...i};for(const y in l)(l[y]===null||l[y]===void 0)&&(l[y]="-");return l})),X=G(()=>A.value===null),de=G(()=>A.value!==null);Ve(N,i=>{i||D()});const ee=async({page:i,itemsPerPage:l,sortBy:y,clearFilters:u})=>{if(u&&(A.value=null),i===B.value&&u||X||de){q.value=!0;let m={data:{page:i,per_page:l}};y&&y.length>0&&(m.data.order_by=y[0].key,m.data.sort=y[0].order),m.data.search=A.value,await Pe.reload(m),B.value=i,K.value=l,q.value=!1}},ce=i=>{Q.value=i.year,E.id=i.id,T.value=!0},E=te({id:null}),me=async()=>{E.processing=!0;let i={onSuccess:l=>{D()},onError:l=>{D(),c.value=l},onFinish:()=>{E.processing=!1}};E.delete(route("yearly_evaluations.destroy",{id:E.id}),i)},ae=()=>{P.value=!1},he=()=>{W.value=!0,ae()},D=()=>{N.value=!1,P.value=!1,T.value=!1,Y.value=!1,W.value=!1,t.reset(),t.clearErrors(),c.value={}},ge=()=>{t.reset(),t.clearErrors()},t=te({year:new Date().getFullYear().toString().padStart(4,"0"),kita_id:(s==null?void 0:s.kitas.length)>0?s==null?void 0:s.kitas[0].id:null,evaluations_with_daz_2_total_per_year:(s==null?void 0:s.evaluationsWithDaz2TotalPerYear)??0,evaluations_with_daz_4_total_per_year:(s==null?void 0:s.evaluationsWithDaz4TotalPerYear)??0,evaluations_without_daz_2_total_per_year:(s==null?void 0:s.evaluationsWithoutDaz2TotalPerYear)??0,evaluations_without_daz_4_total_per_year:(s==null?void 0:s.evaluationsWithoutDaz4TotalPerYear)??0,children_2_born_per_year:null,children_4_born_per_year:null,children_2_with_german_lang:null,children_4_with_german_lang:null,children_2_with_foreign_lang:null,children_4_with_foreign_lang:null}),ve=async()=>{t.processing=!0,t.post(route("yearly_evaluations.store"),{onSuccess:i=>{D()},onError:i=>{c.value=i},onFinish:()=>{t.processing=!1}})},v=i=>{if(i==="2_german")return parseInt(t.evaluations_with_daz_2_total_per_year)!==parseInt(t.children_2_with_german_lang);if(i==="2_foreign")return parseInt(t.evaluations_without_daz_2_total_per_year)!==parseInt(t.children_2_with_foreign_lang);if(i==="4_german")return parseInt(t.evaluations_with_daz_4_total_per_year)!==parseInt(t.children_4_with_german_lang);if(i==="4_foreign")return parseInt(t.evaluations_without_daz_4_total_per_year)!==parseInt(t.children_4_with_foreign_lang)},pe=async()=>{(v("2_german")||v("2_foreign")||v("4_german")||v("4_foreign"))&&!W.value?P.value=!0:await ve()};return(i,l)=>{const y=d("v-card-title"),u=d("v-col"),m=d("v-text-field"),fe=d("v-select"),p=d("v-row"),x=d("v-card"),R=d("v-container"),O=d("v-card-text"),C=d("v-btn-primary"),z=d("v-hover"),Z=d("v-spacer"),U=d("v-btn"),j=d("v-card-actions"),H=d("v-dialog"),$=d("v-icon"),be=d("v-checkbox"),le=d("v-tooltip"),ye=d("v-data-table-server"),we=Se("sortable-data-table");return b(),S(re,null,[e(r(De),{title:"Jährliche Rückmeldung"}),e(Ee,{errors:c.value},{header:a(()=>[xe,_("div",Ue,[e(z,null,{default:a(({isHovering:o,props:f})=>[e(U,k(f,{color:o?"accent":"primary",dark:""}),{default:a(()=>[w(" ANLEGEN "),e(H,{modelValue:N.value,"onUpdate:modelValue":l[12]||(l[12]=n=>N.value=n),activator:"parent",width:"80vw"},{default:a(()=>[e(x,{height:"80vh"},{default:a(()=>[e(y,null,{default:a(()=>[Je]),_:1}),e(O,null,{default:a(()=>[e(R,null,{default:a(()=>[e(p,null,{default:a(()=>[e(u,{cols:"12",sm:"12"},{default:a(()=>[Ie]),_:1}),e(u,{cols:"12",sm:"4"},{default:a(()=>[e(m,{modelValue:r(t).year,"onUpdate:modelValue":l[0]||(l[0]=n=>r(t).year=n),"error-messages":c.value.year,label:"Jahr der Rückmeldung*",required:""},null,8,["modelValue","error-messages"])]),_:1}),e(u,{cols:"12",sm:"4"},{default:a(()=>[e(fe,{modelValue:r(t).kita_id,"onUpdate:modelValue":l[1]||(l[1]=n=>r(t).kita_id=n),items:L.kitas,"error-messages":c.value.kita_id,"item-title":"name","item-value":"id",label:"Kita*"},null,8,["modelValue","items","error-messages"])]),_:1})]),_:1}),e(p,null,{default:a(()=>[e(u,{cols:"12",sm:"12"},{default:a(()=>[Be]),_:1}),e(u,{cols:"12",sm:"6"},{default:a(()=>[e(x,{class:"tw-p-6"},{default:a(()=>[Ne,e(m,{modelValue:r(t).children_2_born_per_year,"onUpdate:modelValue":l[2]||(l[2]=n=>r(t).children_2_born_per_year=n),"error-messages":c.value.children_2_born_per_year,label:"Gesamtzahl der im Zeitraum [Survey DateStart-2,5 years] - [Survey DateEnd-2,5 years] geborenen Kinder",type:"number",required:""},null,8,["modelValue","error-messages"]),e(p,null,{default:a(()=>[e(u,{cols:"12",sm:"7"},{default:a(()=>[e(m,{modelValue:r(t).children_2_with_german_lang,"onUpdate:modelValue":l[3]||(l[3]=n=>r(t).children_2_with_german_lang=n),"error-messages":c.value.children_2_with_german_lang,label:"Kinder mit deutscher Herkunftssprache*",type:"number",required:""},null,8,["modelValue","error-messages"])]),_:1}),e(u,{cols:"12",sm:"5"},{default:a(()=>[e(p,null,{default:a(()=>[v("2_german")?(b(),I(F,{key:0})):V("",!0),e(u,{cols:"12",sm:"10"},{default:a(()=>[e(m,{modelValue:r(t).evaluations_with_daz_2_total_per_year,"onUpdate:modelValue":l[4]||(l[4]=n=>r(t).evaluations_with_daz_2_total_per_year=n),"error-messages":c.value.evaluations_with_daz_2_total_per_year,label:"Bisher eingereichte Einschätzungen",type:"number",disabled:"",required:""},null,8,["modelValue","error-messages"])]),_:1})]),_:1})]),_:1})]),_:1}),e(p,null,{default:a(()=>[e(u,{cols:"12",sm:"7"},{default:a(()=>[e(m,{modelValue:r(t).children_2_with_foreign_lang,"onUpdate:modelValue":l[5]||(l[5]=n=>r(t).children_2_with_foreign_lang=n),"error-messages":c.value.children_2_with_foreign_lang,label:"Kinder mit nicht deutscher Herkunftssprache*",type:"number",required:""},null,8,["modelValue","error-messages"])]),_:1}),e(u,{cols:"12",sm:"5"},{default:a(()=>[e(p,null,{default:a(()=>[v("2_foreign")?(b(),I(F,{key:0})):V("",!0),e(u,{cols:"12",sm:"10"},{default:a(()=>[e(m,{modelValue:r(t).evaluations_without_daz_2_total_per_year,"onUpdate:modelValue":l[6]||(l[6]=n=>r(t).evaluations_without_daz_2_total_per_year=n),"error-messages":c.value.evaluations_without_daz_2_total_per_year,label:"Bisher eingereichte Einschätzungen",type:"number",disabled:"",required:""},null,8,["modelValue","error-messages"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),e(u,{cols:"12",sm:"6"},{default:a(()=>[e(x,{class:"tw-p-6"},{default:a(()=>[Te,e(m,{modelValue:r(t).children_4_born_per_year,"onUpdate:modelValue":l[7]||(l[7]=n=>r(t).children_4_born_per_year=n),"error-messages":c.value.children_4_born_per_year,label:"Gesamtzahl der im Zeitraum [Survey DateStart -4,5 years] - [Survey DateEnd-4,5 years] geborenen Kinder",type:"number",required:""},null,8,["modelValue","error-messages"]),e(p,null,{default:a(()=>[e(u,{cols:"12",sm:"7"},{default:a(()=>[e(m,{modelValue:r(t).children_4_with_german_lang,"onUpdate:modelValue":l[8]||(l[8]=n=>r(t).children_4_with_german_lang=n),"error-messages":c.value.children_4_with_german_lang,label:"Kinder mit deutscher Herkunftssprache*",type:"number",required:""},null,8,["modelValue","error-messages"])]),_:1}),e(u,{cols:"12",sm:"5"},{default:a(()=>[e(p,null,{default:a(()=>[v("4_german")?(b(),I(F,{key:0})):V("",!0),e(u,{cols:"12",sm:"10"},{default:a(()=>[e(m,{modelValue:r(t).evaluations_with_daz_4_total_per_year,"onUpdate:modelValue":l[9]||(l[9]=n=>r(t).evaluations_with_daz_4_total_per_year=n),"error-messages":c.value.evaluations_with_daz_4_total_per_year,label:"Bisher eingereichte Einschätzungen",type:"number",disabled:"",required:""},null,8,["modelValue","error-messages"])]),_:1})]),_:1})]),_:1})]),_:1}),e(p,null,{default:a(()=>[e(u,{cols:"12",sm:"7"},{default:a(()=>[e(m,{modelValue:r(t).children_4_with_foreign_lang,"onUpdate:modelValue":l[10]||(l[10]=n=>r(t).children_4_with_foreign_lang=n),"error-messages":c.value.children_4_with_foreign_lang,label:"Kinder mit nicht deutscher Herkunftssprache*",type:"number",required:""},null,8,["modelValue","error-messages"])]),_:1}),e(u,{cols:"12",sm:"5"},{default:a(()=>[e(p,null,{default:a(()=>[v("4_foreign")?(b(),I(F,{key:0})):V("",!0),e(u,{cols:"12",sm:"10"},{default:a(()=>[e(m,{modelValue:r(t).evaluations_without_daz_4_total_per_year,"onUpdate:modelValue":l[11]||(l[11]=n=>r(t).evaluations_without_daz_4_total_per_year=n),"error-messages":c.value.evaluations_without_daz_4_total_per_year,label:"Bisher eingereichte Einschätzungen",type:"number",disabled:"",required:""},null,8,["modelValue","error-messages"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),e(j,null,{default:a(()=>[e(z,null,{default:a(({isHovering:n,props:J})=>[e(C,k({onClick:ge},J,{color:n?"accent":"primary"}),{default:a(()=>[w("Zurücksetzen")]),_:2},1040,["color"])]),_:2},1024),e(Z),e(z,null,{default:a(({isHovering:n,props:J})=>[e(U,k({onClick:D},J,{color:n?"accent":"primary"}),{default:a(()=>[w("Stornieren")]),_:2},1040,["color"])]),_:2},1024),e(z,null,{default:a(({isHovering:n,props:J})=>[e(C,k({onClick:pe},J,{color:n?"accent":"primary"}),{default:a(()=>[w("Speichern")]),_:2},1040,["color"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1032,["modelValue"])]),_:2},1040,["color"])]),_:1})]),e(H,{modelValue:T.value,"onUpdate:modelValue":l[13]||(l[13]=o=>T.value=o),width:"20vw"},{default:a(()=>[e(x,{height:"30vh"},{default:a(()=>[e(O,null,{default:a(()=>[e(R,null,{default:a(()=>[e(p,null,{default:a(()=>[e(u,{cols:"12"},{default:a(()=>[_("p",null,"Sind Sie sicher, dass Sie die Jährliche Rückmeldung "+g(Q.value)+" löschen möchten?",1)]),_:1})]),_:1})]),_:1})]),_:1}),e(j,null,{default:a(()=>[e(Z),e(z,null,{default:a(({isHovering:o,props:f})=>[e(U,k({onClick:D},f,{color:o?"accent":"primary"}),{default:a(()=>[w("Abbrechen")]),_:2},1040,["color"])]),_:1}),e(z,null,{default:a(({isHovering:o,props:f})=>[e(C,k({onClick:me},f,{color:o?"accent":"primary"}),{default:a(()=>[w("Löschen")]),_:2},1040,["color"])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(H,{modelValue:P.value,"onUpdate:modelValue":l[15]||(l[15]=o=>P.value=o),width:"80vw"},{default:a(()=>[e(x,{height:"50vh"},{default:a(()=>[e(O,null,{default:a(()=>[e(R,null,{default:a(()=>[e(p,null,{default:a(()=>[e(u,{cols:"12"},{default:a(()=>[Ye,_("div",Ce,[e($,k(s,{icon:"mdi-alert",color:"orange"}),null,16),_("ul",Fe,[v("2_german")?(b(),S("li",qe," Die Anzahl der Kinder im Alter bis 2,5 Jahre welche Deutsch als Fremdsprache haben Sie mit "+g(r(t).children_2_with_german_lang)+" angegeben, die Anzahl der über die BeoKiz-Ampel erfassten Kindern beträgt "+g(r(t).evaluations_with_daz_2_total_per_year),1)):V("",!0),v("2_foreign")?(b(),S("li",We," Die Anzahl der Kinder im Alter bis 2,5 Jahre welche Deutsch als Muttersprache haben Sie mit "+g(r(t).children_2_with_foreign_lang)+" angegeben, die Anzahl der über die BeoKiz-Ampel erfassten Kindern beträgt "+g(r(t).evaluations_without_daz_2_total_per_year),1)):V("",!0),v("4_german")?(b(),S("li",Re," Die Anzahl der Kinder im Alter bis 4,5 Jahre welche Deutsch als Fremdsprache haben Sie mit "+g(r(t).children_4_with_german_lang)+" angegeben, die Anzahl der über die BeoKiz-Ampel erfassten Kindern beträgt "+g(r(t).evaluations_with_daz_2_total_per_year),1)):V("",!0),v("4_foreign")?(b(),S("li",Oe," Die Anzahl der Kinder im Alter bis 4,5 Jahre welche Deutsch als Muttersprache haben Sie mit "+g(r(t).children_4_with_foreign_lang)+" angegeben, die Anzahl der über die BeoKiz-Ampel erfassten Kindern beträgt "+g(r(t).evaluations_without_daz_4_total_per_year),1)):V("",!0)])]),e(be,{modelValue:Y.value,"onUpdate:modelValue":l[14]||(l[14]=o=>Y.value=o),label:"Ich habe verstanden, dass es Unstimmigkeiten bei dem Abgelich der gemelden Zahlen gibt, Statusmeldung dennoch absenden."},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),e(j,null,{default:a(()=>[e(Z),e(z,null,{default:a(({isHovering:o,props:f})=>[e(U,{onClick:ae,color:o?"accent":"primary"},{default:a(()=>[w("Abbrechen")]),_:2},1032,["color"])]),_:1}),e(z,null,{default:a(({isHovering:o,props:f})=>[e(C,k({disabled:!Y.value,onClick:he},f,{color:o?"accent":"primary"}),{default:a(()=>[w("Speichern")]),_:2},1040,["disabled","color"])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),default:a(()=>[_("div",Ze,[Ke((b(),I(ye,{"items-per-page":K.value,"onUpdate:itemsPerPage":l[17]||(l[17]=o=>K.value=o),"items-per-page-options":[{value:10,title:"10"},{value:25,title:"25"},{value:50,title:"50"},{value:100,title:"100"},{value:-1,title:"$vuetify.dataFooter.itemsPerPageAll"}],"items-per-page-text":"Objekte pro Seite:",headers:_e,page:B.value,"items-length":M.value,items:ue.value,search:ie.value,loading:q.value,class:"data-table-container elevation-1","item-value":"name","onUpdate:options":ee},{item:a(({item:o})=>[_("tr",{"data-id":o.selectable.id,"data-order":o.selectable.order},[_("td",null,g(o.selectable.year),1),_("td",null,g(o.selectable.kita),1),_("td",null,g(o.selectable.children_2_born_per_year),1),_("td",null,g(o.selectable.children_4_born_per_year),1),_("td",null,g(o.selectable.evaluations_with_daz_2_total_per_year+o.selectable.evaluations_without_daz_2_total_per_year),1),_("td",null,g(o.selectable.evaluations_with_daz_4_total_per_year+o.selectable.evaluations_without_daz_4_total_per_year),1),_("td",He,[e(le,{location:"top"},{activator:a(({props:f})=>[e(r(Ae),{href:i.route("yearly_evaluations.show",{id:o.selectable.id})},{default:a(()=>[e($,k(f,{size:"small",class:"tw-me-2"}),{default:a(()=>[w("mdi-pencil")]),_:2},1040)]),_:2},1032,["href"])]),default:a(()=>[$e]),_:2},1024),e(le,{location:"top"},{activator:a(({props:f})=>[e($,k(f,{size:"small",class:"tw-me-2",onClick:n=>ce(o.raw)}),{default:a(()=>[w("mdi-delete")]),_:2},1040,["onClick"])]),default:a(()=>[Ge]),_:2},1024)])],8,je)]),"no-data":a(()=>[_("div",Le,[X.value?(b(),S("h3",Me,"Die Tabelle ist leer.")):(b(),S(re,{key:1},[Qe,e(U,{color:"primary",onClick:l[16]||(l[16]=o=>ee({page:1,itemsPerPage:K.value,clearFilters:!0}))},{default:a(()=>[w("Reset")]),_:1})],64))])]),_:1},8,["items-per-page","items-per-page-options","page","items-length","items","search","loading"])),[[we]])])]),_:1},8,["errors"])],64)}}};export{ra as default};
