import{d as Ee}from"./index-82fa8462.js";import{K as Pe,k as n,h as J,m as M,T as Z,r,n as Ue,f as F,a as e,u as v,w as t,F as q,o as k,Z as Fe,b as u,p as m,d as g,t as T,q as Te,c as De,i as Ne,x as Ce,O as Oe}from"./app-75f613fc.js";import{_ as ze}from"./AuthenticatedLayout-9bf26adc.js";import{a as Ae,c as ue,b as ie}from"./common-1f9d3448.js";import"./ApplicationLogo-8ab043d2.js";const Be=u("h2",{class:"tw-font-semibold tw-text-xl tw-text-gray-800 tw-leading-tight"},"Einstellungen",-1),je={class:"tw-flex tw-items-center tw-justify-end"},Ie=u("span",{class:"tw-text-h5"},"Neuer Rückmeldezeitraum",-1),$e={class:"tw-table-block tw-max-w-full tw-mx-auto tw-py-6 tw-px-4 sm:tw-px-6 lg:tw-px-8"},Le=["data-id","data-order"],Je={align:"center"},Me=u("span",null,"Einstellungen bearbeiten",-1),Ze=u("span",null,"Einstellungen löschen",-1),qe={class:"tw-py-6"},Re={key:0,class:"tw-mb-4"},Ge=u("h3",{class:"tw-mb-4"},"Die Tabelle ist leer. Bitte setzen Sie die Suchfilter zurück.",-1),He={class:"tw-table-block tw-max-w-full tw-mx-auto tw-py-6 tw-px-4 sm:tw-px-6 lg:tw-px-8"},Ke=u("h2",{class:"tw-font-semibold tw-text-xl tw-text-gray-800 tw-leading-tight"},"E-Mail Einstellungen",-1),Qe={class:"tw-flex tw-items-center tw-justify-start"},We={class:"tw-flex tw-items-center tw-justify-start"},at={__name:"SurveyTimePeriods",props:{items:Array,currentPage:Number,perPage:Number,lastPage:Number,total:Number,paging:Boolean,orderBy:String,sort:String,filters:Object,errors:Object,settings:Object},setup(R){const _=R;Ee.Inertia.on("success",s=>{let l=s.detail.page.props;s.detail.page.component==="SurveyTimePeriods/SurveyTimePeriods"&&l&&(D.value=l.currentPage,S.value=l.perPage,de.value=l.orderBy,ce.value=l.sort,G.value=l.total,ve.value=l.lastPage,V.value=l.filters.search??null)}),Pe().props.auth.user;const D=n(_.currentPage),S=n(_.perPage),de=n(_.orderBy),ce=n(_.sort),G=n(_.total),ve=n(_.lastPage),V=n(_.filters.search??null),me=n(""),f=n(_.errors||{}),j=n(!1),N=n(!1),C=n(!1),H=n(null),I=n(!1),$=n(!1),O=n(null),z=n(null),x=n(),E=n(),_e=n({send_yearly_evaluation_reminder_ntf_before_days:"Anzahl der Tage vor Ende des Bewertungszeitraums für den Versand der Erinnerungsmails"}),pe=[{title:"Jahr",key:"year",width:"10%",sortable:!1},{title:"Altersgruppe (Jahre)",key:"age",width:"15%",sortable:!1},{title:"Erhebungsbeginn",key:"survey_start_date",width:"15%",sortable:!1},{title:"Erhebungsende",key:"survey_end_date",width:"50%",sortable:!1},{title:"Aktion",key:"actions",width:"10%",sortable:!1,align:"center"}],ge=J(()=>_.items.map(s=>{const l={...s};for(const c in l)(l[c]===null||l[c]===void 0)&&(l[c]="-");return l})),K=J(()=>V.value===null),fe=J(()=>V.value!==null);M(N,s=>{s||h()}),M(x,s=>{O.value=ie(s)}),M(E,s=>{z.value=ie(s)});const Q=async({page:s,itemsPerPage:l,sortBy:c,clearFilters:y})=>{if(y&&(V.value=null),s===D.value&&y||K||fe){j.value=!0;let p={data:{page:s,per_page:l}};c&&c.length>0&&(p.data.order_by=c[0].key,p.data.sort=c[0].order),p.data.search=V.value,await Oe.reload(p),D.value=s,S.value=l,j.value=!1}},ye=s=>{H.value=s.year,P.id=s.id,C.value=!0},P=Z({id:null}),we=async()=>{P.processing=!0;let s={onSuccess:l=>{h()},onError:l=>{h(),f.value=l},onFinish:()=>{P.processing=!1}};P.delete(route("survey_time_periods.destroy",{id:P.id}),s)},h=()=>{N.value=!1,C.value=!1,d.reset(),d.clearErrors(),O.value=null,z.value=null,f.value={}},be=()=>{d.reset(),d.clearErrors(),O.value=null,z.value=null},d=Z({year:null,age:null,survey_start_date:null,survey_end_date:null}),he=async()=>{d.processing=!0,d.survey_start_date=new Date(x.value).toLocaleString(),d.survey_end_date=new Date(E.value).toLocaleString(),d.post(route("survey_time_periods.store"),{onSuccess:s=>{h()},onError:s=>{f.value=s},onFinish:()=>{d.processing=!1}})},U=Z({settings:_.settings}),ke=async()=>{U.processing=!0;let s={preserveState:!0,onSuccess:l=>{},onError:l=>{f.value=l},onFinish:()=>{U.processing=!1}};U.post(route("settings.update"),s)};return(s,l)=>{const c=r("v-card-title"),y=r("v-text-field"),p=r("v-col"),W=r("v-date-picker"),X=r("v-menu"),Y=r("v-locale-provider"),L=r("v-row"),Se=r("v-select"),ee=r("v-container"),te=r("v-card-text"),A=r("v-btn-primary"),w=r("v-hover"),le=r("v-spacer"),B=r("v-btn"),ae=r("v-card-actions"),se=r("v-card"),oe=r("v-dialog"),ne=r("v-icon"),re=r("v-tooltip"),Ve=r("v-data-table-server"),xe=Ue("sortable-data-table");return k(),F(q,null,[e(v(Fe),{title:"Einstellungen"}),e(ze,{errors:f.value},{header:t(()=>[Be,u("div",je,[e(w,null,{default:t(({isHovering:o,props:i})=>[e(B,m(i,{color:o?"accent":"primary",dark:""}),{default:t(()=>[g(" ZEITRAUM HINZUFÜGEN "),e(oe,{modelValue:N.value,"onUpdate:modelValue":l[8]||(l[8]=a=>N.value=a),activator:"parent",width:"80vw"},{default:t(()=>[e(se,{height:"80vh"},{default:t(()=>[e(c,null,{default:t(()=>[Ie]),_:1}),e(te,null,{default:t(()=>[e(ee,null,{default:t(()=>[e(L,null,{default:t(()=>[e(p,{cols:"12",sm:"6"},{default:t(()=>[e(y,{modelValue:v(d).year,"onUpdate:modelValue":l[0]||(l[0]=a=>v(d).year=a),"error-messages":f.value.year,label:"Jahr*",required:""},null,8,["modelValue","error-messages"])]),_:1}),e(p,{cols:"12",sm:"6"},{default:t(()=>[e(Y,{locale:"de"},{default:t(()=>[e(X,{modelValue:I.value,"onUpdate:modelValue":l[3]||(l[3]=a=>I.value=a),"return-value":x.value,"close-on-content-click":!1},{activator:t(({props:a})=>[e(y,m({label:"Erhebungsbeginn*",class:"tw-cursor-pointer","model-value":O.value,"prepend-icon":"mdi-calendar",readonly:""},a),null,16,["model-value"])]),default:t(()=>[e(W,{"onUpdate:modelValue":[l[1]||(l[1]=a=>I.value=!1),l[2]||(l[2]=a=>x.value=a)],modelValue:x.value},null,8,["modelValue"])]),_:2},1032,["modelValue","return-value"])]),_:2},1024)]),_:2},1024)]),_:2},1024),e(L,null,{default:t(()=>[e(p,{cols:"12",sm:"6"},{default:t(()=>[e(Se,{modelValue:v(d).age,"onUpdate:modelValue":l[4]||(l[4]=a=>v(d).age=a),items:v(Ae),"error-messages":f.value.age,"item-title":"age_name","item-value":"age_number",label:"Altersgruppe (Jahre)*"},null,8,["modelValue","items","error-messages"])]),_:1}),e(p,{cols:"12",sm:"6"},{default:t(()=>[e(Y,{locale:"de"},{default:t(()=>[e(X,{modelValue:$.value,"onUpdate:modelValue":l[7]||(l[7]=a=>$.value=a),"return-value":E.value,"close-on-content-click":!1},{activator:t(({props:a})=>[e(y,m({label:"Erhebungsende*",class:"tw-cursor-pointer","model-value":z.value,"prepend-icon":"mdi-calendar",readonly:""},a),null,16,["model-value"])]),default:t(()=>[e(W,{"onUpdate:modelValue":[l[5]||(l[5]=a=>$.value=!1),l[6]||(l[6]=a=>E.value=a)],modelValue:E.value},null,8,["modelValue"])]),_:2},1032,["modelValue","return-value"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024),e(ae,null,{default:t(()=>[e(w,null,{default:t(({isHovering:a,props:b})=>[e(A,m({onClick:be},b,{color:a?"accent":"primary"}),{default:t(()=>[g("Zurücksetzen")]),_:2},1040,["color"])]),_:2},1024),e(le),e(w,null,{default:t(({isHovering:a,props:b})=>[e(B,m({onClick:h},b,{color:a?"accent":"primary"}),{default:t(()=>[g("Stornieren")]),_:2},1040,["color"])]),_:2},1024),e(w,null,{default:t(({isHovering:a,props:b})=>[e(A,m({onClick:he},b,{color:a?"accent":"primary"}),{default:t(()=>[g("Speichern")]),_:2},1040,["color"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1032,["modelValue"])]),_:2},1040,["color"])]),_:1})]),e(oe,{modelValue:C.value,"onUpdate:modelValue":l[9]||(l[9]=o=>C.value=o),width:"20vw"},{default:t(()=>[e(se,{height:"30vh"},{default:t(()=>[e(te,null,{default:t(()=>[e(ee,null,{default:t(()=>[e(L,null,{default:t(()=>[e(p,{cols:"12"},{default:t(()=>[u("p",null,"Sind Sie sicher, dass Sie die Einstellungen "+T(H.value)+" löschen möchten?",1)]),_:1})]),_:1})]),_:1})]),_:1}),e(ae,null,{default:t(()=>[e(le),e(w,null,{default:t(({isHovering:o,props:i})=>[e(B,m({onClick:h},i,{color:o?"accent":"primary"}),{default:t(()=>[g("Abbrechen")]),_:2},1040,["color"])]),_:1}),e(w,null,{default:t(({isHovering:o,props:i})=>[e(A,m({onClick:we},i,{color:o?"accent":"primary"}),{default:t(()=>[g("Löschen")]),_:2},1040,["color"])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),default:t(()=>[u("div",$e,[Te((k(),De(Ve,{"items-per-page":S.value,"onUpdate:itemsPerPage":l[11]||(l[11]=o=>S.value=o),"items-per-page-options":[{value:10,title:"10"},{value:25,title:"25"},{value:50,title:"50"},{value:100,title:"100"},{value:-1,title:"$vuetify.dataFooter.itemsPerPageAll"}],"items-per-page-text":"Objekte pro Seite:",headers:pe,page:D.value,"items-length":G.value,items:ge.value,search:me.value,loading:j.value,class:"data-table-container elevation-1","item-value":"name","onUpdate:options":Q},{item:t(({item:o})=>[u("tr",{"data-id":o.selectable.id,"data-order":o.selectable.order},[u("td",null,T(o.selectable.year),1),u("td",null,T(o.selectable.age),1),u("td",null,T(v(ue)(o.selectable.survey_start_date,"sv-SE")),1),u("td",null,T(v(ue)(o.selectable.survey_end_date,"sv-SE")),1),u("td",Je,[e(re,{location:"top"},{activator:t(({props:i})=>[e(v(Ne),{href:s.route("survey_time_periods.show",{id:o.selectable.id})},{default:t(()=>[e(ne,m(i,{size:"small",class:"tw-me-2"}),{default:t(()=>[g("mdi-pencil")]),_:2},1040)]),_:2},1032,["href"])]),default:t(()=>[Me]),_:2},1024),e(re,{location:"top"},{activator:t(({props:i})=>[e(ne,m(i,{size:"small",class:"tw-me-2",onClick:a=>ye(o.raw)}),{default:t(()=>[g("mdi-delete")]),_:2},1040,["onClick"])]),default:t(()=>[Ze]),_:2},1024)])],8,Le)]),"no-data":t(()=>[u("div",qe,[K.value?(k(),F("h3",Re,"Die Tabelle ist leer.")):(k(),F(q,{key:1},[Ge,e(B,{color:"primary",onClick:l[10]||(l[10]=o=>Q({page:1,itemsPerPage:S.value,clearFilters:!0}))},{default:t(()=>[g("Reset")]),_:1})],64))])]),_:1},8,["items-per-page","items-per-page-options","page","items-length","items","search","loading"])),[[xe]])]),u("div",He,[Ke,(k(!0),F(q,null,Ce(R.settings,(o,i)=>{var a;return k(),F("div",Qe,[e(y,{modelValue:v(U).settings[i],"onUpdate:modelValue":b=>v(U).settings[i]=b,"error-messages":(a=f.value)!=null&&a.settings?f.value.settings[i]:!1,label:`${_e.value[i]}*`,required:""},null,8,["modelValue","onUpdate:modelValue","error-messages","label"])])}),256)),u("div",We,[e(w,null,{default:t(({isHovering:o,props:i})=>[e(A,m({onClick:ke},i,{color:o?"accent":"primary"}),{default:t(()=>[g("Speichern ")]),_:2},1040,["color"])]),_:1})])])]),_:1},8,["errors"])],64)}}};export{at as default};
