import{d as ce}from"./index-013a9bf5.js";import{K as me,x as c,h as A,k as _e,T as W,r as s,o as T,f as L,a as e,u as m,w as l,F as X,Z as fe,b as o,A as h,d as p,n as pe,t as P,i as ve,O as ge}from"./app-2811682d.js";import{_ as we}from"./AuthenticatedLayout-e7b50d46.js";import"./ApplicationLogo-3ecea417.js";const be=(V,i="en-US")=>{const g={year:"numeric",month:"2-digit",day:"2-digit"};return new Date(V).toLocaleDateString(i,g).replace(/\//g,".")},he=(V,i="en-US",g=!1)=>{const v={year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"};return g&&(v.second="2-digit"),new Date(V).toLocaleDateString(i,v).replace(/\//g,".")},ye=o("h2",{class:"tw-font-semibold tw-text-xl tw-text-gray-800 tw-leading-tight"},"Benutzer",-1),ke={class:"tw-flex tw-items-center tw-justify-end"},Ve=o("span",{class:"tw-text-h5"},"Neuen Benutzer",-1),xe=o("p",null,"Sind Sie sicher, dass Sie den aktuellen Benutzer löschen möchten?",-1),Se={class:"tw-table-block tw-max-w-full tw-mx-auto tw-py-6 tw-px-4 sm:tw-px-6 lg:tw-px-8"},Ue={class:"tw-bg-white tw-flex tw-justify-between tw-px-6 tw-py-6"},ze={class:"tw-w-full"},De={class:"tw-ml-6"},Pe={align:"center"},Ne=o("span",null,"Benutzer bearbeiten",-1),Be=o("span",null,"Benutzer löschen",-1),Ce={class:"tw-py-6"},Ee={key:0,class:"tw-mb-4"},Fe=o("h3",{class:"tw-mb-4"},"Die Tabelle ist leer. Bitte setzen Sie die Suchfilter zurück.",-1),Ie={__name:"Users",props:{items:Array,currentPage:Number,perPage:Number,lastPage:Number,total:Number,paging:Boolean,orderBy:String,sort:String,filters:Object,errors:Object,roles:Array},setup(V){const i=V;ce.Inertia.on("success",n=>{let t=n.detail.page.props;n.detail.page.component==="Users"&&t&&(g.value=t.currentPage,v.value=t.perPage,O.value=t.orderBy,Y.value=t.sort,I.value=t.total,ee.value=t.lastPage,y.value=t.filters.full_name??null,k.value=t.filters.email??null)}),me().props.auth.user;const g=c(i.currentPage),v=c(i.perPage),O=c(i.orderBy),Y=c(i.sort),I=c(i.total),ee=c(i.lastPage),y=c(i.filters.full_name??null),k=c(i.filters.email??null),j=c(""),w=c(i.errors||{}),C=c(!1),N=c(!1),B=c(!1),te=c(-1),le=[{title:"Status",key:"is_online",width:"5%",sortable:!1,align:"center"},{title:"Name",key:"first_name",width:"25%",sortable:!1},{title:"Email",key:"email",width:"20%",sortable:!1},{title:"Rolle",key:"primary_role_name",width:"10%",sortable:!1},{title:"Letzter Login",key:"last_seen_at",width:"15%",sortable:!1},{title:"Erster Login",key:"first_login_at",width:"15%",sortable:!1},{title:"Aktionen",key:"actions",width:"10%",sortable:!1}],ae=A(()=>i.items.map(n=>{const t={...n};for(const _ in t)(t[_]===null||t[_]===void 0)&&(t[_]="-");return t})),q=A(()=>y.value===null&&k.value===null),oe=A(()=>y.value!==null||k.value!==null);_e(N,n=>{n||U()});const $=async({page:n,itemsPerPage:t,sortBy:_,clearFilters:b})=>{if(b&&(y.value=null,k.value=null),n===g.value&&b||q||oe){C.value=!0;let d={data:{page:n,per_page:t}};_&&_.length>0&&(d.data.order_by=_[0].key,d.data.sort=_[0].order),d.data.full_name=y.value,d.data.email=k.value,await ge.reload(d),g.value=n,v.value=t,C.value=!1}},ne=n=>{S.id=n.id,B.value=!0},S=W({id:null}),se=async()=>{S.processing=!0;let n={onSuccess:t=>{U()},onError:t=>{w.value=t},onFinish:()=>{S.processing=!1}};S.delete(route("users.destroy",{id:S.id}),n)},U=()=>{N.value=!1,B.value=!1,u.reset(),u.clearErrors(),te.value=-1,w.value={}},u=W({first_name:null,last_name:null,email:null,role:null,two_factor_auth_enabled:!1}),re=async()=>{u.processing=!0;let n={onSuccess:t=>{U()},onError:t=>{w.value=t},onFinish:()=>{u.processing=!1}};u.post(route("users.store"),n)};return(n,t)=>{const _=s("v-card-title"),b=s("v-text-field"),d=s("v-col"),z=s("v-row"),ue=s("v-select"),ie=s("v-checkbox"),Z=s("v-container"),R=s("v-card-text"),K=s("v-spacer"),D=s("v-btn"),x=s("v-hover"),G=s("v-btn-primary"),H=s("v-card-actions"),J=s("v-card"),M=s("v-dialog"),E=s("v-icon"),Q=s("v-tooltip"),de=s("v-data-table-server");return T(),L(X,null,[e(m(fe),{title:"Benutzer"}),e(we,{errors:w.value},{header:l(()=>[ye,o("div",ke,[e(x,null,{default:l(({isHovering:a,props:f})=>[e(D,h(f,{color:a?"accent":"primary",dark:""}),{default:l(()=>[p(" Neuen Benutzer hinzufügen "),e(M,{modelValue:N.value,"onUpdate:modelValue":t[5]||(t[5]=r=>N.value=r),activator:"parent",width:"80vw"},{default:l(()=>[e(J,{height:"80vh"},{default:l(()=>[e(_,null,{default:l(()=>[Ve]),_:1}),e(R,null,{default:l(()=>[e(Z,null,{default:l(()=>[e(z,null,{default:l(()=>[e(d,{cols:"12",sm:"6"},{default:l(()=>[e(b,{modelValue:m(u).first_name,"onUpdate:modelValue":t[0]||(t[0]=r=>m(u).first_name=r),"error-messages":w.value.first_name,label:"Vorname",required:""},null,8,["modelValue","error-messages"])]),_:1}),e(d,{cols:"12",sm:"6"},{default:l(()=>[e(b,{modelValue:m(u).last_name,"onUpdate:modelValue":t[1]||(t[1]=r=>m(u).last_name=r),"error-messages":w.value.last_name,label:"Nachname",required:""},null,8,["modelValue","error-messages"])]),_:1})]),_:1}),e(z,null,{default:l(()=>[e(d,{cols:"12",sm:"6"},{default:l(()=>[e(b,{modelValue:m(u).email,"onUpdate:modelValue":t[2]||(t[2]=r=>m(u).email=r),"error-messages":w.value.email,label:"Email",required:""},null,8,["modelValue","error-messages"])]),_:1}),e(d,{cols:"12",sm:"6"},{default:l(()=>[e(ue,{modelValue:m(u).role,"onUpdate:modelValue":t[3]||(t[3]=r=>m(u).role=r),items:V.roles,"error-messages":w.value.role,"item-title":"name","item-value":"id",label:"Role",required:""},null,8,["modelValue","items","error-messages"])]),_:1})]),_:1}),e(z,null,{default:l(()=>[e(d,{cols:"12",md:"4",sm:"6"},{default:l(()=>[e(ie,{modelValue:m(u).two_factor_auth_enabled,"onUpdate:modelValue":t[4]||(t[4]=r=>m(u).two_factor_auth_enabled=r),label:"Zwei-Faktor-Authentifizierung",value:!0},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),e(H,null,{default:l(()=>[e(K),e(x,null,{default:l(({isHovering:r,props:F})=>[e(D,h({onClick:U},F,{color:r?"accent":"primary"}),{default:l(()=>[p("Abbrechen")]),_:2},1040,["color"])]),_:2},1024),e(x,null,{default:l(({isHovering:r,props:F})=>[e(G,h({onClick:re},F,{color:r?"accent":"primary"}),{default:l(()=>[p("Speichern")]),_:2},1040,["color"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1032,["modelValue"])]),_:2},1040,["color"])]),_:1})]),e(M,{modelValue:B.value,"onUpdate:modelValue":t[6]||(t[6]=a=>B.value=a),activator:"parent",width:"20vw"},{default:l(()=>[e(J,{height:"30vh"},{default:l(()=>[e(R,null,{default:l(()=>[e(Z,null,{default:l(()=>[e(z,null,{default:l(()=>[e(d,{cols:"12"},{default:l(()=>[xe]),_:1})]),_:1})]),_:1})]),_:1}),e(H,null,{default:l(()=>[e(K),e(x,null,{default:l(({isHovering:a,props:f})=>[e(D,h({onClick:U},f,{color:a?"accent":"primary"}),{default:l(()=>[p("Abbrechen")]),_:2},1040,["color"])]),_:1}),e(x,null,{default:l(({isHovering:a,props:f})=>[e(G,h({onClick:se},f,{color:a?"accent":"primary"}),{default:l(()=>[p("Löschen")]),_:2},1040,["color"])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),default:l(()=>[o("div",Se,[o("div",Ue,[o("div",ze,[e(z,null,{default:l(()=>[e(d,{cols:"12",sm:"3"},{default:l(()=>[e(b,{modelValue:y.value,"onUpdate:modelValue":t[7]||(t[7]=a=>y.value=a),label:"Name"},null,8,["modelValue"])]),_:1}),e(d,{cols:"12",sm:"3"},{default:l(()=>[e(b,{modelValue:k.value,"onUpdate:modelValue":t[8]||(t[8]=a=>k.value=a),label:"Email"},null,8,["modelValue"])]),_:1})]),_:1})]),o("div",De,[e(x,null,{default:l(({isHovering:a,props:f})=>[e(D,h({class:"tw-mt-2"},f,{color:a?"accent":"primary",onClick:t[9]||(t[9]=r=>j.value=String(Date.now())),dark:""}),{default:l(()=>[p("Search")]),_:2},1040,["color"])]),_:1})])]),e(de,{"items-per-page":v.value,"onUpdate:itemsPerPage":t[11]||(t[11]=a=>v.value=a),headers:le,page:g.value,"items-length":I.value,items:ae.value,search:j.value,loading:C.value,class:"data-table-container elevation-1","item-value":"name","onUpdate:options":$},{item:l(({item:a})=>[o("tr",null,[o("td",Pe,[e(E,{size:"medium",class:pe({active:a.selectable.is_online})},{default:l(()=>[p("mdi-circle")]),_:2},1032,["class"])]),o("td",null,P(a.selectable.full_name),1),o("td",null,P(a.selectable.email),1),o("td",null,P(a.selectable.primary_role_name),1),o("td",null,P(m(he)(a.selectable.last_seen_at,"sv-SE")),1),o("td",null,P(m(be)(a.selectable.first_login_at,"fr-CA")),1),o("td",null,[e(Q,{location:"top"},{activator:l(({props:f})=>[e(m(ve),{href:n.route("users.edit",{id:a.selectable.id})},{default:l(()=>[e(E,h(f,{size:"small",class:"tw-me-2"}),{default:l(()=>[p("mdi-pencil")]),_:2},1040)]),_:2},1032,["href"])]),default:l(()=>[Ne]),_:2},1024),e(Q,{location:"top"},{activator:l(({props:f})=>[e(E,h(f,{size:"small",class:"tw-me-2",onClick:r=>ne(a.raw)}),{default:l(()=>[p("mdi-delete")]),_:2},1040,["onClick"])]),default:l(()=>[Be]),_:2},1024)])])]),"no-data":l(()=>[o("div",Ce,[q.value?(T(),L("h3",Ee,"Die Tabelle ist leer.")):(T(),L(X,{key:1},[Fe,e(D,{color:"primary",onClick:t[10]||(t[10]=a=>$({page:1,itemsPerPage:v.value,clearFilters:!0}))},{default:l(()=>[p("Zurücksetzen")]),_:1})],64))])]),_:1},8,["items-per-page","page","items-length","items","search","loading"])])]),_:1},8,["errors"])],64)}}};export{Ie as default};
