import{d as ne}from"./index-2c30adb2.js";import{K as ue,k as U,h as ie,m as de,T as F,r as m,n as me,f as ce,a as e,u as o,w as l,F as _e,o as P,Z as fe,b as i,t as x,p,d as f,i as R,c as H,g as pe,q as ve,y as ge}from"./app-01a54515.js";import{_ as be}from"./AuthenticatedLayout-1484760e.js";import"./ApplicationLogo-02bc5262.js";const he={class:"tw-font-semibold tw-text-xl tw-text-gray-800 tw-leading-tight"},ke={class:"tw-table-block tw-max-w-full tw-mx-auto tw-py-6 tw-px-4 sm:tw-px-6 lg:tw-px-8"},Ve=i("h3",null,"Eigenschaften",-1),we=i("h3",null,"Zugeordnete Benutzer",-1),ye={class:"tw-flex tw-items-center tw-justify-end"},ze=i("span",{class:"tw-text-h5"},"Verbinden Benutzer",-1),Ue=i("p",null,"Wählen Sie die Benutzer aus, die Sie diesem Einrichtung hinzufügen möchten",-1),Ee=i("span",{class:"tw-text-h5"},"Neue Benutzer",-1),Ce=["data-id","data-order"],xe={align:"center"},Se={align:"center"},qe=i("span",null,"Benutzer bearbeiten",-1),Be=i("span",null,"Benutzer löschen",-1),Ke=i("div",{class:"tw-py-6"},[i("h3",{class:"tw-mb-4"},"Die Tabelle ist leer.")],-1),$e={__name:"ManageKita",props:{kita:Object,errors:Object,roles:Array,users:Array},setup(E){const S=E;ne.Inertia.on("success",u=>{let t=u.detail.page.props;u.detail.page.component==="Kitas/Partials/ManageKita"&&t&&(b.value=t.kita)}),ue().props.auth.user;const b=U(S.kita),d=U(S.errors||{}),W=U(!1),j=U(null),q=U(!1),N=U(!1),B=U(!1),G=[{title:"Status",key:"is_online",width:"5%",sortable:!1,align:"center"},{title:"Vorname",key:"first_name",width:"20%",sortable:!1},{title:"Nachname",key:"last_name",width:"25%",sortable:!1},{title:"E-Mail",key:"email",width:"20%",sortable:!1},{title:"Rolle",key:"primary_role_name",width:"20%",sortable:!1},{title:"Aktion",key:"actions",width:"10%",sortable:!1,align:"center"}],J=ie(()=>S.kita.users.map(u=>{const t={...u};for(const n in t)(t[n]===null||t[n]===void 0)&&(t[n]="-");return t}));de(q,u=>{u||w()});const w=()=>{q.value=!1,N.value=!1,B.value=!1,c.reset(),c.clearErrors(),V.reset(),V.clearErrors(),d.value={}},D=()=>{c.reset(),c.clearErrors(),V.reset(),V.clearErrors(),r.reset(),r.clearErrors(),r.zip_code=null,r.name=null,r.number=null,r.provider_of_the_kita=null,r.street=null,r.house_number=null,r.additional_info=null,r.city=null},Q=u=>{j.value=u.full_name,K.user=u.id,B.value=!0},K=F({user:null}),X=async()=>{K.processing=!0;let u={onSuccess:t=>{w()},onError:t=>{d.value=t},onFinish:()=>{K.processing=!1}};K.post(route("kitas.disconnect_user",{id:S.kita.id}),u)},r=F({id:b.value.id,name:b.value.name,zip_code:b.value.zip_code,number:b.value.number,provider_of_the_kita:b.value.provider_of_the_kita,street:b.value.street,house_number:b.value.house_number,additional_info:b.value.additional_info,city:b.value.city}),Y=async()=>{r.processing=!0;let u={preserveState:!1,onSuccess:t=>{w()},onError:t=>{d.value=t},onFinish:()=>{r.processing=!1}};r.put(route("kitas.update",{kita:r.id}),u)},c=F({first_name:null,last_name:null,email:null,role:null,two_factor_auth_enabled:!1,kitas:[b.value.id]}),ee=async()=>{c.processing=!0,c.post(route("users.store_from_kita"),{onSuccess:u=>{w()},onError:u=>{d.value=u},onFinish:()=>{c.processing=!1}})},V=F({users:null,kitas:[b.value.id]}),le=async()=>{V.processing=!0,V.post(route("kitas.connect_users",{kita:c.kitas}),{onSuccess:u=>{w()},onError:u=>{d.value=u},onFinish:()=>{V.processing=!1}})};return(u,t)=>{const n=m("v-col"),v=m("v-row"),y=m("v-container"),h=m("v-text-field"),z=m("v-btn"),g=m("v-hover"),C=m("v-btn-primary"),M=m("v-card-title"),te=m("v-autocomplete"),Z=m("v-card-text"),$=m("v-spacer"),T=m("v-card-actions"),A=m("v-card"),I=m("v-dialog"),ae=m("v-select"),oe=m("v-checkbox"),O=m("v-icon"),L=m("v-tooltip"),re=m("v-data-table-server"),se=me("sortable-data-table");return P(),ce(_e,null,[e(o(fe),{title:`Verwalte Einrichtung ${E.kita.name}`},null,8,["title"]),e(be,{errors:d.value},{header:l(()=>[i("h2",he,"Verwalte Einrichtung "+x(E.kita.name),1)]),default:l(()=>[i("div",ke,[e(y,null,{default:l(()=>[e(v,null,{default:l(()=>[e(n,{cols:"12"},{default:l(()=>[Ve]),_:1})]),_:1})]),_:1}),e(y,null,{default:l(()=>[e(v,null,{default:l(()=>[e(n,{cols:"12",sm:"6"},{default:l(()=>[e(h,{modelValue:o(r).name,"onUpdate:modelValue":t[0]||(t[0]=a=>o(r).name=a),"error-messages":d.value.name,label:"Name der Einrichtung / Einrichtung*",required:""},null,8,["modelValue","error-messages"])]),_:1}),e(n,{cols:"12",sm:"6"},{default:l(()=>[e(h,{modelValue:o(r).number,"onUpdate:modelValue":t[1]||(t[1]=a=>o(r).number=a),"error-messages":d.value.number,label:"Kita Nummer*",type:"number",required:""},null,8,["modelValue","error-messages"])]),_:1})]),_:1}),e(v,null,{default:l(()=>[e(n,{cols:"12",sm:"6"},{default:l(()=>[e(h,{modelValue:o(r).provider_of_the_kita,"onUpdate:modelValue":t[2]||(t[2]=a=>o(r).provider_of_the_kita=a),"error-messages":d.value.provider_of_the_kita,label:"Träger der Einrichtung*",required:""},null,8,["modelValue","error-messages"])]),_:1}),e(n,{cols:"12",sm:"6"},{default:l(()=>[e(h,{modelValue:o(r).street,"onUpdate:modelValue":t[3]||(t[3]=a=>o(r).street=a),"error-messages":d.value.street,label:"Straße*",required:""},null,8,["modelValue","error-messages"])]),_:1})]),_:1}),e(v,null,{default:l(()=>[e(n,{cols:"12",sm:"6"},{default:l(()=>[e(h,{modelValue:o(r).house_number,"onUpdate:modelValue":t[4]||(t[4]=a=>o(r).house_number=a),"error-messages":d.value.house_number,label:"Hausnummer*",required:""},null,8,["modelValue","error-messages"])]),_:1}),e(n,{cols:"12",sm:"6"},{default:l(()=>[e(h,{modelValue:o(r).additional_info,"onUpdate:modelValue":t[5]||(t[5]=a=>o(r).additional_info=a),"error-messages":d.value.additional_info,label:"Sonstiges*",required:""},null,8,["modelValue","error-messages"])]),_:1})]),_:1}),e(v,null,{default:l(()=>[e(n,{cols:"12",sm:"6"},{default:l(()=>[e(h,{modelValue:o(r).zip_code,"onUpdate:modelValue":t[6]||(t[6]=a=>o(r).zip_code=a),"error-messages":d.value.zip_code,label:"Postleitzahl*",type:"number",required:""},null,8,["modelValue","error-messages"])]),_:1}),e(n,{cols:"12",sm:"6"},{default:l(()=>[e(h,{modelValue:o(r).city,"onUpdate:modelValue":t[7]||(t[7]=a=>o(r).city=a),"error-messages":d.value.city,label:"Stadt*",required:""},null,8,["modelValue","error-messages"])]),_:1})]),_:1}),e(v,null,{default:l(()=>[e(n,{cols:"12",sm:"6"},{default:l(()=>[e(g,null,{default:l(({isHovering:a,props:_})=>[e(z,p({onClick:D},_,{color:a?"primary":"accent"}),{default:l(()=>[f("Zurücksetzen")]),_:2},1040,["color"])]),_:1})]),_:1}),e(n,{cols:"12",sm:"6",align:"right"},{default:l(()=>[e(g,null,{default:l(({isHovering:a,props:_})=>[e(o(R),{href:u.route("kitas.index")},{default:l(()=>[e(z,p({class:"mr-2",variant:"text"},_,{color:a?"accent":"primary"}),{default:l(()=>[f("Zurück")]),_:2},1040,["color"])]),_:2},1032,["href"])]),_:1}),e(g,null,{default:l(({isHovering:a,props:_})=>[e(C,p({onClick:Y},_,{color:a?"accent":"primary"}),{default:l(()=>[f("Speichern ")]),_:2},1040,["color"])]),_:1})]),_:1})]),_:1})]),_:1}),e(y,null,{default:l(()=>[e(v,{class:"tw-border-t-8 tw-mt-8 tw-pt-8"},{default:l(()=>[e(n,{cols:"12",sm:"6"},{default:l(()=>[we]),_:1}),e(n,{cols:"12",sm:"6"},{default:l(()=>[i("div",ye,[u.$page.props.auth.user.is_super_admin||u.$page.props.auth.user.is_admin?(P(),H(g,{key:0},{default:l(({isHovering:a,props:_})=>[e(z,p(_,{color:a?"accent":"primary",dark:"",class:"mr-2"}),{default:l(()=>[f(" Benutzer verbinden "),e(I,{modelValue:N.value,"onUpdate:modelValue":t[9]||(t[9]=s=>N.value=s),activator:"parent",width:"80vw"},{default:l(()=>[e(A,{height:"80vh"},{default:l(()=>[e(M,null,{default:l(()=>[ze]),_:1}),e(Z,null,{default:l(()=>[e(y,null,{default:l(()=>[e(v,null,{default:l(()=>[e(n,{cols:"12"},{default:l(()=>[Ue]),_:1})]),_:1}),e(v,null,{default:l(()=>[e(n,{cols:"12"},{default:l(()=>[e(te,{modelValue:o(V).users,"onUpdate:modelValue":t[8]||(t[8]=s=>o(V).users=s),items:E.users,"error-messages":d.value.users,"item-title":"full_name","item-value":"id",label:"User",multiple:"",required:""},null,8,["modelValue","items","error-messages"])]),_:1})]),_:1})]),_:1})]),_:1}),e(T,null,{default:l(()=>[e(g,null,{default:l(({isHovering:s,props:k})=>[e(C,p({onClick:D},k,{color:s?"primary":"accent"}),{default:l(()=>[f("Zurücksetzen")]),_:2},1040,["color"])]),_:2},1024),e($),e(g,null,{default:l(({isHovering:s,props:k})=>[e(z,p({onClick:w},k,{color:s?"accent":"primary"}),{default:l(()=>[f("Zurück")]),_:2},1040,["color"])]),_:2},1024),e(g,null,{default:l(({isHovering:s,props:k})=>[e(C,p({onClick:le},k,{color:s?"accent":"primary"}),{default:l(()=>[f("Speichern")]),_:2},1040,["color"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1032,["modelValue"])]),_:2},1040,["color"])]),_:1})):pe("",!0),e(g,null,{default:l(({isHovering:a,props:_})=>[e(z,p(_,{color:a?"accent":"primary",dark:""}),{default:l(()=>[f(" Benutzer hinzufügen "),e(I,{modelValue:q.value,"onUpdate:modelValue":t[15]||(t[15]=s=>q.value=s),activator:"parent",width:"80vw"},{default:l(()=>[e(A,{height:"80vh"},{default:l(()=>[e(M,null,{default:l(()=>[Ee]),_:1}),e(Z,null,{default:l(()=>[e(y,null,{default:l(()=>[e(v,null,{default:l(()=>[e(n,{cols:"12",sm:"6"},{default:l(()=>[e(h,{modelValue:o(c).first_name,"onUpdate:modelValue":t[10]||(t[10]=s=>o(c).first_name=s),"error-messages":d.value.first_name,label:"Vorname",required:""},null,8,["modelValue","error-messages"])]),_:1}),e(n,{cols:"12",sm:"6"},{default:l(()=>[e(h,{modelValue:o(c).last_name,"onUpdate:modelValue":t[11]||(t[11]=s=>o(c).last_name=s),"error-messages":d.value.last_name,label:"Nachname",required:""},null,8,["modelValue","error-messages"])]),_:1})]),_:1}),e(v,null,{default:l(()=>[e(n,{cols:"12",sm:"6"},{default:l(()=>[e(h,{modelValue:o(c).email,"onUpdate:modelValue":t[12]||(t[12]=s=>o(c).email=s),"error-messages":d.value.email,label:"Email",required:""},null,8,["modelValue","error-messages"])]),_:1}),e(n,{cols:"12",sm:"6"},{default:l(()=>[e(ae,{modelValue:o(c).role,"onUpdate:modelValue":t[13]||(t[13]=s=>o(c).role=s),items:E.roles,"error-messages":d.value.role,"item-title":"human_name","item-value":"id",label:"Role",required:""},null,8,["modelValue","items","error-messages"])]),_:1})]),_:1}),e(v,null,{default:l(()=>[e(n,{cols:"12",md:"4",sm:"6"},{default:l(()=>[e(oe,{modelValue:o(c).two_factor_auth_enabled,"onUpdate:modelValue":t[14]||(t[14]=s=>o(c).two_factor_auth_enabled=s),label:"Zwei-Faktor-Authentifizierung",value:!0},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),e(T,null,{default:l(()=>[e(g,null,{default:l(({isHovering:s,props:k})=>[e(C,p({onClick:D},k,{color:s?"primary":"accent"}),{default:l(()=>[f("Zurücksetzen")]),_:2},1040,["color"])]),_:2},1024),e($),e(g,null,{default:l(({isHovering:s,props:k})=>[e(z,p({onClick:w},k,{color:s?"accent":"primary"}),{default:l(()=>[f("Zurück")]),_:2},1040,["color"])]),_:2},1024),e(g,null,{default:l(({isHovering:s,props:k})=>[e(C,p({onClick:ee},k,{color:s?"accent":"primary"}),{default:l(()=>[f("Speichern")]),_:2},1040,["color"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1032,["modelValue"])]),_:2},1040,["color"])]),_:1})])]),_:1})]),_:1})]),_:1}),e(y,null,{default:l(()=>[e(I,{modelValue:B.value,"onUpdate:modelValue":t[16]||(t[16]=a=>B.value=a),width:"20vw"},{default:l(()=>[e(A,{height:"30vh"},{default:l(()=>[e(Z,null,{default:l(()=>[e(y,null,{default:l(()=>[e(v,null,{default:l(()=>[e(n,{cols:"12"},{default:l(()=>[i("p",null,"Sind Sie sicher, dass Sie den Benutzer "+x(j.value)+" aus Einrichtung Liste löschen möchten? (Der Benutzer wird vom aktuellen Einrichtung getrennt)",1)]),_:1})]),_:1})]),_:1})]),_:1}),e(T,null,{default:l(()=>[e($),e(g,null,{default:l(({isHovering:a,props:_})=>[e(z,p({onClick:w},_,{color:a?"accent":"primary"}),{default:l(()=>[f("Abbrechen")]),_:2},1040,["color"])]),_:1}),e(g,null,{default:l(({isHovering:a,props:_})=>[e(C,p({onClick:X},_,{color:a?"accent":"primary"}),{default:l(()=>[f("Löschen")]),_:2},1040,["color"])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(v,null,{default:l(()=>[e(n,{cols:"12"},{default:l(()=>[ve((P(),H(re,{"items-per-page":-1,headers:G,items:J.value,loading:W.value,class:"data-table-container data-table-container-hide-footer elevation-1","item-value":"name"},{item:l(({item:a})=>[i("tr",{"data-id":a.selectable.id,"data-order":a.selectable.order},[i("td",xe,[e(O,{size:"medium",class:ge({active:a.selectable.is_online})},{default:l(()=>[f("mdi-circle")]),_:2},1032,["class"])]),i("td",null,x(a.selectable.first_name),1),i("td",null,x(a.selectable.last_name),1),i("td",null,x(a.selectable.email),1),i("td",null,x(a.selectable.primary_role_human_name),1),i("td",Se,[e(L,{location:"top"},{activator:l(({props:_})=>[e(o(R),{href:`${u.route("users.edit",{id:a.selectable.id})}?from=kitas.show;${E.kita.id}`},{default:l(()=>[e(O,p(_,{size:"small",class:"tw-me-2"}),{default:l(()=>[f("mdi-pencil")]),_:2},1040)]),_:2},1032,["href"])]),default:l(()=>[qe]),_:2},1024),e(L,{location:"top"},{activator:l(({props:_})=>[e(O,p(_,{size:"small",class:"tw-me-2",onClick:s=>Q(a.raw)}),{default:l(()=>[f("mdi-delete ")]),_:2},1040,["onClick"])]),default:l(()=>[Be]),_:2},1024)])],8,Ce)]),"no-data":l(()=>[Ke]),_:1},8,["items","loading"])),[[se]])]),_:1})]),_:1})]),_:1})])]),_:1},8,["errors"])],64)}}};export{$e as default};
