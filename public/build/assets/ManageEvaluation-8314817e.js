import{d as se}from"./index-8ee44c2b.js";import{K as oe,j as h,k as R,v as re,s as ie,T as N,l as ue,r as u,o as k,f as K,a as e,u as i,w as a,F as de,Z as ce,b as v,c as I,h as P,m as y,d as p,t as me,x as _e}from"./app-5ba13249.js";import{p as F,a as ve}from"./common-ea192878.js";import{_ as pe}from"./AuthenticatedLayout-47a9b000.js";import{_ as Y}from"./EvaluationDomainsList-8f366724.js";import{v as fe}from"./v4-4a60fe23.js";import"./ApplicationLogo-74ad45b0.js";const ge=v("h2",{class:"tw-font-semibold tw-text-xl tw-text-gray-800 tw-leading-tight"},"Auswertung erstellen",-1),he={class:"tw-table-block tw-max-w-full tw-mx-auto tw-py-6 tw-px-4 sm:tw-px-6 lg:tw-px-8"},we=v("h3",null,"Eigenschaften",-1),be={key:0,class:"tw-flex justify-center items-center tw-bg-white"},ke={class:"tw-text-right"},ye={class:"tw-text-center"},xe=v("h1",{class:"tw-uppercase text-primary tw-font-black tw-text-xl tw-mb-8"}," Einschätzung wurde eingereicht ",-1),Ve=v("p",{class:"tw-mb-8"}," Folgendes Einschätzung wurde eingereicht und kann nur bis 15 Minuten nach Einreichung bearbeitet werden. Danach verschwindet es aus Ihrer Übersicht. Sollten Sie es zurückziehen oder bearbeiten wollen, klicke Sie auf 'Abgabe zurückziehen. Nachfolgend erhalten Sie eine Übersicht des eingereichten Screenings, welches Sie über den Download-Button als PDF herunterladen können. ",-1),Ee=v("span",{class:"tw-font-black"},"Bezeichner des Einschätzung",-1),Me={__name:"ManageEvaluation",props:{evaluation:Object,kitas:Array,domains:Array,errors:Object,newCustomUniqueId:String,from:String},setup(x){const r=x;se.Inertia.on("success",n=>{n.detail.page.props,n.detail.page.component});const $=oe().props.auth.user??{},M=h(null),c=h(r.errors||{}),w=h(!1),S=h([]),V=h(!1),b=h(null),E=h([{name:"1 - 12 Monate",id:"upToOneYear"},{name:"12 - 24 Monate",id:"upToTwoYears"},{name:"24 - 36 Monate",id:"upToThreeYears"}]);R(()=>{if(r.from){const n=r.from.split(";");if(n.length===3){const l=n[0],o={};return o[n[1]]=n[2],route(l,o)}}return route("yearly_evaluations.index")});const d=R(()=>!!r.evaluation);re(()=>{d.value||j()}),ie(()=>{var n;B((n=r.evaluation)==null?void 0:n.age),d.value||q()});const q=()=>{M.value=fe(),t.uuid=M.value},B=n=>{if(n===4.5)E.value.push({name:"Länger als 36 Monate",id:"moreThanThreeYears"});else{const l=E.value.findIndex(o=>o.id==="moreThanThreeYears");l!==-1&&E.value.splice(l,1)}},j=()=>{t.ratings=F(r.domains)},U=()=>{c.value={},V.value=!1},O=()=>{t.reset(),t.clearErrors(),c.value={},t.ratings=F(r.domains),d.value||q()},t=N({id:d.value?r.evaluation.id:null,custom_unique_id:d.value?r.evaluation.custom_unique_id:r.newCustomUniqueId,uuid:d.value?r.evaluation.uuid:null,user_id:d.value?r.evaluation.user_id:$.id,kita_id:d.value?r.evaluation.kita_id:null,age:d.value?r.evaluation.age:null,child_duration_in_kita:d.value?r.evaluation.child_duration_in_kita:null,is_daz:d.value?r.evaluation.is_daz:!1,integration_status:d.value?r.evaluation.integration_status:!1,speech_therapy_status:d.value?r.evaluation.speech_therapy_status:!1,ratings:d.value?r.evaluation.data:[]});ue(()=>t.age,n=>{t.ratings=F(r.domains),B(n),n!==4.5&&(t.child_duration_in_kita=null)});const Z=n=>{t.ratings=n},H=n=>{S.value=_e(n)?n.value:n},L=async()=>{t.processing=!0,w.value=!0;let n=[];S.value.map(o=>(o.subdomains.map(m=>(m.milestones.map(f=>(n.push(parseInt(f.id)),f)),m)),o)),t.ratings=t.ratings.map(o=>(o.milestones.map(m=>(n.includes(parseInt(m.id))||(m.value=0),m)),o));let l={onSuccess:o=>{t.clearErrors(),c.value={},V.value=!0,b.value=o.props.data},onError:o=>{c.value=o},onFinish:()=>{t.processing=!1,w.value=!1}};d.value?t.put(route("evaluations.update",{evaluation:r.evaluation.id}),l):t.post(route("evaluations.store"),l)},G=async()=>{t.processing=!0,w.value=!0,t.post(route("evaluations.save"),{preserveState:!1,onSuccess:n=>{t.clearErrors(),c.value={}},onError:n=>{c.value=n},onFinish:()=>{t.processing=!1,w.value=!1}})},z=N({}),J=async n=>{z.processing=!0,z.post(route("evaluations.unfinished",{id:n}),{preserveState:!1,onSuccess:l=>{z.clearErrors(),c.value={},U()},onError:l=>{c.value=l},onFinish:()=>{z.processing=!1,w.value=!1}})};return(n,l)=>{const o=u("v-col"),m=u("v-row"),f=u("v-container"),Q=u("v-text-field"),T=u("v-select"),C=u("v-checkbox"),W=u("v-progress-circular"),D=u("v-btn"),g=u("v-hover"),A=u("v-btn-primary"),X=u("v-icon"),ee=u("v-card-text"),ae=u("v-spacer"),te=u("v-card-actions"),ne=u("v-card"),le=u("v-dialog");return k(),K(de,null,[e(i(ce),{title:"Auswertung erstellen"}),e(pe,{errors:c.value},{header:a(()=>[ge]),default:a(()=>[v("div",he,[e(f,null,{default:a(()=>[e(m,null,{default:a(()=>[e(o,{cols:"12"},{default:a(()=>[we]),_:1})]),_:1})]),_:1}),e(f,null,{default:a(()=>[e(m,null,{default:a(()=>[e(o,{cols:"12",sm:"3"},{default:a(()=>[e(Q,{modelValue:i(t).custom_unique_id,"onUpdate:modelValue":l[0]||(l[0]=s=>i(t).custom_unique_id=s),"error-messages":c.value.custom_unique_id,readonly:"",label:"Bezeichner der Einschatzung",required:""},null,8,["modelValue","error-messages"])]),_:1}),e(o,{cols:"12",sm:"2"},{default:a(()=>[e(T,{modelValue:i(t).age,"onUpdate:modelValue":l[1]||(l[1]=s=>i(t).age=s),items:i(ve),"error-messages":c.value.age,"item-title":"age_name","item-value":"age_number",label:"Altersgruppe"},null,8,["modelValue","items","error-messages"])]),_:1}),e(o,{cols:"12",sm:"2"},{default:a(()=>[e(T,{modelValue:i(t).kita_id,"onUpdate:modelValue":l[2]||(l[2]=s=>i(t).kita_id=s),items:x.kitas,"error-messages":c.value.kita_id,"item-title":"name","item-value":"id",label:"KiTa"},null,8,["modelValue","items","error-messages"])]),_:1}),e(o,{cols:"12",sm:"2"},{default:a(()=>[e(T,{modelValue:i(t).child_duration_in_kita,"onUpdate:modelValue":l[3]||(l[3]=s=>i(t).child_duration_in_kita=s),items:E.value,"error-messages":c.value.child_duration_in_kita,"item-title":"name","item-value":"id",label:"Zeitraum in der KiTa"},null,8,["modelValue","items","error-messages"])]),_:1}),e(o,{cols:"12",sm:"3"},{default:a(()=>[e(C,{modelValue:i(t).is_daz,"onUpdate:modelValue":l[4]||(l[4]=s=>i(t).is_daz=s),label:"Deutsch ist nicht Erstsprache des Kindes"},null,8,["modelValue"]),e(C,{modelValue:i(t).integration_status,"onUpdate:modelValue":l[5]||(l[5]=s=>i(t).integration_status=s),label:"Integrationsstatus"},null,8,["modelValue"]),e(C,{modelValue:i(t).speech_therapy_status,"onUpdate:modelValue":l[6]||(l[6]=s=>i(t).speech_therapy_status=s),label:"in logopädische Behandlung"},null,8,["modelValue"])]),_:1})]),_:1}),e(m,{class:"manage-evaluation-domains"},{default:a(()=>[i(t).age?(k(),I(Y,{key:0,ratings:i(t).ratings,age:i(t).age,domains:x.domains,errors:c.value,onUpdateRatingData:Z,onUpdateDomainsData:H},null,8,["ratings","age","domains","errors"])):P("",!0)]),_:1})]),_:1}),e(f,null,{default:a(()=>[w.value?(k(),K("div",be,[e(W,{indeterminate:"",size:40})])):(k(),I(m,{key:1},{default:a(()=>[e(o,{cols:"12",sm:"6"},{default:a(()=>[e(g,null,{default:a(({isHovering:s,props:_})=>[e(D,y({onClick:O},_,{color:s?"primary":"accent"}),{default:a(()=>[p(" Zurücksetzen ")]),_:2},1040,["color"])]),_:1})]),_:1}),e(o,{cols:"12",sm:"6",align:"right"},{default:a(()=>[e(g,null,{default:a(({isHovering:s,props:_})=>[e(D,y({class:"mr-2",onClick:G,variant:"text"},_,{color:s?"accent":"primary"}),{default:a(()=>[p(" Speichern ")]),_:2},1040,["color"])]),_:1}),i(t).age&&S.value.length>0?(k(),I(g,{key:0},{default:a(({isHovering:s,props:_})=>[e(A,y({onClick:L},_,{color:s?"accent":"primary"}),{default:a(()=>[p(" Prüfen und Einreichen ")]),_:2},1040,["color"])]),_:1})):P("",!0)]),_:1})]),_:1}))]),_:1})]),e(le,{modelValue:V.value,"onUpdate:modelValue":l[8]||(l[8]=s=>V.value=s),width:"95vw"},{default:a(()=>[e(ne,{height:"95vh"},{default:a(()=>[e(ee,null,{default:a(()=>[e(f,null,{default:a(()=>[e(m,{class:"result-evaluation-domains"},{default:a(()=>[e(o,{cols:"12"},{default:a(()=>[e(g,null,{default:a(({isHovering:s,props:_})=>[v("div",ke,[e(X,y(_,{size:"small",class:"tw-me-2",onClick:U,title:"Fenster schließen"}),{default:a(()=>[p("mdi-close")]),_:2},1040)])]),_:1})]),_:1})]),_:1}),e(m,{class:"result-evaluation-domains"},{default:a(()=>[e(o,{cols:"8",offset:"2"},{default:a(()=>[v("div",ye,[xe,Ve,e(g,null,{default:a(({isHovering:s,props:_})=>[e(D,{href:n.route("evaluations.pdf",{id:b.value.item.id}),class:"tw-px-2 tw-py-3 tw-mb-4 tw-mr-4 tw-normal-case",color:s?"primary":"accent"},{default:a(()=>[p(" Einschätzung als PDF downloaden ")]),_:2},1032,["href","color"])]),_:1}),e(g,null,{default:a(({isHovering:s,props:_})=>[e(D,{onClick:l[7]||(l[7]=ze=>J(b.value.item.id)),class:"tw-px-2 tw-py-3 tw-mb-4 tw-normal-case",color:s?"accent":"primary"},{default:a(()=>[p(" Abgabe zurückziehen ")]),_:2},1032,["color"])]),_:1})])]),_:1}),e(o,{cols:"12"},{default:a(()=>[v("p",null,[Ee,p(": "+me(`${b.value.item.kita.formatted_name}_${b.value.item.custom_unique_id}`),1)])]),_:1}),e(o,{cols:"12"},{default:a(()=>[e(Y,{ratings:b.value.item.data,age:i(t).age,domains:x.domains,disabled:!0},null,8,["ratings","age","domains"])]),_:1})]),_:1})]),_:1})]),_:1}),e(te,null,{default:a(()=>[e(ae),e(g,null,{default:a(({isHovering:s,props:_})=>[e(A,y({onClick:U},_,{color:s?"accent":"primary"}),{default:a(()=>[p("Abbrechen")]),_:2},1040,["color"])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["errors"])],64)}}};export{Me as default};
