import{d as ne}from"./index-f10be2c0.js";import{K as se,k as w,h as oe,s as re,l as ie,T as N,m as ue,r as u,f as Y,a as e,u as r,w as a,F as de,o as k,Z as ce,b as v,c as M,g as $,p as y,d as p,t as me,v as _e}from"./app-b5568bbd.js";import{p as T,a as ve}from"./common-1f9d3448.js";import{_ as pe}from"./AuthenticatedLayout-64d783a2.js";import{_ as K}from"./EvaluationDomainsList-a5057aa0.js";import{v as fe}from"./v4-4a60fe23.js";import"./ApplicationLogo-d44aa410.js";const ge=v("h2",{class:"tw-font-semibold tw-text-xl tw-text-gray-800 tw-leading-tight"},"Auswertung erstellen",-1),he={class:"tw-table-block tw-max-w-full tw-mx-auto tw-py-6 tw-px-4 sm:tw-px-6 lg:tw-px-8"},we=v("h3",null,"Eigenschaften",-1),be={key:0,class:"tw-flex justify-center items-center tw-bg-white"},ke={class:"tw-text-right"},ye=["href"],Ve={class:"tw-text-center"},xe=v("h1",{class:"tw-uppercase text-primary tw-font-black tw-text-xl tw-mb-8"}," Screening wurde eingereicht ",-1),Ee=v("p",{class:"tw-mb-8"}," Folgendes Screening wurde eingereicht und kann nur bis 15 Minuten nach Einreichung bearbeitet werden. Danach verschwindet es aus Ihrer Übersicht. Sollten Sie es zurückziehen oder bearbeiten wollen, klicke Sie auf 'Abgabe zurückziehen. Nachfolgend erhalten Sie eine Übersicht des eingereichten Screenings, welches Sie über den Download-Button als PDF herunterladen können. ",-1),Se=v("span",{class:"tw-font-black"},"Bezeichner des Screenings",-1),Be={__name:"ManageEvaluation",props:{evaluation:Object,kitas:Array,domains:Array,errors:Object},setup(V){const i=V;ne.Inertia.on("success",s=>{s.detail.page.props,s.detail.page.component});const O=se().props.auth.user??{},I=w(null),d=w(i.errors||{}),b=w(!1),D=w([]),x=w(!1),f=w(null),E=w([{name:"1 - 12 Monate",id:"upToOneYear"},{name:"12 - 24 Monate",id:"upToTwoYears"},{name:"24 - 36 Monate",id:"upToThreeYears"}]),c=oe(()=>!!i.evaluation);re(()=>{c.value||P()}),ie(()=>{var s;A((s=i.evaluation)==null?void 0:s.age),c.value||B()});const B=()=>{I.value=fe(),t.uuid=I.value},A=s=>{if(s===4.5)E.value.push({name:"Länger als 36 Monate",id:"moreThanThreeYears"});else{const l=E.value.findIndex(o=>o.id==="moreThanThreeYears");l!==-1&&E.value.splice(l,1)}},P=()=>{t.ratings=T(i.domains)},U=()=>{d.value={},x.value=!1},j=()=>{t.reset(),t.clearErrors(),d.value={},t.ratings=T(i.domains),c.value||B()},t=N({uuid:c.value?i.evaluation.uuid:null,user_id:c.value?i.evaluation.user_id:O.id,kita_id:c.value?i.evaluation.kita_id:null,age:c.value?i.evaluation.age:null,child_duration_in_kita:c.value?i.evaluation.child_duration_in_kita:null,is_daz:c.value?i.evaluation.is_daz:!1,integration_status:c.value?i.evaluation.integration_status:!1,speech_therapy_status:c.value?i.evaluation.speech_therapy_status:!1,ratings:c.value?i.evaluation.data:[]});ue(()=>t.age,s=>{t.ratings=T(i.domains),A(s),s!==4.5&&(t.child_duration_in_kita=null)});const Z=s=>{t.ratings=s},q=s=>{D.value=_e(s)?s.value:s},H=async()=>{t.processing=!0,b.value=!0;let s=[];D.value.map(o=>(o.subdomains.map(m=>(m.milestones.map(g=>(s.push(parseInt(g.id)),g)),m)),o)),t.ratings=t.ratings.map(o=>(o.milestones.map(m=>(s.includes(parseInt(m.id))||(m.value=0),m)),o));let l={onSuccess:o=>{t.clearErrors(),d.value={},x.value=!0,f.value=o.props.data},onError:o=>{d.value=o},onFinish:()=>{t.processing=!1,b.value=!1}};c.value?t.put(route("evaluations.update",{evaluation:i.evaluation.id}),l):t.post(route("evaluations.store"),l)},L=async()=>{t.processing=!0,b.value=!0,t.post(route("evaluations.save"),{preserveState:!1,onSuccess:s=>{t.clearErrors(),d.value={}},onError:s=>{d.value=s},onFinish:()=>{t.processing=!1,b.value=!1}})},S=N({}),G=async s=>{S.processing=!0,S.post(route("evaluations.unfinished",{id:s}),{preserveState:!1,onSuccess:l=>{S.clearErrors(),d.value={},U()},onError:l=>{d.value=l},onFinish:()=>{S.processing=!1,b.value=!1}})};return(s,l)=>{const o=u("v-col"),m=u("v-row"),g=u("v-container"),J=u("v-text-field"),C=u("v-select"),F=u("v-checkbox"),Q=u("v-progress-circular"),z=u("v-btn"),h=u("v-hover"),R=u("v-btn-primary"),W=u("v-icon"),X=u("v-card-text"),ee=u("v-spacer"),ae=u("v-card-actions"),te=u("v-card"),le=u("v-dialog");return k(),Y(de,null,[e(r(ce),{title:"Auswertung erstellen"}),e(pe,{errors:d.value},{header:a(()=>[ge]),default:a(()=>[v("div",he,[e(g,null,{default:a(()=>[e(m,null,{default:a(()=>[e(o,{cols:"12"},{default:a(()=>[we]),_:1})]),_:1})]),_:1}),e(g,null,{default:a(()=>[e(m,null,{default:a(()=>[e(o,{cols:"12",sm:"3"},{default:a(()=>[e(J,{modelValue:r(t).uuid,"onUpdate:modelValue":l[0]||(l[0]=n=>r(t).uuid=n),"error-messages":d.value.uuid,readonly:"",label:"Bezeichner der Einschatzung",required:""},null,8,["modelValue","error-messages"])]),_:1}),e(o,{cols:"12",sm:"2"},{default:a(()=>[e(C,{modelValue:r(t).age,"onUpdate:modelValue":l[1]||(l[1]=n=>r(t).age=n),items:r(ve),"error-messages":d.value.age,"item-title":"age_name","item-value":"age_number",label:"Altersgruppe"},null,8,["modelValue","items","error-messages"])]),_:1}),e(o,{cols:"12",sm:"2"},{default:a(()=>[e(C,{modelValue:r(t).kita_id,"onUpdate:modelValue":l[2]||(l[2]=n=>r(t).kita_id=n),items:V.kitas,"error-messages":d.value.kita_id,"item-title":"name","item-value":"id",label:"Kita"},null,8,["modelValue","items","error-messages"])]),_:1}),e(o,{cols:"12",sm:"2"},{default:a(()=>[e(C,{modelValue:r(t).child_duration_in_kita,"onUpdate:modelValue":l[3]||(l[3]=n=>r(t).child_duration_in_kita=n),items:E.value,"error-messages":d.value.child_duration_in_kita,"item-title":"name","item-value":"id",label:"Zeitraum in der Kita"},null,8,["modelValue","items","error-messages"])]),_:1}),e(o,{cols:"12",sm:"3"},{default:a(()=>[e(F,{modelValue:r(t).is_daz,"onUpdate:modelValue":l[4]||(l[4]=n=>r(t).is_daz=n),label:"Deutsch ist nicht Muttersprache"},null,8,["modelValue"]),e(F,{modelValue:r(t).integration_status,"onUpdate:modelValue":l[5]||(l[5]=n=>r(t).integration_status=n),label:"Integrationsstatus"},null,8,["modelValue"]),e(F,{modelValue:r(t).speech_therapy_status,"onUpdate:modelValue":l[6]||(l[6]=n=>r(t).speech_therapy_status=n),label:"in logopädische Behandlung"},null,8,["modelValue"])]),_:1})]),_:1}),e(m,{class:"manage-evaluation-domains"},{default:a(()=>[r(t).age?(k(),M(K,{key:0,ratings:r(t).ratings,age:r(t).age,domains:V.domains,errors:d.value,onUpdateRatingData:Z,onUpdateDomainsData:q},null,8,["ratings","age","domains","errors"])):$("",!0)]),_:1})]),_:1}),e(g,null,{default:a(()=>[b.value?(k(),Y("div",be,[e(Q,{indeterminate:"",size:40})])):(k(),M(m,{key:1},{default:a(()=>[e(o,{cols:"12",sm:"6"},{default:a(()=>[e(h,null,{default:a(({isHovering:n,props:_})=>[e(z,y({onClick:j},_,{color:n?"primary":"accent"}),{default:a(()=>[p(" Zurücksetzen ")]),_:2},1040,["color"])]),_:1})]),_:1}),e(o,{cols:"12",sm:"6",align:"right"},{default:a(()=>[e(h,null,{default:a(({isHovering:n,props:_})=>[e(z,y({class:"mr-2",onClick:L,variant:"text"},_,{color:n?"accent":"primary"}),{default:a(()=>[p(" Speichern ")]),_:2},1040,["color"])]),_:1}),r(t).age&&D.value.length>0?(k(),M(h,{key:0},{default:a(({isHovering:n,props:_})=>[e(R,y({onClick:H},_,{color:n?"accent":"primary"}),{default:a(()=>[p(" Prüfen und Einreichen ")]),_:2},1040,["color"])]),_:1})):$("",!0)]),_:1})]),_:1}))]),_:1})]),e(le,{modelValue:x.value,"onUpdate:modelValue":l[9]||(l[9]=n=>x.value=n),width:"95vw"},{default:a(()=>[e(te,{height:"95vh"},{default:a(()=>[e(X,null,{default:a(()=>[e(g,null,{default:a(()=>[e(m,{class:"result-evaluation-domains"},{default:a(()=>[e(o,{cols:"12"},{default:a(()=>[e(h,null,{default:a(({isHovering:n,props:_})=>[v("div",ke,[v("a",{href:s.route("evaluations.pdf",{id:f.value.item.id}),onClick:U,title:"Fenster schließen"},[e(W,y(_,{size:"small",class:"tw-me-2",onClick:l[7]||(l[7]=()=>{})}),{default:a(()=>[p("mdi-close")]),_:2},1040)],8,ye)])]),_:1})]),_:1})]),_:1}),e(m,{class:"result-evaluation-domains"},{default:a(()=>[e(o,{cols:"8",offset:"2"},{default:a(()=>[v("div",Ve,[xe,Ee,e(h,null,{default:a(({isHovering:n,props:_})=>[e(z,{href:s.route("evaluations.pdf",{id:f.value.item.id}),class:"tw-px-2 tw-py-3 tw-mb-4 tw-mr-4 tw-normal-case",color:n?"primary":"accent"},{default:a(()=>[p(" Screening als PDF downloaden ")]),_:2},1032,["href","color"])]),_:1}),e(h,null,{default:a(({isHovering:n,props:_})=>[e(z,{onClick:l[8]||(l[8]=ze=>G(f.value.item.id)),class:"tw-px-2 tw-py-3 tw-mb-4 tw-normal-case",color:n?"accent":"primary"},{default:a(()=>[p(" Abgabe zurückziehen ")]),_:2},1032,["color"])]),_:1})])]),_:1}),e(o,{cols:"12"},{default:a(()=>[v("p",null,[Se,p(": "+me(`${f.value.item.kita.formatted_name}_${f.value.item.uuid}`),1)])]),_:1}),e(o,{cols:"12"},{default:a(()=>[e(K,{ratings:f.value.item.data,age:r(t).age,domains:V.domains,disabled:!0},null,8,["ratings","age","domains"])]),_:1})]),_:1})]),_:1})]),_:1}),e(ae,null,{default:a(()=>[e(ee),e(h,null,{default:a(({isHovering:n,props:_})=>[e(R,y({onClick:U},_,{color:n?"accent":"primary"}),{default:a(()=>[p("Abbrechen")]),_:2},1040,["color"])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["errors"])],64)}}};export{Be as default};
