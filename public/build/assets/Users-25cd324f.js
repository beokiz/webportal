import{d as _e}from"./index-776166ac.js";import{K as pe,x as c,h as A,k as fe,T as X,r as n,o as P,f as O,a as e,u as m,w as l,F as Y,Z as ve,b as o,A as y,d as f,n as ge,t as B,c as ee,i as be,g as te,O as he}from"./app-97b709f2.js";import{_ as we}from"./AuthenticatedLayout-ec58a549.js";import"./ApplicationLogo-b1936e2d.js";const ye=(g,i="en-US")=>{const b=new Date(g);if(isNaN(b.getTime()))return"-";const v={year:"numeric",month:"2-digit",day:"2-digit"};return new Date(g).toLocaleDateString(i,v).replace(/\//g,".")},ke=(g,i="en-US",b=!1)=>{const v=new Date(g);if(isNaN(v.getTime()))return"-";const N={year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"};return b&&(N.second="2-digit"),new Date(g).toLocaleDateString(i,N).replace(/\//g,".")},Ve=o("h2",{class:"tw-font-semibold tw-text-xl tw-text-gray-800 tw-leading-tight"},"Benutzer",-1),De={class:"tw-flex tw-items-center tw-justify-end"},Ne=o("span",{class:"tw-text-h5"},"Neuen Benutzer",-1),Se=o("p",null,"Sind Sie sicher, dass Sie den aktuellen Benutzer löschen möchten?",-1),Ue={class:"tw-table-block tw-max-w-full tw-mx-auto tw-py-6 tw-px-4 sm:tw-px-6 lg:tw-px-8"},xe={class:"tw-bg-white tw-flex tw-justify-between tw-px-6 tw-py-6"},ze={class:"tw-w-full"},Pe={class:"tw-ml-6"},Be={align:"center"},Ce=o("span",null,"Benutzer bearbeiten",-1),Ee=o("span",null,"Benutzer löschen",-1),Fe={class:"tw-py-6"},Te={key:0,class:"tw-mb-4"},$e=o("h3",{class:"tw-mb-4"},"Die Tabelle ist leer. Bitte setzen Sie die Suchfilter zurück.",-1),Ie={__name:"Users",props:{items:Array,currentPage:Number,perPage:Number,lastPage:Number,total:Number,paging:Boolean,orderBy:String,sort:String,filters:Object,errors:Object,roles:Array},setup(g){const i=g;_e.Inertia.on("success",s=>{let t=s.detail.page.props;s.detail.page.component==="Users"&&t&&(b.value=t.currentPage,v.value=t.perPage,N.value=t.orderBy,j.value=t.sort,L.value=t.total,le.value=t.lastPage,k.value=t.filters.full_name??null,V.value=t.filters.email??null)}),pe().props.auth.user;const b=c(i.currentPage),v=c(i.perPage),N=c(i.orderBy),j=c(i.sort),L=c(i.total),le=c(i.lastPage),k=c(i.filters.full_name??null),V=c(i.filters.email??null),I=c(""),h=c(i.errors||{}),F=c(!1),C=c(!1),E=c(!1),ae=c(-1),se=[{title:"Status",key:"is_online",width:"5%",sortable:!1,align:"center"},{title:"Name",key:"first_name",width:"25%",sortable:!1},{title:"Email",key:"email",width:"20%",sortable:!1},{title:"Rolle",key:"primary_role_name",width:"10%",sortable:!1},{title:"Letzter Login",key:"last_seen_at",width:"15%",sortable:!1},{title:"Erster Login",key:"first_login_at",width:"15%",sortable:!1},{title:"Aktionen",key:"actions",width:"10%",sortable:!1}],oe=A(()=>i.items.map(s=>{const t={...s};for(const _ in t)(t[_]===null||t[_]===void 0)&&(t[_]="-");return t})),q=A(()=>k.value===null&&V.value===null),ne=A(()=>k.value!==null||V.value!==null);fe(C,s=>{s||U()});const Z=async({page:s,itemsPerPage:t,sortBy:_,clearFilters:w})=>{if(w&&(k.value=null,V.value=null),s===b.value&&w||q||ne){F.value=!0;let d={data:{page:s,per_page:t}};_&&_.length>0&&(d.data.order_by=_[0].key,d.data.sort=_[0].order),d.data.full_name=k.value,d.data.email=V.value,await he.reload(d),b.value=s,v.value=t,F.value=!1}},re=s=>{S.id=s.id,E.value=!0},S=X({id:null}),ue=async()=>{S.processing=!0;let s={onSuccess:t=>{U()},onError:t=>{h.value=t},onFinish:()=>{S.processing=!1}};S.delete(route("users.destroy",{id:S.id}),s)},U=()=>{C.value=!1,E.value=!1,u.reset(),u.clearErrors(),ae.value=-1,h.value={}},u=X({first_name:null,last_name:null,email:null,role:null,two_factor_auth_enabled:!1}),ie=async()=>{u.processing=!0;let s={onSuccess:t=>{U()},onError:t=>{h.value=t},onFinish:()=>{u.processing=!1}};u.post(route("users.store"),s)};return(s,t)=>{const _=n("v-card-title"),w=n("v-text-field"),d=n("v-col"),x=n("v-row"),de=n("v-select"),ce=n("v-checkbox"),R=n("v-container"),K=n("v-card-text"),G=n("v-spacer"),z=n("v-btn"),D=n("v-hover"),H=n("v-btn-primary"),J=n("v-card-actions"),M=n("v-card"),Q=n("v-dialog"),T=n("v-icon"),W=n("v-tooltip"),me=n("v-data-table-server");return P(),O(Y,null,[e(m(ve),{title:"Benutzer"}),e(we,{errors:h.value},{header:l(()=>[Ve,o("div",De,[e(D,null,{default:l(({isHovering:a,props:p})=>[e(z,y(p,{color:a?"accent":"primary",dark:""}),{default:l(()=>[f(" Neuen Benutzer hinzufügen "),e(Q,{modelValue:C.value,"onUpdate:modelValue":t[5]||(t[5]=r=>C.value=r),activator:"parent",width:"80vw"},{default:l(()=>[e(M,{height:"80vh"},{default:l(()=>[e(_,null,{default:l(()=>[Ne]),_:1}),e(K,null,{default:l(()=>[e(R,null,{default:l(()=>[e(x,null,{default:l(()=>[e(d,{cols:"12",sm:"6"},{default:l(()=>[e(w,{modelValue:m(u).first_name,"onUpdate:modelValue":t[0]||(t[0]=r=>m(u).first_name=r),"error-messages":h.value.first_name,label:"Vorname",required:""},null,8,["modelValue","error-messages"])]),_:1}),e(d,{cols:"12",sm:"6"},{default:l(()=>[e(w,{modelValue:m(u).last_name,"onUpdate:modelValue":t[1]||(t[1]=r=>m(u).last_name=r),"error-messages":h.value.last_name,label:"Nachname",required:""},null,8,["modelValue","error-messages"])]),_:1})]),_:1}),e(x,null,{default:l(()=>[e(d,{cols:"12",sm:"6"},{default:l(()=>[e(w,{modelValue:m(u).email,"onUpdate:modelValue":t[2]||(t[2]=r=>m(u).email=r),"error-messages":h.value.email,label:"Email",required:""},null,8,["modelValue","error-messages"])]),_:1}),e(d,{cols:"12",sm:"6"},{default:l(()=>[e(de,{modelValue:m(u).role,"onUpdate:modelValue":t[3]||(t[3]=r=>m(u).role=r),items:g.roles,"error-messages":h.value.role,"item-title":"human_name","item-value":"id",label:"Role",required:""},null,8,["modelValue","items","error-messages"])]),_:1})]),_:1}),e(x,null,{default:l(()=>[e(d,{cols:"12",md:"4",sm:"6"},{default:l(()=>[e(ce,{modelValue:m(u).two_factor_auth_enabled,"onUpdate:modelValue":t[4]||(t[4]=r=>m(u).two_factor_auth_enabled=r),label:"Zwei-Faktor-Authentifizierung",value:!0},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),e(J,null,{default:l(()=>[e(G),e(D,null,{default:l(({isHovering:r,props:$})=>[e(z,y({onClick:U},$,{color:r?"accent":"primary"}),{default:l(()=>[f("Abbrechen")]),_:2},1040,["color"])]),_:2},1024),e(D,null,{default:l(({isHovering:r,props:$})=>[e(H,y({onClick:ie},$,{color:r?"accent":"primary"}),{default:l(()=>[f("Speichern")]),_:2},1040,["color"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1032,["modelValue"])]),_:2},1040,["color"])]),_:1})]),e(Q,{modelValue:E.value,"onUpdate:modelValue":t[6]||(t[6]=a=>E.value=a),activator:"parent",width:"20vw"},{default:l(()=>[e(M,{height:"30vh"},{default:l(()=>[e(K,null,{default:l(()=>[e(R,null,{default:l(()=>[e(x,null,{default:l(()=>[e(d,{cols:"12"},{default:l(()=>[Se]),_:1})]),_:1})]),_:1})]),_:1}),e(J,null,{default:l(()=>[e(G),e(D,null,{default:l(({isHovering:a,props:p})=>[e(z,y({onClick:U},p,{color:a?"accent":"primary"}),{default:l(()=>[f("Abbrechen")]),_:2},1040,["color"])]),_:1}),e(D,null,{default:l(({isHovering:a,props:p})=>[e(H,y({onClick:ue},p,{color:a?"accent":"primary"}),{default:l(()=>[f("Löschen")]),_:2},1040,["color"])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),default:l(()=>[o("div",Ue,[o("div",xe,[o("div",ze,[e(x,null,{default:l(()=>[e(d,{cols:"12",sm:"3"},{default:l(()=>[e(w,{modelValue:k.value,"onUpdate:modelValue":t[7]||(t[7]=a=>k.value=a),label:"Name"},null,8,["modelValue"])]),_:1}),e(d,{cols:"12",sm:"3"},{default:l(()=>[e(w,{modelValue:V.value,"onUpdate:modelValue":t[8]||(t[8]=a=>V.value=a),label:"Email"},null,8,["modelValue"])]),_:1})]),_:1})]),o("div",Pe,[e(D,null,{default:l(({isHovering:a,props:p})=>[e(z,y({class:"tw-mt-2"},p,{color:a?"accent":"primary",onClick:t[9]||(t[9]=r=>I.value=String(Date.now())),dark:""}),{default:l(()=>[f("Suche")]),_:2},1040,["color"])]),_:1})])]),e(me,{"items-per-page":v.value,"onUpdate:itemsPerPage":t[11]||(t[11]=a=>v.value=a),headers:se,page:b.value,"items-length":L.value,items:oe.value,search:I.value,loading:F.value,class:"data-table-container elevation-1","item-value":"name","onUpdate:options":Z},{item:l(({item:a})=>[o("tr",null,[o("td",Be,[e(T,{size:"medium",class:ge({active:a.selectable.is_online})},{default:l(()=>[f("mdi-circle")]),_:2},1032,["class"])]),o("td",null,B(a.selectable.full_name),1),o("td",null,B(a.selectable.email),1),o("td",null,B(a.selectable.primary_role_human_name),1),o("td",null,B(!a.selectable.last_seen_at||a.selectable.last_seen_at==="-"?a.selectable.last_seen_at:m(ke)(a.selectable.last_seen_at,"sv-SE")),1),o("td",null,B(!a.selectable.first_login_at||a.selectable.first_login_at==="-"?a.selectable.first_login_at:m(ye)(a.selectable.first_login_at,"fr-CA")),1),o("td",null,[s.$page.props.auth.user.is_super_admin||s.$page.props.auth.user.is_admin&&!a.selectable.is_super_admin&&!a.selectable.is_admin||s.$page.props.auth.user.is_admin&&s.$page.props.auth.user.id===a.selectable.id?(P(),ee(W,{key:0,location:"top"},{activator:l(({props:p})=>[e(m(be),{href:s.route("users.edit",{id:a.selectable.id})},{default:l(()=>[e(T,y(p,{size:"small",class:"tw-me-2"}),{default:l(()=>[f("mdi-pencil")]),_:2},1040)]),_:2},1032,["href"])]),default:l(()=>[Ce]),_:2},1024)):te("",!0),s.$page.props.auth.user.is_super_admin||s.$page.props.auth.user.is_admin&&!a.selectable.is_super_admin&&!a.selectable.is_admin?(P(),ee(W,{key:1,location:"top"},{activator:l(({props:p})=>[e(T,y(p,{size:"small",class:"tw-me-2",onClick:r=>re(a.raw)}),{default:l(()=>[f("mdi-delete")]),_:2},1040,["onClick"])]),default:l(()=>[Ee]),_:2},1024)):te("",!0)])])]),"no-data":l(()=>[o("div",Fe,[q.value?(P(),O("h3",Te,"Die Tabelle ist leer.")):(P(),O(Y,{key:1},[$e,e(z,{color:"primary",onClick:t[10]||(t[10]=a=>Z({page:1,itemsPerPage:v.value,clearFilters:!0}))},{default:l(()=>[f("Zurücksetzen")]),_:1})],64))])]),_:1},8,["items-per-page","page","items-length","items","search","loading"])])]),_:1},8,["errors"])],64)}}};export{Ie as default};
