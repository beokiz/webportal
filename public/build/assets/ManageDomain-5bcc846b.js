import{d as ne}from"./index-cd583e63.js";import{K as _e,j as z,k as T,l as ue,s as me,T as E,r as u,o as U,f as ie,a as e,u as d,w as l,F as ce,Z as he,b as m,t as $,c as F,h as A,m as h,d as p,i as L}from"./app-dc93c1e9.js";import{S as pe}from"./sortable.esm-0d19b1d3.js";import{_ as ge}from"./AuthenticatedLayout-fce496cf.js";import"./ApplicationLogo-b66bd217.js";const fe={class:"tw-font-semibold tw-text-xl tw-text-gray-800 tw-leading-tight"},ve={class:"tw-table-block tw-max-w-full tw-mx-auto tw-py-6 tw-px-4 sm:tw-px-6 lg:tw-px-8"},we=m("h3",null,"Eigenschaften",-1),be=m("p",null,"Schwellenwerte für Altersgruppe bis 2,5 Jahre",-1),ye=m("p",null,"Schwellenwerte für Altersgruppe bis 4,5 Jahre",-1),ze=m("h3",null,"Zugeordnete Subdomänen",-1),Ve={class:"tw-flex tw-items-center tw-justify-end"},Se=m("span",{class:"tw-text-h5"},"Neue Subdomäne",-1),ke=["data-id","data-order"],De=m("span",null,"Neu anordnen",-1),xe=m("span",null,"Subdomäne bearbeiten",-1),Ue=m("span",null,"Subdomäne löschen",-1),Ce=m("div",{class:"tw-py-6"},[m("h3",{class:"tw-mb-4"},"Die Tabelle ist leer.")],-1),Ae={__name:"ManageDomain",props:{domain:Object,errors:Object,from:String},setup(I){const S=I;ne.Inertia.on("success",s=>{let o=s.detail.page.props;s.detail.page.component==="Domains/Partials/ManageDomain"&&o&&(c.value=o.domain)}),_e().props.auth.user;const c=z(S.domain),n=z(S.errors||{}),H=z(!1),C=z(!1),Q=z(null),q=z(!1),j=z(null),W=[{title:"Name",key:"first_name",width:"90%",sortable:!1},{title:"Aktion",key:"actions",width:"10%",sortable:!1,align:"center"}],y=T(()=>a.daz_dependent?3:6),X=T(()=>S.domain.subdomains.map(s=>{const o={...s};for(const r in o)(o[r]===null||o[r]===void 0)&&(o[r]="-");return o}));ue(q,s=>{s||V()});const Y=T(()=>{if(S.from){const s=S.from.split(";");if(s.length===3){const o=s[0],r={};return r[s[1]]=s[2],route(o,r)}}return route("domains.index")});me(()=>{const s={handle:".v-data-table tbody .glyphicon-move",animation:150,onUpdate:function(o){ee(o)}};pe.create(document.querySelector(".v-data-table tbody"),s)});const V=()=>{q.value=!1,C.value=!1,v.reset(),v.clearErrors(),n.value={}},G=()=>{v.reset(),v.clearErrors(),a.reset(),a.clearErrors(),a.daz_dependent=!1,a.name=null,a.abbreviation=null,a.age_2_red_threshold=null,a.age_2_red_threshold_daz=null,a.age_2_yellow_threshold=null,a.age_2_yellow_threshold_daz=null,a.age_4_red_threshold=null,a.age_4_red_threshold_daz=null,a.age_4_yellow_threshold=null,a.age_4_yellow_threshold_daz=null},B=E({items:[]}),ee=s=>{B.processing=!0;let o=[],r=0;[].forEach.call(s.from.querySelectorAll("tr"),function(i,w){i.setAttribute("data-order",r+w),o.push({id:i.getAttribute("data-id"),order:r+w})}),B.items=o,B.post(route("subdomains.reorder"),{preserveScroll:!0,preserveState:!1,onSuccess:i=>{},onError:i=>{n.value=i},onFinish:()=>{B.processing=!1}})},le=s=>{j.value=s.name,k.id=s.id,C.value=!0},k=E({id:null}),ae=async()=>{k.processing=!0;let s={onSuccess:o=>{V()},onError:o=>{n.value=o},onFinish:()=>{k.processing=!1}};k.delete(route("subdomains.destroy",{id:k.id}),s)},a=E({id:c.value.id,name:c.value.name,abbreviation:c.value.abbreviation,age_2_red_threshold:c.value.age_2_red_threshold,age_2_red_threshold_daz:c.value.age_2_red_threshold_daz,age_2_yellow_threshold:c.value.age_2_yellow_threshold,age_2_yellow_threshold_daz:c.value.age_2_yellow_threshold_daz,age_4_red_threshold:c.value.age_4_red_threshold,age_4_red_threshold_daz:c.value.age_4_red_threshold_daz,age_4_yellow_threshold:c.value.age_4_yellow_threshold,age_4_yellow_threshold_daz:c.value.age_4_yellow_threshold_daz,daz_dependent:c.value.daz_dependent}),oe=async()=>{a.processing=!0,a.daz_dependent||(a.age_2_red_threshold_daz=a.age_2_red_threshold,a.age_2_yellow_threshold_daz=a.age_2_yellow_threshold,a.age_4_red_threshold_daz=a.age_4_red_threshold,a.age_4_yellow_threshold_daz=a.age_4_yellow_threshold);let s={preserveState:!1,onSuccess:o=>{V()},onError:o=>{n.value=o},onFinish:()=>{a.processing=!1}};a.put(route("domains.update",{domain:a.id}),s)},v=E({name:null,domain:c.value.id}),te=async()=>{v.processing=!0,v.post(route("subdomains.store"),{onSuccess:s=>{V()},onError:s=>{n.value=s},onFinish:()=>{v.processing=!1}})};return(s,o)=>{const r=u("v-col"),i=u("v-row"),w=u("v-container"),g=u("v-text-field"),re=u("v-switch"),Z=u("v-spacer"),D=u("v-btn"),b=u("v-hover"),N=u("v-btn-primary"),de=u("v-card-title"),P=u("v-card-text"),M=u("v-card-actions"),J=u("v-card"),K=u("v-dialog"),O=u("v-icon"),R=u("v-tooltip"),se=u("v-data-table-server");return U(),ie(ce,null,[e(d(he),{title:`Verwalte Domäne ${I.domain.name}`},null,8,["title"]),e(ge,{errors:n.value},{header:l(()=>[m("h2",fe,$(`Verwalte Domäne ${I.domain.name}`),1)]),default:l(()=>[m("div",ve,[e(w,null,{default:l(()=>[e(i,null,{default:l(()=>[e(r,{cols:"12"},{default:l(()=>[we]),_:1})]),_:1})]),_:1}),e(w,null,{default:l(()=>[e(i,null,{default:l(()=>[e(r,{cols:"12",sm:"3"},{default:l(()=>[e(g,{modelValue:d(a).abbreviation,"onUpdate:modelValue":o[0]||(o[0]=t=>d(a).abbreviation=t),"error-messages":n.value.abbreviation,label:"Kürzel*",required:""},null,8,["modelValue","error-messages"])]),_:1}),e(r,{cols:"12",sm:"6"},{default:l(()=>[e(g,{modelValue:d(a).name,"onUpdate:modelValue":o[1]||(o[1]=t=>d(a).name=t),"error-messages":n.value.name,label:"Name der Domäne*",required:""},null,8,["modelValue","error-messages"])]),_:1}),e(r,{cols:"12",sm:"3"},{default:l(()=>[e(re,{modelValue:d(a).daz_dependent,"onUpdate:modelValue":o[2]||(o[2]=t=>d(a).daz_dependent=t),"defaults-target":d(a).daz_dependent,"hide-details":"",label:"Einstellen mit Daz"},null,8,["modelValue","defaults-target"])]),_:1})]),_:1}),e(i,{class:"mt-10"},{default:l(()=>[e(r,{cols:"12"},{default:l(()=>[be]),_:1}),e(r,{cols:"12",sm:y.value},{default:l(()=>[e(g,{modelValue:d(a).age_2_red_threshold,"onUpdate:modelValue":o[3]||(o[3]=t=>d(a).age_2_red_threshold=t),"error-messages":n.value.age_2_red_threshold,label:"Schwellwert Rot*",placeholder:"z.B. 5",type:"number",required:""},null,8,["modelValue","error-messages"])]),_:1},8,["sm"]),d(a).daz_dependent?(U(),F(r,{key:0,cols:"12",sm:y.value},{default:l(()=>[e(g,{modelValue:d(a).age_2_red_threshold_daz,"onUpdate:modelValue":o[4]||(o[4]=t=>d(a).age_2_red_threshold_daz=t),"error-messages":n.value.age_2_red_threshold_daz,label:"Schwellwert Rot mit Daz*",placeholder:"z.B. 3",type:"number",required:""},null,8,["modelValue","error-messages"])]),_:1},8,["sm"])):A("",!0),e(r,{cols:"12",sm:y.value},{default:l(()=>[e(g,{modelValue:d(a).age_2_yellow_threshold,"onUpdate:modelValue":o[5]||(o[5]=t=>d(a).age_2_yellow_threshold=t),"error-messages":n.value.age_2_yellow_threshold,label:"Schwellwert Gelb*",placeholder:"z.B. 10",type:"number",required:""},null,8,["modelValue","error-messages"])]),_:1},8,["sm"]),d(a).daz_dependent?(U(),F(r,{key:1,cols:"12",sm:y.value},{default:l(()=>[e(g,{modelValue:d(a).age_2_yellow_threshold_daz,"onUpdate:modelValue":o[6]||(o[6]=t=>d(a).age_2_yellow_threshold_daz=t),"error-messages":n.value.age_2_yellow_threshold_daz,label:"Schwellwert Gelb mit Daz*",placeholder:"z.B. 8",type:"number",required:""},null,8,["modelValue","error-messages"])]),_:1},8,["sm"])):A("",!0)]),_:1}),e(i,null,{default:l(()=>[e(Z),e(r,{cols:"12"},{default:l(()=>[ye]),_:1}),e(r,{cols:"12",sm:y.value},{default:l(()=>[e(g,{modelValue:d(a).age_4_red_threshold,"onUpdate:modelValue":o[7]||(o[7]=t=>d(a).age_4_red_threshold=t),"error-messages":n.value.age_4_red_threshold,label:"Schwellwert Rot*",placeholder:"z.B. 5",type:"number",required:""},null,8,["modelValue","error-messages"])]),_:1},8,["sm"]),d(a).daz_dependent?(U(),F(r,{key:0,cols:"12",sm:y.value},{default:l(()=>[e(g,{modelValue:d(a).age_4_red_threshold_daz,"onUpdate:modelValue":o[8]||(o[8]=t=>d(a).age_4_red_threshold_daz=t),"error-messages":n.value.age_4_red_threshold_daz,label:"Schwellwert Rot mit Daz*",placeholder:"z.B. 3",type:"number",required:""},null,8,["modelValue","error-messages"])]),_:1},8,["sm"])):A("",!0),e(r,{cols:"12",sm:y.value},{default:l(()=>[e(g,{modelValue:d(a).age_4_yellow_threshold,"onUpdate:modelValue":o[9]||(o[9]=t=>d(a).age_4_yellow_threshold=t),"error-messages":n.value.age_4_yellow_threshold,label:"Schwellwert Gelb*",placeholder:"z.B. 10",type:"number",required:""},null,8,["modelValue","error-messages"])]),_:1},8,["sm"]),d(a).daz_dependent?(U(),F(r,{key:1,cols:"12",sm:y.value},{default:l(()=>[e(g,{modelValue:d(a).age_4_yellow_threshold_daz,"onUpdate:modelValue":o[10]||(o[10]=t=>d(a).age_4_yellow_threshold_daz=t),"error-messages":n.value.age_4_yellow_threshold_daz,label:"Schwellwert Gelb mit Daz*",placeholder:"z.B. 8",type:"number",required:""},null,8,["modelValue","error-messages"])]),_:1},8,["sm"])):A("",!0)]),_:1}),e(i,null,{default:l(()=>[e(r,{cols:"12",sm:"6"},{default:l(()=>[e(b,null,{default:l(({isHovering:t,props:_})=>[e(D,h({onClick:G},_,{color:t?"primary":"accent"}),{default:l(()=>[p("Zurücksetzen")]),_:2},1040,["color"])]),_:1})]),_:1}),e(r,{cols:"12",sm:"6",align:"right"},{default:l(()=>[e(b,null,{default:l(({isHovering:t,props:_})=>[e(d(L),{href:Y.value},{default:l(()=>[e(D,h({class:"mr-2",variant:"text"},_,{color:t?"accent":"primary"}),{default:l(()=>[p("Zurück")]),_:2},1040,["color"])]),_:2},1032,["href"])]),_:1}),e(b,null,{default:l(({isHovering:t,props:_})=>[e(N,h({onClick:oe},_,{color:t?"accent":"primary"}),{default:l(()=>[p("Speichern ")]),_:2},1040,["color"])]),_:1})]),_:1})]),_:1})]),_:1}),e(w,null,{default:l(()=>[e(i,{class:"tw-border-t-8 tw-mt-8 tw-pt-8"},{default:l(()=>[e(r,{cols:"12",sm:"6"},{default:l(()=>[ze]),_:1}),e(r,{cols:"12",sm:"6"},{default:l(()=>[m("div",Ve,[e(b,null,{default:l(({isHovering:t,props:_})=>[e(D,h(_,{color:t?"accent":"primary",dark:""}),{default:l(()=>[p(" Subdomäne hinzufügen "),e(K,{modelValue:q.value,"onUpdate:modelValue":o[12]||(o[12]=f=>q.value=f),activator:"parent",width:"80vw"},{default:l(()=>[e(J,{height:"80vh"},{default:l(()=>[e(de,null,{default:l(()=>[Se]),_:1}),e(P,null,{default:l(()=>[e(w,null,{default:l(()=>[e(i,null,{default:l(()=>[e(r,{cols:"12",sm:"12"},{default:l(()=>[e(g,{modelValue:d(v).name,"onUpdate:modelValue":o[11]||(o[11]=f=>d(v).name=f),"error-messages":n.value.name,label:"Name der Subdomäne*",required:""},null,8,["modelValue","error-messages"])]),_:1})]),_:1})]),_:1})]),_:1}),e(M,null,{default:l(()=>[e(b,null,{default:l(({isHovering:f,props:x})=>[e(N,h({onClick:G},x,{color:f?"primary":"accent"}),{default:l(()=>[p("Zurücksetzen")]),_:2},1040,["color"])]),_:2},1024),e(Z),e(b,null,{default:l(({isHovering:f,props:x})=>[e(D,h({onClick:V},x,{color:f?"accent":"primary"}),{default:l(()=>[p("Zurück")]),_:2},1040,["color"])]),_:2},1024),e(b,null,{default:l(({isHovering:f,props:x})=>[e(N,h({onClick:te},x,{color:f?"accent":"primary"}),{default:l(()=>[p("Speichern")]),_:2},1040,["color"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1032,["modelValue"])]),_:2},1040,["color"])]),_:1})])]),_:1})]),_:1})]),_:1}),e(w,null,{default:l(()=>[e(K,{modelValue:C.value,"onUpdate:modelValue":o[13]||(o[13]=t=>C.value=t),width:"20vw"},{default:l(()=>[e(J,{height:"30vh"},{default:l(()=>[e(P,null,{default:l(()=>[e(w,null,{default:l(()=>[e(i,null,{default:l(()=>[e(r,{cols:"12"},{default:l(()=>[m("p",null,"Sind Sie sicher, dass Sie die Subdomäne "+$(j.value)+" löschen möchten?",1)]),_:1})]),_:1})]),_:1})]),_:1}),e(M,null,{default:l(()=>[e(Z),e(b,null,{default:l(({isHovering:t,props:_})=>[e(D,h({onClick:V},_,{color:t?"accent":"primary"}),{default:l(()=>[p("Abbrechen")]),_:2},1040,["color"])]),_:1}),e(b,null,{default:l(({isHovering:t,props:_})=>[e(N,h({onClick:ae},_,{color:t?"accent":"primary"}),{default:l(()=>[p("Löschen")]),_:2},1040,["color"])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(i,null,{default:l(()=>[e(r,{cols:"12"},{default:l(()=>[e(se,{"items-per-page":-1,headers:W,items:X.value,loading:H.value,class:"data-table-container data-table-container-hide-footer elevation-1","item-value":"name"},{item:l(({item:t})=>[m("tr",{"data-id":t.id,"data-order":t.order},[m("td",null,$(t.name),1),m("td",null,[e(R,{location:"top"},{activator:l(({props:_})=>[e(O,h({draggable:"true",onDragstart:f=>Q.value=t,color:"primary"},_,{size:"small",class:"tw-me-2 glyphicon-move"}),{default:l(()=>[p("mdi-arrow-collapse-vertical ")]),_:2},1040,["onDragstart"])]),default:l(()=>[De]),_:2},1024),e(R,{location:"top"},{activator:l(({props:_})=>[e(d(L),{href:s.route("subdomains.show",{id:t.id})},{default:l(()=>[e(O,h(_,{size:"small",class:"tw-me-2"}),{default:l(()=>[p("mdi-pencil")]),_:2},1040)]),_:2},1032,["href"])]),default:l(()=>[xe]),_:2},1024),e(R,{location:"top"},{activator:l(({props:_})=>[e(O,h(_,{size:"small",class:"tw-me-2",onClick:f=>le(t)}),{default:l(()=>[p("mdi-delete ")]),_:2},1040,["onClick"])]),default:l(()=>[Ue]),_:2},1024)])],8,ke)]),"no-data":l(()=>[Ce]),_:1},8,["items","loading"])]),_:1})]),_:1})]),_:1})])]),_:1},8,["errors"])],64)}}};export{Ae as default};
