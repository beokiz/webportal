import{d as ce}from"./index-c9c7b87b.js";import{K as me,x as c,h as A,k as _e,T as X,r as n,o as O,f as j,a as e,u as m,w as l,F as Y,Z as fe,b as o,A as y,d as p,n as pe,t as P,i as ve,O as ge}from"./app-9dc3d1df.js";import{_ as be}from"./AuthenticatedLayout-6a777f47.js";import"./ApplicationLogo-0487aed0.js";const we=(g,u="en-US")=>{const b=new Date(g);if(isNaN(b.getTime()))return"-";const v={year:"numeric",month:"2-digit",day:"2-digit"};return new Date(g).toLocaleDateString(u,v).replace(/\//g,".")},he=(g,u="en-US",b=!1)=>{const v=new Date(g);if(isNaN(v.getTime()))return"-";const D={year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"};return b&&(D.second="2-digit"),new Date(g).toLocaleDateString(u,D).replace(/\//g,".")},ye=o("h2",{class:"tw-font-semibold tw-text-xl tw-text-gray-800 tw-leading-tight"},"Benutzer",-1),ke={class:"tw-flex tw-items-center tw-justify-end"},Ve=o("span",{class:"tw-text-h5"},"Neuen Benutzer",-1),xe=o("p",null,"Sind Sie sicher, dass Sie den aktuellen Benutzer löschen möchten?",-1),De={class:"tw-table-block tw-max-w-full tw-mx-auto tw-py-6 tw-px-4 sm:tw-px-6 lg:tw-px-8"},Se={class:"tw-bg-white tw-flex tw-justify-between tw-px-6 tw-py-6"},Ue={class:"tw-w-full"},Ne={class:"tw-ml-6"},ze={align:"center"},Pe=o("span",null,"Benutzer bearbeiten",-1),Be=o("span",null,"Benutzer löschen",-1),Ce={class:"tw-py-6"},Ee={key:0,class:"tw-mb-4"},Fe=o("h3",{class:"tw-mb-4"},"Die Tabelle ist leer. Bitte setzen Sie die Suchfilter zurück.",-1),Le={__name:"Users",props:{items:Array,currentPage:Number,perPage:Number,lastPage:Number,total:Number,paging:Boolean,orderBy:String,sort:String,filters:Object,errors:Object,roles:Array},setup(g){const u=g;ce.Inertia.on("success",s=>{let t=s.detail.page.props;s.detail.page.component==="Users"&&t&&(b.value=t.currentPage,v.value=t.perPage,D.value=t.orderBy,L.value=t.sort,I.value=t.total,ee.value=t.lastPage,k.value=t.filters.full_name??null,V.value=t.filters.email??null)}),me().props.auth.user;const b=c(u.currentPage),v=c(u.perPage),D=c(u.orderBy),L=c(u.sort),I=c(u.total),ee=c(u.lastPage),k=c(u.filters.full_name??null),V=c(u.filters.email??null),q=c(""),w=c(u.errors||{}),E=c(!1),B=c(!1),C=c(!1),te=c(-1),le=[{title:"Status",key:"is_online",width:"5%",sortable:!1,align:"center"},{title:"Name",key:"first_name",width:"25%",sortable:!1},{title:"Email",key:"email",width:"20%",sortable:!1},{title:"Rolle",key:"primary_role_name",width:"10%",sortable:!1},{title:"Letzter Login",key:"last_seen_at",width:"15%",sortable:!1},{title:"Erster Login",key:"first_login_at",width:"15%",sortable:!1},{title:"Aktionen",key:"actions",width:"10%",sortable:!1}],ae=A(()=>u.items.map(s=>{const t={...s};for(const _ in t)(t[_]===null||t[_]===void 0)&&(t[_]="-");return t})),$=A(()=>k.value===null&&V.value===null),oe=A(()=>k.value!==null||V.value!==null);_e(B,s=>{s||U()});const Z=async({page:s,itemsPerPage:t,sortBy:_,clearFilters:h})=>{if(h&&(k.value=null,V.value=null),s===b.value&&h||$||oe){E.value=!0;let d={data:{page:s,per_page:t}};_&&_.length>0&&(d.data.order_by=_[0].key,d.data.sort=_[0].order),d.data.full_name=k.value,d.data.email=V.value,await ge.reload(d),b.value=s,v.value=t,E.value=!1}},se=s=>{S.id=s.id,C.value=!0},S=X({id:null}),ne=async()=>{S.processing=!0;let s={onSuccess:t=>{U()},onError:t=>{w.value=t},onFinish:()=>{S.processing=!1}};S.delete(route("users.destroy",{id:S.id}),s)},U=()=>{B.value=!1,C.value=!1,i.reset(),i.clearErrors(),te.value=-1,w.value={}},i=X({first_name:null,last_name:null,email:null,role:null,two_factor_auth_enabled:!1}),re=async()=>{i.processing=!0;let s={onSuccess:t=>{U()},onError:t=>{w.value=t},onFinish:()=>{i.processing=!1}};i.post(route("users.store"),s)};return(s,t)=>{const _=n("v-card-title"),h=n("v-text-field"),d=n("v-col"),N=n("v-row"),ie=n("v-select"),ue=n("v-checkbox"),R=n("v-container"),K=n("v-card-text"),G=n("v-spacer"),z=n("v-btn"),x=n("v-hover"),H=n("v-btn-primary"),J=n("v-card-actions"),M=n("v-card"),Q=n("v-dialog"),F=n("v-icon"),W=n("v-tooltip"),de=n("v-data-table-server");return O(),j(Y,null,[e(m(fe),{title:"Benutzer"}),e(be,{errors:w.value},{header:l(()=>[ye,o("div",ke,[e(x,null,{default:l(({isHovering:a,props:f})=>[e(z,y(f,{color:a?"accent":"primary",dark:""}),{default:l(()=>[p(" Neuen Benutzer hinzufügen "),e(Q,{modelValue:B.value,"onUpdate:modelValue":t[5]||(t[5]=r=>B.value=r),activator:"parent",width:"80vw"},{default:l(()=>[e(M,{height:"80vh"},{default:l(()=>[e(_,null,{default:l(()=>[Ve]),_:1}),e(K,null,{default:l(()=>[e(R,null,{default:l(()=>[e(N,null,{default:l(()=>[e(d,{cols:"12",sm:"6"},{default:l(()=>[e(h,{modelValue:m(i).first_name,"onUpdate:modelValue":t[0]||(t[0]=r=>m(i).first_name=r),"error-messages":w.value.first_name,label:"Vorname",required:""},null,8,["modelValue","error-messages"])]),_:1}),e(d,{cols:"12",sm:"6"},{default:l(()=>[e(h,{modelValue:m(i).last_name,"onUpdate:modelValue":t[1]||(t[1]=r=>m(i).last_name=r),"error-messages":w.value.last_name,label:"Nachname",required:""},null,8,["modelValue","error-messages"])]),_:1})]),_:1}),e(N,null,{default:l(()=>[e(d,{cols:"12",sm:"6"},{default:l(()=>[e(h,{modelValue:m(i).email,"onUpdate:modelValue":t[2]||(t[2]=r=>m(i).email=r),"error-messages":w.value.email,label:"Email",required:""},null,8,["modelValue","error-messages"])]),_:1}),e(d,{cols:"12",sm:"6"},{default:l(()=>[e(ie,{modelValue:m(i).role,"onUpdate:modelValue":t[3]||(t[3]=r=>m(i).role=r),items:g.roles,"error-messages":w.value.role,"item-title":"human_name","item-value":"id",label:"Role",required:""},null,8,["modelValue","items","error-messages"])]),_:1})]),_:1}),e(N,null,{default:l(()=>[e(d,{cols:"12",md:"4",sm:"6"},{default:l(()=>[e(ue,{modelValue:m(i).two_factor_auth_enabled,"onUpdate:modelValue":t[4]||(t[4]=r=>m(i).two_factor_auth_enabled=r),label:"Zwei-Faktor-Authentifizierung",value:!0},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),e(J,null,{default:l(()=>[e(G),e(x,null,{default:l(({isHovering:r,props:T})=>[e(z,y({onClick:U},T,{color:r?"accent":"primary"}),{default:l(()=>[p("Abbrechen")]),_:2},1040,["color"])]),_:2},1024),e(x,null,{default:l(({isHovering:r,props:T})=>[e(H,y({onClick:re},T,{color:r?"accent":"primary"}),{default:l(()=>[p("Speichern")]),_:2},1040,["color"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1032,["modelValue"])]),_:2},1040,["color"])]),_:1})]),e(Q,{modelValue:C.value,"onUpdate:modelValue":t[6]||(t[6]=a=>C.value=a),activator:"parent",width:"20vw"},{default:l(()=>[e(M,{height:"30vh"},{default:l(()=>[e(K,null,{default:l(()=>[e(R,null,{default:l(()=>[e(N,null,{default:l(()=>[e(d,{cols:"12"},{default:l(()=>[xe]),_:1})]),_:1})]),_:1})]),_:1}),e(J,null,{default:l(()=>[e(G),e(x,null,{default:l(({isHovering:a,props:f})=>[e(z,y({onClick:U},f,{color:a?"accent":"primary"}),{default:l(()=>[p("Abbrechen")]),_:2},1040,["color"])]),_:1}),e(x,null,{default:l(({isHovering:a,props:f})=>[e(H,y({onClick:ne},f,{color:a?"accent":"primary"}),{default:l(()=>[p("Löschen")]),_:2},1040,["color"])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),default:l(()=>[o("div",De,[o("div",Se,[o("div",Ue,[e(N,null,{default:l(()=>[e(d,{cols:"12",sm:"3"},{default:l(()=>[e(h,{modelValue:k.value,"onUpdate:modelValue":t[7]||(t[7]=a=>k.value=a),label:"Name"},null,8,["modelValue"])]),_:1}),e(d,{cols:"12",sm:"3"},{default:l(()=>[e(h,{modelValue:V.value,"onUpdate:modelValue":t[8]||(t[8]=a=>V.value=a),label:"Email"},null,8,["modelValue"])]),_:1})]),_:1})]),o("div",Ne,[e(x,null,{default:l(({isHovering:a,props:f})=>[e(z,y({class:"tw-mt-2"},f,{color:a?"accent":"primary",onClick:t[9]||(t[9]=r=>q.value=String(Date.now())),dark:""}),{default:l(()=>[p("Suche")]),_:2},1040,["color"])]),_:1})])]),e(de,{"items-per-page":v.value,"onUpdate:itemsPerPage":t[11]||(t[11]=a=>v.value=a),headers:le,page:b.value,"items-length":I.value,items:ae.value,search:q.value,loading:E.value,class:"data-table-container elevation-1","item-value":"name","onUpdate:options":Z},{item:l(({item:a})=>[o("tr",null,[o("td",ze,[e(F,{size:"medium",class:pe({active:a.selectable.is_online})},{default:l(()=>[p("mdi-circle")]),_:2},1032,["class"])]),o("td",null,P(a.selectable.full_name),1),o("td",null,P(a.selectable.email),1),o("td",null,P(a.selectable.primary_role_name),1),o("td",null,P(!a.selectable.last_seen_at||a.selectable.last_seen_at==="-"?a.selectable.last_seen_at:m(he)(a.selectable.last_seen_at,"sv-SE")),1),o("td",null,P(!a.selectable.first_login_at||a.selectable.first_login_at==="-"?a.selectable.first_login_at:m(we)(a.selectable.first_login_at,"fr-CA")),1),o("td",null,[e(W,{location:"top"},{activator:l(({props:f})=>[e(m(ve),{href:s.route("users.edit",{id:a.selectable.id})},{default:l(()=>[e(F,y(f,{size:"small",class:"tw-me-2"}),{default:l(()=>[p("mdi-pencil")]),_:2},1040)]),_:2},1032,["href"])]),default:l(()=>[Pe]),_:2},1024),e(W,{location:"top"},{activator:l(({props:f})=>[e(F,y(f,{size:"small",class:"tw-me-2",onClick:r=>se(a.raw)}),{default:l(()=>[p("mdi-delete")]),_:2},1040,["onClick"])]),default:l(()=>[Be]),_:2},1024)])])]),"no-data":l(()=>[o("div",Ce,[$.value?(O(),j("h3",Ee,"Die Tabelle ist leer.")):(O(),j(Y,{key:1},[Fe,e(z,{color:"primary",onClick:t[10]||(t[10]=a=>Z({page:1,itemsPerPage:v.value,clearFilters:!0}))},{default:l(()=>[p("Zurücksetzen")]),_:1})],64))])]),_:1},8,["items-per-page","page","items-length","items","search","loading"])])]),_:1},8,["errors"])],64)}}};export{Le as default};
